(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{"OTv+":function(e,t,l){"use strict";l.d(t,"a",(function(){return n})),l("/kTj");class n{constructor(e,t){this.formatter=e,this.debug=t.factory(new.target.name)}transform(e,t,l){if(null===e)return 0;switch(Array.isArray(e)&&"from-array"!==t&&(e="%"===e[1]&&"from-array-abbr"!==t?e[0]/100:e[0]),"from-array-abbr"===t&&(t="abbr"),t){case"money":case"amt":return this.formatter.money(e);case"amt2":return this.formatter.money(e,{fractional:2,noZeroMantissa:!1,currencySign:"$"});case"per":return this.formatter.percentage(e);case"per1":return this.formatter.percentage(e,1,!1);case"per2":return this.formatter.percentage(e,2,!1);case"per-3f":return this.formatter.percentage(e,3);case"per-round":return this.formatter.percentage(e,0);case"number":case"cnt":return this.formatter.number(e,{fractional:0});case"cnt0":this.formatter.number(e,{fractional:0,thousandDelimiter:""});case"abbr":return this.formatter.abbrNum(e,l);case"abbr-money":return this.formatter.abbrMoney(e,l);case"from-array":return this.formatter.fromArray(e,l);default:return this.debug.warn("Unknown format: %s. Value: %s",t,e),this.formatter.number(e,{fractional:0})}}}},Tn9L:function(e,t,l){"use strict";l.d(t,"a",(function(){return n}));class n{transform(e,t){if(e){if(t){let t="";return(e=e.replace("&","|&")).split("&").forEach(e=>{t=t+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()+" "}),e=t,t="",e.split(" ").forEach(e=>{t=t+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()+" "}),t.trim().replace("| ","&")}return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}return e}}},hTFM:function(e,t,l){"use strict";l.r(t);var n=l("8Y7J");const a="cabinet.kpi.by-store.";class i{constructor(e){e.addLoaderWithPrefixedTranslations("/cabinet/kpi/by-store",a)}}var o=l("pMnS"),s=l("t68o"),r=l("zbXB"),d=l("GsI2"),u=l("eliu"),c=l("0Xvm"),p=l("VOAG"),h=l("aYrz"),m=l("tfhy"),g=l("NcP4"),b=l("HOtD"),f=l("qFRm"),x=l("TSSN"),v=l("FpoO"),C=l("JNvI"),O=l("pGru"),w=l("YbeN"),M=l("RiRU"),y=l("/kTj"),D=l("SVse"),k=l("lbNG"),_=l("S+vS"),T=l("+2T5"),P=l("kDjO"),S=l("OTv+"),$=l("eeq/");class j{constructor(){this.showValue=!0,this.onEditValue=new n.EventEmitter,this.theme="default"}get simpleClass(){return!this.showValue}get themeDefault(){return"default"===this.theme}get themeSmall(){return"small"===this.theme}get valueClass(){const e=this.data&&this.data.valueStatus;return{green:e>0,yellow:0===e,red:e<0,minimum:(this.data&&this.data.percentage)<5}}get width(){let e=Math.abs(this.data.percentage);return e>100&&(e=100),e+"%"}ngOnInit(){}updateValue(e){this.onEditValue.emit(e)}}var R=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;position:relative;height:24px;border-radius:4px;background-color:#e0e0e0;overflow:hidden}.progress[_ngcontent-%COMP%]{height:24px;position:absolute;top:0;left:0}.progress.green[_ngcontent-%COMP%]{background-color:#1e8700;color:#fff}.progress.yellow[_ngcontent-%COMP%]{background-color:#f3c118;color:#404040}.progress.red[_ngcontent-%COMP%]{background-color:#c00;color:#fff}.progress-value[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:inherit;padding:0 10px;line-height:24px}"]],data:{}});function F(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n["\u0275eld"](1,16777216,null,null,3,"span",[["class","progress-value"]],[[8,"title",0],[2,"field-highlighted",null],[2,"field-editable",null]],[[null,"onUpdate"],[null,"click"]],(function(e,t,l){var a=!0,i=e.component;return"click"===t&&(a=!1!==n["\u0275nov"](e,2).openEditor()&&a),"onUpdate"===t&&(a=!1!==i.updateValue(l)&&a),a}),null,null)),n["\u0275did"](2,737280,null,0,k.a,[n.ElementRef,n.ViewContainerRef,n.ComponentFactoryResolver,_.a,T.a,x.j,P.a,y.b],{params:[0,"params"]},{onUpdate:"onUpdate"}),(e()(),n["\u0275ted"](3,null,[" "," "])),n["\u0275ppd"](4,2),(e()(),n["\u0275and"](0,null,null,0))],(function(e,t){e(t,2,0,t.component.data.valueEdit)}),(function(e,t){var l=t.component;e(t,1,0,n["\u0275nov"](t,2).title,n["\u0275nov"](t,2).highlighted,n["\u0275nov"](t,2).editable);var a=n["\u0275unv"](t,3,0,e(t,4,0,n["\u0275nov"](t.parent.parent,0),l.data.value,l.data.format));e(t,3,0,a)}))}function I(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"span",[["class","progress-value"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,[" "," "])),n["\u0275ppd"](3,2)],null,(function(e,t){var l=t.component,a=l.showValue?n["\u0275unv"](t,2,0,e(t,3,0,n["\u0275nov"](t.parent.parent,0),l.data.value,l.data.format)):"";e(t,2,0,a)}))}function A(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,6,"span",[["class","progress"]],[[4,"width",null]],null,null,null,null)),n["\u0275prd"](512,null,D.B,D.C,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["\u0275did"](2,278528,null,0,D.l,[D.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),n["\u0275and"](16777216,null,null,1,null,F)),n["\u0275did"](4,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275and"](16777216,null,null,1,null,I)),n["\u0275did"](6,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){var l=t.component;e(t,2,0,"progress",l.valueClass),e(t,4,0,l.showValue&&l.data.valueEdit),e(t,6,0,!l.data.valueEdit)}),(function(e,t){e(t,0,0,t.component.width)}))}function L(e){return n["\u0275vid"](2,[n["\u0275pid"](0,S.a,[$.a,y.b]),(e()(),n["\u0275and"](16777216,null,null,1,null,A)),n["\u0275did"](2,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.data)}),null)}class E{constructor(e){this.filterData=e,this.i18n=a,this.isOpened=!0}ngOnInit(){this.categories$=this.filterData.measureCategories$,this.measures$=this.filterData.measures$,this.selectedKpi$=this.filterData.selectedKpi$}onToggle(){this.isOpened=!this.isOpened}onItemClick(e){this.filterData.updateFilter({name:"kpiIndex",value:e.kpiIndex})}}var N=l("dBrL"),V=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;background-color:#fff;width:40px;flex:0 0 40px;margin:-20px 20px -20px -20px;overflow:hidden;transition:width .5s ease,flex .5s ease;position:relative;box-shadow:2px 2px 5px 1px #c1bebe}.opened[_nghost-%COMP%]{width:430px;flex:0 0 430px}.opened[_nghost-%COMP%]   .sidebar-inner[_ngcontent-%COMP%]{width:430px;transform:translateX(0)}.opened[_nghost-%COMP%]   .sidebar-toggle[_ngcontent-%COMP%]{right:12px}.opened[_nghost-%COMP%]   .sidebar-toggle[_ngcontent-%COMP%]:before{content:'\\e314'}.sidebar-inner[_ngcontent-%COMP%]{height:100%;width:430px;transform:translateX(-100%);transition:transform .5s ease}.sidebar-header[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;padding:5px 20px}.sidebar-body[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow:auto}.sidebar-toggle[_ngcontent-%COMP%]{width:24px;height:24px;display:block;cursor:pointer;position:absolute;top:12px;right:8px;transition:right .5s ease;z-index:1}.sidebar-toggle[_ngcontent-%COMP%]:before{content:'\\e315';font-family:\"Material Icons\";font-size:24px;color:#747474;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.sidebar-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.info-block[_ngcontent-%COMP%]{background-color:#fff;border-bottom:1px solid #ddd;padding:10px 20px;min-height:60px;cursor:pointer;position:relative}.info-block[_ngcontent-%COMP%]:before{content:'';width:3px;height:calc(100% + 2px);position:absolute;top:-1px;left:0;background-color:transparent}.info-block.selected[_ngcontent-%COMP%], .info-block[_ngcontent-%COMP%]:hover{background-color:#f3f8fc}.info-block.selected[_ngcontent-%COMP%]:before, .info-block[_ngcontent-%COMP%]:hover:before{background-color:#106cb5}.info-block.selected[_ngcontent-%COMP%]   .info-block-heading[_ngcontent-%COMP%], .info-block[_ngcontent-%COMP%]:hover   .info-block-heading[_ngcontent-%COMP%]{color:#3498db}.info-block-heading[_ngcontent-%COMP%]{font-size:13px;font-weight:400;line-height:1.4;color:#404040;margin:0 0 6px}.info-block-category[_ngcontent-%COMP%]{font-size:18px;color:#404040;font-weight:500;padding:15px 20px}"]],data:{}});function G(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"div",[["class","info-block"]],[[2,"selected",null]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==(!e.parent.context.$implicit.selected&&e.component.onItemClick(e.parent.context.$implicit))&&n),n}),null,null)),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](2,0,null,null,1,"h4",[["class","info-block-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](3,null,[""," ",""])),(e()(),n["\u0275eld"](4,0,null,null,1,"app-progress-bar",[],[[2,"without-value",null],[2,"theme-default",null],[2,"theme-small",null]],null,null,L,R)),n["\u0275did"](5,114688,null,0,j,[],{data:[0,"data"]},null)],(function(e,t){e(t,5,0,t.parent.context.$implicit.progressBar)}),(function(e,t){var l=t.component;e(t,0,0,t.parent.context.$implicit.kpiIndex===n["\u0275unv"](t,0,0,n["\u0275nov"](t,1).transform(l.selectedKpi$))),e(t,3,0,t.parent.context.$implicit.name,"1"===(null==t.parent.context.$implicit?null:t.parent.context.$implicit.is_prorated)?" (Prorated)":"1"===(null==t.parent.context.$implicit?null:t.parent.context.$implicit.is_proj)?" (Projected) ":""),e(t,4,0,n["\u0275nov"](t,5).simpleClass,n["\u0275nov"](t,5).themeDefault,n["\u0275nov"](t,5).themeSmall)}))}function z(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,G)),n["\u0275did"](2,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275and"](0,null,null,0))],(function(e,t){e(t,2,0,t.context.$implicit.section_id-0==t.parent.context.$implicit.id-0)}),null)}function B(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,1,"div",[["class","info-block-category"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",""])),(e()(),n["\u0275and"](16777216,null,null,2,null,z)),n["\u0275did"](4,278528,null,0,D.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,4,0,n["\u0275unv"](t,4,0,n["\u0275nov"](t,5).transform(l.measures$)))}),(function(e,t){e(t,2,0,t.context.$implicit.name)}))}function K(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,0,"button",[["class","sidebar-toggle"]],null,[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onToggle()&&n),n}),null,null)),(e()(),n["\u0275eld"](1,0,null,null,5,"div",[["class","sidebar-inner"]],null,null,null,null,null)),(e()(),n["\u0275eld"](2,0,null,null,0,"div",[["class","sidebar-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](3,0,null,null,3,"div",[["class","sidebar-body"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,2,null,B)),n["\u0275did"](5,278528,null,0,D.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,5,0,n["\u0275unv"](t,5,0,n["\u0275nov"](t,6).transform(l.categories$)))}),null)}var U=l("zXMq"),X=l("2Vgt"),q=l("S5eV"),J=l("zeHk"),Y=l("+bil"),Z=l("ChPW"),H=l("Lxd7"),W=l("IqdZ"),Q=l("TUN4"),ee=l("K5C0"),te=l("mvzq"),le=l("Tn9L");class ne{constructor(){this.arrTotalsLabels=[],this.values={}}ngOnInit(){}ngOnChanges(){}ngOnDestroy(){}}var ae=n["\u0275crt"]({encapsulation:0,styles:[[".totalgrid[_ngcontent-%COMP%]{text-align:-webkit-right;padding-top:10px}.totalgridTable[_ngcontent-%COMP%]{white-space:nowrap}.totalCellText[_ngcontent-%COMP%]{text-align:right;padding-right:10px}"]],data:{}});function ie(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"td",[["class","totalCellText"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"strong",[],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",":"])),n["\u0275ppd"](3,2),(e()(),n["\u0275ted"](4,null,[" "," "])),n["\u0275ppd"](5,2)],null,(function(e,t){var l=t.component,a=n["\u0275unv"](t,2,0,e(t,3,0,n["\u0275nov"](t.parent.parent,0),t.context.$implicit.label,!0));e(t,2,0,a);var i=n["\u0275unv"](t,4,0,e(t,5,0,n["\u0275nov"](t.parent.parent,1),l.values[t.context.$implicit.key],"1.0-0"));e(t,4,0,i)}))}function oe(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"table",[["border","0"],["width","100%"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"tr",[],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,ie)),n["\u0275did"](3,278528,null,0,D.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,3,0,t.component.arrTotalsLabels)}),null)}function se(e){return n["\u0275vid"](2,[n["\u0275pid"](0,le.a,[]),n["\u0275pid"](0,D.f,[n.LOCALE_ID]),(e()(),n["\u0275eld"](2,0,null,null,8,"div",[["class","totalgrid"]],null,null,null,null,null)),(e()(),n["\u0275eld"](3,0,null,null,7,"table",[["border","0"],["class","totalgridTable"]],null,null,null,null,null)),(e()(),n["\u0275eld"](4,0,null,null,6,"tr",[],null,null,null,null,null)),(e()(),n["\u0275eld"](5,0,null,null,5,"td",[],null,null,null,null,null)),n["\u0275prd"](512,null,D.D,D.E,[n.ElementRef,n.KeyValueDiffers,n.Renderer2]),n["\u0275did"](7,278528,null,0,D.q,[D.D],{ngStyle:[0,"ngStyle"]},null),n["\u0275pod"](8,{width:0}),(e()(),n["\u0275and"](16777216,null,null,1,null,oe)),n["\u0275did"](10,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){var l=t.component,n=e(t,8,0,"100%");e(t,7,0,n),e(t,10,0,null==l.arrTotalsLabels?null:l.arrTotalsLabels.length)}),null)}var re=l("mS0u"),de=l("MmlZ");class ue{constructor(e){this.dataService=e,this.i18n=a,this.isOpened=!0,this.subs=[]}set sub(e){this.subs.push(e)}ngOnInit(){this.data$=this.dataService.bottomBarData$,this.initSubscriptions()}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}onToggle(){this.isOpened=!this.isOpened}initSubscriptions(){this.sub=this.dataService.selectedStore$.subscribe(e=>this.selectedStore=e)}}var ce=l("2Vo4"),pe=l("pLZG"),he=l("zp1y"),me=l("lJxs"),ge=l("vkgz"),be=l("fFD9"),fe=l("Kj3r"),xe=l("w1tV"),ve=l("SxV6"),Ce=l("W+wd"),Oe=function(e){return e.Grid="grid",e.Details="details",e.Trend="trend",e}({});class we{constructor(e,t,l,n,a,i){this.translate=e,this.dataApi=t,this.filterData=l,this.instanceAppSettingsApi=n,this.coreCache=a,this.formatter=i,this._tabData$=new ce.a(void 0),this._loading$=new ce.a(void 0),this._selectedTab$=new ce.a(Oe.Grid),this._selectedStore$=new ce.a(void 0),this._selectedStoreData$=new ce.a(void 0),this.subs=[],this.initInternal()}set sub(e){this.subs.push(e)}destroy(){this.subs.forEach(e=>e.unsubscribe()),this.subs=[],this._selectedTab$.next(Oe.Grid),this.resetStoreData()}init(){this.initSubscriptions()}selectStore(e){const t=this._selectedStore$.getValue();t&&t.id===e.id?this.resetStoreData():this._selectedStore$.next(e)}setTab(e){this._selectedTab$.next(e)}resetStoreData(){this._selectedStore$.getValue()&&(this._selectedStore$.next(void 0),this._selectedStoreData$.next(void 0))}initInternal(){this.loading$=this._loading$.asObservable(),this.selectedTab$=this._selectedTab$.pipe(Object(pe.a)(e=>!!e)),this.tabData$=this._tabData$.pipe(Object(pe.a)(e=>!!e)),this.selectedStore$=this._selectedStore$.asObservable(),this.bottomBarData$=this.filterData.selectedMeasure$.pipe(Object(he.a)(this.filterData.currentPage$),Object(pe.a)(([,e])=>e===Ce.d.ByStore),Object(me.a)(([e])=>e),Object(ge.a)(()=>this.resetStoreData()),Object(be.a)(this._selectedStoreData$),Object(fe.a)(200),Object(me.a)(([e,t])=>{const l={data:[],labels:[],colors:[],tooltip:{titles:[],labels:[]}},n={"-1":"red",0:"yellow",1:"green"},a=t?t.data:e.stores||[],i=!!e.isProjected;for(const o of a){const e=i?+o.value[0]:+o.data.value_actual[0];let a;switch(l.data.push(+e),l.labels.push(t?o.xaxis:o.abbrev),l.colors.push(n[String(o.color)]||"yellow"),l.tooltip.titles.push(t?o.hover_pre:o.storeName),o.value[1]){case"$":a=this.formatter.abbrMoney(e,{K:1,M:1});break;case"%":a=this.formatter.percentage(String(e/100));break;default:a=this.formatter.number(e,{fractional:0})}l.tooltip.labels.push(a)}return l}),Object(xe.a)())}initSubscriptions(){this.sub=this.filterData.change$.pipe(Object(ge.a)(()=>this._loading$.next(!0)),Object(he.a)(this.instanceAppSettingsApi.settings$,this.coreCache.storesById$.pipe(Object(ve.a)()),this.selectedTab$)).subscribe(([e,t,l,n])=>{this.dataApi.getByStore(e).subscribe(e=>{for(const n of e){const e=n.variance&&n.variance.value?+n.variance.value[0]:0;n.progressBar={value:e,valueStatus:n.variance?n.variance.color:0,percentage:100*e,format:"per"},n.isProjected=!!+n.is_proj,n.stores.forEach(e=>{const n=l.get(+e.id),a=e.data,i=a.value_actual[0];e.rank=+e.current_pos,e.pRank=+e.previous_pos,e.storeName=n?n[t.storeNameType]:e.name,e.abbrev=n?n.abbreviation:e.name,e.value=a.value,e.amount="%"===a.value[1]?i/100:i,e.pAmount="%"===a.value[1]?a.value[0]/100:a.value[0],e.budget="%"===a.budget[1]?a.budget[0]/100:a.budget[0],e.delta=a.delta.value[0],e.deltaRank=a.delta.color,e.budgetRank=a.budget.color})}this.filterData.setMeasures(e),this.resetStoreData(),n===Oe.Grid&&this._loading$.next(!1)})}),this.sub=this.selectedStore$.pipe(Object(pe.a)(e=>!!e),Object(me.a)(e=>e.id),Object(he.a)(this.filterData.value$),Object(me.a)(([e,{dateIndex:t,kpiIndex:l,period:n}])=>({store:e,dateIndex:t,kpiIndex:l,period:n}))).subscribe(e=>{this.dataApi.getStoreTrendData(e).subscribe(e=>{const t=e&&e[0];this._selectedStoreData$.next({id:t.storeName,data:t.trends})})}),this.sub=this.selectedTab$.pipe(Object(be.a)(this.filterData.selectedMeasure$),Object(fe.a)(100),Object(pe.a)(([e])=>e===Oe.Grid)).subscribe(([e,t])=>{this._tabData$.next(t.stores)}),this.sub=this.selectedTab$.pipe(Object(be.a)(this.filterData.selectedKpi$,this.filterData.selectedGroup$,this.filterData.selectedDate$,this.filterData.selectedPeriod$,this.filterData.selectedAccView$),Object(fe.a)(100),Object(pe.a)(([e])=>-1!==[Oe.Details,Oe.Trend].indexOf(e)),Object(he.a)(this.filterData.selectedMeasure$),Object(ge.a)(()=>this._loading$.next(!0)),Object(ge.a)(()=>this.resetStoreData())).subscribe(([[e,t,l,n,a,i],o])=>{const s={kpiIndex:t,kpiSubType:o.kpiSubType,section_id:o.section_id,numDays:o.numDays,group:l,dateIndex:n,period:a,view:i};switch(e){case Oe.Details:this.dataApi.getByStoreDetails(s).subscribe(e=>{this._tabData$.next(e),this._loading$.next(!1)});break;case Oe.Trend:this.dataApi.getStoreTrendData(s).subscribe(e=>{this._tabData$.next(e),this._loading$.next(!1)})}})}}var Me=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;flex:0 0 40px;transition:flex .5s ease}.opened[_nghost-%COMP%]{flex:0 0 275px}.bottom-bar-header[_ngcontent-%COMP%]{height:40px;padding:5px 20px;display:flex;align-items:center;border-top:1px solid #ddd}  .opened .bottom-bar-header{border-top:none;border-bottom:1px solid #ddd}.bottom-bar-body[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .5s ease}  .opened .bottom-bar-body{height:calc(100% - 40px)}.bottom-bar-trigger[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:#747474;cursor:pointer;position:relative;padding-left:24px;text-transform:uppercase}.bottom-bar-trigger[_ngcontent-%COMP%]:before{content:'\\e316';font-family:\"Material Icons\";font-size:24px;color:inherit;cursor:inherit;display:inline-block;position:absolute;left:0;top:50%;transform:translateY(-54%)}  .opened .bottom-bar-trigger:before{content:'\\e313'}.store-details[_ngcontent-%COMP%]{height:100%}.store-details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;padding:10px 20px 5px;height:50px}.store-details-body[_ngcontent-%COMP%]{height:calc(100% - 50px);padding:0 20px 10px;overflow:auto}.store-details-heading[_ngcontent-%COMP%]{margin:10px 0 0;font-size:16px;font-weight:500;color:#404040}app-bar-chart[_ngcontent-%COMP%]{min-height:166px;max-height:175px;transform:translateY(10px)}"]],data:{}});function ye(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"div",[["class","bottom-bar-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"button",[["class","bottom-bar-trigger"]],null,[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onToggle()&&n),n}),null,null)),(e()(),n["\u0275ted"](2,null,["",""])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),(e()(),n["\u0275eld"](4,0,null,null,11,"div",[["class","bottom-bar-body"]],null,null,null,null,null)),(e()(),n["\u0275eld"](5,0,null,null,10,"div",[["class","store-details"]],null,null,null,null,null)),(e()(),n["\u0275eld"](6,0,null,null,5,"div",[["class","store-details-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](7,0,null,null,4,"div",[["class","store-details-header-left"]],null,null,null,null,null)),(e()(),n["\u0275eld"](8,0,null,null,3,"h3",[["class","store-details-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](9,null,[" ",": "," "])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),(e()(),n["\u0275eld"](12,0,null,null,3,"div",[["class","store-details-body"]],null,null,null,null,null)),(e()(),n["\u0275eld"](13,0,null,null,2,"app-bar-chart",[],null,null,null,re.b,re.a)),n["\u0275did"](14,638976,null,0,de.a,[n.ElementRef,$.a],{config:[0,"config"]},null),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,14,0,n["\u0275unv"](t,14,0,n["\u0275nov"](t,15).transform(l.data$)))}),(function(e,t){var l=t.component;e(t,2,0,n["\u0275unv"](t,2,0,n["\u0275nov"](t,3).transform(l.i18n+(l.isOpened?"bottom-bar.expand.label":"bottom-bar.collapse.label")))),e(t,9,0,n["\u0275unv"](t,9,0,n["\u0275nov"](t,10).transform(l.i18n+"bottom-bar.header.store.label")),l.selectedStore?l.selectedStore.storeName:n["\u0275unv"](t,9,1,n["\u0275nov"](t,11).transform(l.i18n+"bottom-bar.header.store.all.label")))}))}var De=l("zp2H"),ke=l("v67E"),_e=l("2v1Z"),Te=l("BTBr"),Pe=l("NAMS"),Se=l("/gN3"),$e=l("VHTt");class je{constructor(e,t,l,n,i,o,s,r,d){this.document=e,this.translate=t,this.instanceAppSettingsApi=l,this.coreCache=n,this.tracking=i,this.filterData=o,this.dataApi=s,this.format=r,this.dataService=d,this.i18n=a,this.allowPagination=!1,this.isCommentsView=!1,this.selectedSection=0,this.amtFields={},this.subs=[]}set sub(e){this.subs.push(e)}ngOnInit(){this.filterData.setCurrentPage(Ce.d.ByStore),this.dataService.init(),this.initGridOptions(),this.initStreams(),this.initSubscriptions()}ngOnDestroy(){this.dataService.destroy(),this.subs.forEach(e=>e.unsubscribe())}openCommentsView(){this.commentType=Pe.a.Kpi,this.commentSubType=this.selectedKpi,this.isCommentsView=!0}onCloseComments(){this.commentType=null,this.commentSubType=null,this.commentTitles=null,this.commentNode=null,this.isCommentsView=!1}onCommentsChange(e){this.commentType!==Pe.a.Kpi&&(this.commentNode.setDataValue("comment_last",e.last),this.commentNode.setDataValue("comment_count",e.total))}onTabClick(e){e!==this.selectedTab&&this.dataService.setTab(e)}onCellClick(e){switch(this.selectedTab){case Oe.Grid:this.dataService.selectStore(e.data);break;case Oe.Details:this.showDrillModal(e)}}onDrillCellClick(e){this.showTransactionModal(e)}onTransactionCellClick(e){this.showJournalModal(e)}onTrackTableChanges(){this.trackAction(Te.a.Load,this.table.grid)}exportDataAs(e){const t=(new Date).toDateString(),l=this.filterData.getFiltersListItems();this.sub=this.translate.get(a+"tab."+this.selectedTab+".label").pipe(Object(he.a)(this.selectedMeasure$)).subscribe(([n,a])=>{const i=n+" "+a.name+" "+t;switch(e){case $e.a.XLS:this.table.exportDataAsXls(i,l),this.trackAction(Te.a.ExportXls,this.table.grid);break;case $e.a.PDF:this.table.exportDataAsPdf(i,l,()=>this.trackAction(Te.a.ExportPdf,this.table.grid),{invisible:["comment_count"]})}})}onagGridChangeFilter({api:e}){const t=e.getModel(),l=Array(t.getRowCount()).fill("").map((e,l)=>t.getRow(l).data);this.amtFields=[];for(const n of l)if(n.sn)for(const e of Object.keys(n))n.hasOwnProperty(e)&&this.addValueToSum(e,n[e])}trackAction(e,t){const l=this.filterData.getFiltersListItems();this.tracking.log({page:Te.b.Kpi,section:Te.c.ByStore,subSection:this.selectedTab||Oe.Grid,event:e,params:l,grid:t})}initStreams(){this.loading$=this.dataService.loading$,this.selectedMeasure$=this.filterData.selectedMeasure$}initSubscriptions(){this.sub=this.translate.get(["grid.column.rank","grid.column.prank","grid.column.store-name","grid.column.current-amount","grid.column.projected-amount","grid.column.budget","grid.column.delta","grid.column.total","grid.column.line-description"].map(e=>a+e)).pipe(Object(be.a)(this.dataService.tabData$),Object(he.a)(this.selectedMeasure$,this.dataService.selectedTab$,this.instanceAppSettingsApi.settings$,this.coreCache.storesById$.pipe(Object(ve.a)()))).subscribe(([[e,t],l,n,a,i])=>{let o={};switch(n){case Oe.Grid:o=this.getGridTabOptions(t,l,e);break;case Oe.Details:o=this.getDetailsTabOptions(t,l,a,i);break;case Oe.Trend:o=this.getTrendTabOptions(t,a,i,e)}this.columns=o.columns,this.data=o.rows,this.totalsFields=o.totalsFields,this.allowPagination=this.data.length>1e3,this.trackAction(Te.a.Load)}),this.sub=this.selectedMeasure$.subscribe(e=>{this.selectedKpi=e&&e.kpiIndex,this.selectedSection=+e.section_id;const t=e.section_id===Ce.a.Docs,l=["category","kpiType","group","kpiIndex","date","period"];e.section_id===Ce.a.Operarions&&this.selectedTab===Oe.Details&&l.push("view"),this.filterData.showFilters(l),this.tabs=t?[Oe.Grid,Oe.Details,Oe.Trend]:[Oe.Grid,Oe.Details],this.selectedTab!==Oe.Trend||t||this.dataService.setTab(Oe.Grid)}),this.sub=this.dataService.selectedStore$.subscribe(e=>{!e&&this.table&&this.table.agGrid&&this.table.agGrid.api&&(this.table.agGrid.api.deselectAll(),this.table.agGrid.api.clearFocusedCell())}),this.sub=this.dataService.selectedTab$.subscribe(e=>{this.selectedTab=e;const t=["category","kpiType","group","kpiIndex","date","period"];this.selectedSection===+Ce.a.Operarions&&this.selectedTab===Oe.Details&&t.push("view"),this.filterData.showFilters(t)})}mapColCellRenderer(e){return{comment_count:e=>{const t=this.document.createElement("span");return t.innerText=e.valueFormatted,t.className="ag-comments-trigger",t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.commentNode=e.node,this.commentType=e.data.commentType,this.commentSubType=e.data.comment_key,this.commentTitles=e.columnApi.getAllDisplayedColumns().filter(e=>-1===e.getColId().indexOf("comment_")).map(t=>({label:t.getColDef().headerName,value:t.getColDef().valueFormatter(e)})),this.isCommentsView=!0}),t}}[e]}mapColFilter(e,t){let l=Se.c.String;return-1!==[Se.d.Integer,Se.d.Money,Se.d.Percentage].indexOf(t)?l=Se.c.NumberRange:(t===Se.d.Date||e.toLowerCase().indexOf("date")>=0)&&(l=Se.c.DateRange),"fistatus".indexOf(e.toLowerCase())>=0?Se.c.MultiChoice:l}initGridOptions(){this.options={onCellClicked:e=>{this.onCellClick(e)}},this.modalGridOptions={}}getGridTabOptions(e,t,l){const n={"-1":"red",0:"yellow",1:"green"},i=this.getLabelFormatFromSign(t.current&&t.current[1],!1);return{columns:[new Se.a({field:"rank",name:l[a+"grid.column.rank"],labelFormat:Se.d.Integer,filter:Se.c.NumberRange,align:Se.b.Left,cellRenderer:e=>{const t=e.data.rank,l=e.data.pRank;return`${e.valueFormatted}<span class="icon-rank ${t<l?"positive":t>l?"negative":"warning"}"></span>`}}),new Se.a({field:"pRank",name:l[a+"grid.column.prank"],labelFormat:Se.d.Integer,filter:Se.c.NumberRange,align:Se.b.Left}),new Se.a({field:"storeName",name:l[a+"grid.column.store-name"],labelFormat:Se.d.Default,filter:Se.c.String,align:Se.b.Left}),new Se.a({field:"amount",name:l[a+"grid.column.current-amount"],labelFormat:i,filter:Se.c.NumberRange,align:Se.b.Right}),new Se.a({field:"pAmount",name:l[a+"grid.column.projected-amount"],labelFormat:i,filter:Se.c.NumberRange,align:Se.b.Right,hide:!t.isProjected}),new Se.a({field:"budget",name:l[a+"grid.column.budget"],labelFormat:Se.d.Money,filter:Se.c.NumberRange,align:Se.b.Right,cellRenderer:e=>`${e.valueFormatted}<span class="${n[e.data.budgetRank]}"></span>`}),new Se.a({field:"delta",name:l[a+"grid.column.delta"],labelFormat:Se.d.Percentage,filter:Se.c.NumberRange,align:Se.b.Right,cellRenderer:e=>`${e.valueFormatted}<span class="${n[e.data.deltaRank]}"></span>`})],rows:e}}getDetailsTabOptions(e,t,l,n){const a=[],i=[];this.amtFields={};const o=e.labels.map(e=>Object.keys(e)[1]&&1==+Object.values(e)[1]?Object.keys(e)[0]:null);for(const s of e.data){if(s.sn){s.storeId=+s.sn;const e=n.get(+s.sn);e&&(s.sn=e[l.storeNameType])}for(const e of Object.keys(s)){if((-1!==e.indexOf("sMTD")||-1!==["sTotMTD"].indexOf(e))&&s[e]instanceof Array)if("title"===s.line_type)s[e]=null;else{if(!s.labelFormat){if("N/A"===s[e][0]&&-1!==["sTotMTD"].indexOf(e)){s[e]=s[e][0];continue}s.labelFormat=this.getLabelFormatFromSign(s[e][1])}s[e]=s[e][0]}o.indexOf(e)>=0&&this.addValueToSum(e,s[e])}-1!==[Ce.a.Schedules,Ce.a.Operarions].indexOf(t.section_id)?(s.commentType=t.section_id===Ce.a.Schedules?Pe.a.Schedules:Pe.a.Operations,s.hasDrill=!(t.section_id===Ce.a.Operarions&&+t.kpiSubType>3)):s.hasDrill="1"===s.drill}return e.segments.base.forEach((o,s)=>{const r=e.labels[s];if(r.isTotalField&&+r.isTotalField){const e=Object.values(r)[0];i.push({key:o,label:e})}if(t.section_id===Ce.a.Docs&&-1===["name","sTotMTD"].indexOf(o)){const e=n.get(+r[o]);e&&(r[o]=e[l.storeNameType])}const d=(t=>{const l=e.data[0]&&e.data[0][t];let n=Se.d.Default;return-1!==t.indexOf("sMTD")||-1!==t.indexOf("Amount")||-1!==["sTotMTD"].indexOf(t)?(n=Se.d.Money,l&&l.indexOf(".")<0&&(n=Se.d.Integer)):(-1!==["days","onhandqty","age"].indexOf(t.toLowerCase())||(l||0===l)&&(!isNaN(l)||l instanceof Array&&!isNaN(l[0])))&&-1===["ro","custid","advisornumber","writer","employeenumber","invoicenumber","stryear","deal","control1","vehyear"].indexOf(t.toLowerCase())&&(n=Se.d.Integer),n})(o);a.push(new Se.a({field:o,name:r[o],valueFormatter:e=>this.currencyFormatter(e,o),filter:this.mapColFilter(o,d),cellRenderer:this.mapColCellRenderer(o),align:0===e.segments.base.indexOf(o)?Se.b.Left:Se.b.Right,pinned:-1!==["name","sTotMTD"].indexOf(o)?"left":null,drillIndex:-1===["name","sTotMTD","comment_last","comment_count","comment_key"].indexOf(o)?1:null}))}),{columns:a,rows:e.data,totalsFields:i}}currencyFormatter(e,t=""){return e.value=e.data&&e.data[t],0===this.selectedSection?(e.value=e.data&&e.data[t],e.data.name&&e.data.name.toLowerCase().indexOf("unit")>=0?isNaN(e.value)?e.value:this.format.number(e.value,{thousandDelimiter:",",noZeroMantissa:!0}):10==+e.data.labelFormat?isNaN(e.value)?e.value:Math.round(e.value)+"%":isNaN(e.value)||!e.value?e.value:this.format.money(e.value)):e.value&&!isNaN(e.value)&&!isNaN(e.value)&&e.value.toString().indexOf(".")>0?this.format.money(e.value):isNaN(e.value)||!e.value?e.value:Math.round(e.value)}addValueToSum(e,t){this.amtFields.hasOwnProperty(e)||(this.amtFields[e]=0),this.amtFields[e]+=+t}getTrendTabOptions(e,t,l,n){if(!e.length)return{};const i=[];let o;for(const a of e){const e={title:l.get(+a.storeName)[t.storeNameType],total:a.total&&a.total[0]};for(const t of a.trends){o||(o=this.getLabelFormatFromSign(t.value[1]));const l=t.value&&t.value[0];e[t.xaxis+t.year]=o===Se.d.Percentage?l/100:l}i.push(e)}const s=[new Se.a({field:"title",name:n[a+"grid.column.store-name"],labelFormat:Se.d.Default,filter:Se.c.String,align:Se.b.Left}),new Se.a({field:"total",name:n[a+"grid.column.total"],labelFormat:o,filter:Se.c.NumberRange,align:Se.b.Right})];return e[0].trends.reverse().forEach(e=>{s.push(new Se.a({field:e.xaxis+e.year,name:e.xaxis+"-"+e.year.substr(2),labelFormat:o,filter:Se.c.NumberRange,align:Se.b.Right}))}),{columns:s,rows:i}}showDrillModal(e){const t=e.colDef.field,l=e.data;-1===["name","sTotMTD"].indexOf(t)&&l.hasDrill&&(this.drillInfo=[],this.drillData=null,this.drillColumns=null,this.drillSummaryFields=null,this.sub=this.translate.get(["modal.drill.fs-detail.title","modal.drill.control-detail.title","modal.drill.top-info.store.label","modal.drill.top-info.kpi.label","modal.drill.top-info.control.label"].map(e=>a+e)).pipe(Object(he.a)(this.selectedMeasure$,this.filterData.selectedDate$)).subscribe(([e,{section_id:n,kpiSubType:i,name:o},s])=>{const r={section_id:n,kpiSubType:i,dateIndex:s};switch(n){case Ce.a.Docs:this.drillModal.modalTitle=e[a+"modal.drill.fs-detail.title"]+" [ "+l.name+" ]",this.drillSummaryFields=["amtMTD","amtYTD","cMTD","cYTD"],r.storeId=+t.replace("sMTD",""),r.rl=String(l.rl).replace(",","");break;case Ce.a.Schedules:case Ce.a.Operarions:this.drillModal.modalTitle=e[a+"modal.drill.control-detail.title"],this.drillInfo=[{label:e[a+"modal.drill.top-info.store.label"],value:l.sn},{label:e[a+"modal.drill.top-info.kpi.label"],value:o},{label:e[a+"modal.drill.top-info.control.label"],value:l.deal||l.control1}],r.storeId=l.storeId,r.control1=n===Ce.a.Schedules?l.control1:l.deal;break;default:return}this.drillLoading=!0,this.drillModal.showModal(),this.dataApi.getDrillDetails(r).subscribe(e=>{this.drillColumns=this.mapModalColumns(e),this.drillData=this.mapModalData(e,r.storeId,n),this.drillLoading=!1})}))}showTransactionModal(e){const t=e.data;t.hasDrill&&(this.transactionData=null,this.transactionColumns=null,this.transactionSummaryFields=null,this.sub=this.translate.get(["modal.transaction-detail.title"].map(e=>a+e)).pipe(Object(he.a)(this.selectedMeasure$,this.filterData.selectedDate$)).subscribe(([e,{section_id:l},n])=>{const i={section_id:l,dateIndex:n,gl:t.gl,storeId:t.storeId};this.transactionModal.modalTitle=e[a+"modal.transaction-detail.title"]+" [ "+t.gl+" ]",this.transactionSummaryFields=["pa"],this.transactionLoading=!0,this.transactionModal.showModal(),this.dataApi.getTransactionDetails(i).subscribe(e=>{this.transactionColumns=this.mapModalColumns(e),this.transactionData=this.mapModalData(e,i.storeId,l),this.drillLoading=!1})}))}showJournalModal(e){const t=e.data;t.hasDrill&&(this.journalData=null,this.journalColumns=null,this.sub=this.translate.get(a+"modal.cross-to-journal-view.title").subscribe(e=>{this.journalModal.modalTitle=e,this.journalLoading=!0,this.journalModal.showModal(),this.dataApi.getJournalDetails({ji:t.ji,ri:t.ri,storeId:t.storeId}).subscribe(e=>{this.journalColumns=this.mapModalColumns(e),this.journalData=this.mapModalData(e)},()=>this.journalData=[],()=>this.journalLoading=!1)}))}mapModalColumns(e){const t=[];return e.segments.base.forEach((l,n)=>{const a=e.labels[n],i=this.mapModalColLabelFormat(l);t.push(new Se.a({field:l,name:a[l],labelFormat:i,filter:this.mapColFilter(l,i),align:0===e.segments.base.indexOf(l)?Se.b.Left:Se.b.Right}))}),t}mapModalData(e,t,l){return e.data.map(e=>(Object.keys(e).forEach(t=>{e[t]=e[t]instanceof Array?e[t][0]:e[t]}),e.hasDrill=l===Ce.a.Docs,e.storeId=t,e))}mapModalColLabelFormat(e){let t=Se.d.Default;return-1!==["amtMTD","amtYTD","PostAmount","pa","MTD"].indexOf(e)?t=Se.d.Money:-1!==["d","gd"].indexOf(e)&&(t=Se.d.Date),t}getLabelFormatFromSign(e,t=!1){return"$"===e?t?Se.d.MoneyAbbr:Se.d.Money:"%"===e?Se.d.Percentage:Se.d.Integer}}var Re=l("XpwZ"),Fe=l("yK5/"),Ie=l("V3/g"),Ae=n["\u0275crt"]({encapsulation:0,styles:[[".grid-wrapper[_ngcontent-%COMP%]{flex:1 1 100%;height:100%;max-width:100%;background-color:#fff;box-shadow:2px 2px 5px 1px #c1bebe}.top-controls-block[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:space-between}.top-controls-block-left[_ngcontent-%COMP%]{width:calc(100% - 160px);flex:1 1 calc(100% - 160px);padding:20px 20px 10px;display:flex;align-items:center}.top-controls-block-right[_ngcontent-%COMP%]{width:160px;flex:1 0 160px;padding:20px 20px 10px;display:flex;align-items:center;justify-content:flex-end}.top-controls-block-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#404040;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.filters-block[_ngcontent-%COMP%]{height:70px;padding:10px 20px 20px}.grid-block[_ngcontent-%COMP%]{display:flex}.grid-block-content[_ngcontent-%COMP%]{width:calc(100% - 40px);flex:1 0 calc(100% - 40px);position:relative}.grid-block-content[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0)}.grid-block-sidebar[_ngcontent-%COMP%]{width:40px;flex:0 0 40px;border-left:1px solid #ddd}.grid-block-more-info-trigger[_ngcontent-%COMP%]{display:block;height:60px;cursor:pointer;position:relative}.grid-block-more-info-trigger[_ngcontent-%COMP%]:before{content:'\\E5D4';font-family:\"Material Icons\";font-size:24px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.grid-block-more-info-trigger.opened[_ngcontent-%COMP%]:before{content:'\\E5D3'}.top-control-btn[_ngcontent-%COMP%]{color:#5b5b5b;cursor:pointer;margin-left:20px;margin-top:-2px;display:inline-block}.top-control-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.mat-checked[_ngcontent-%COMP%]   .top-control-label[_ngcontent-%COMP%]{color:#2196f3}.tabs-block[_ngcontent-%COMP%]{height:60px;padding:10px 20px 16px}.tab[_ngcontent-%COMP%]{display:inline-block;height:34px;line-height:34px;border-radius:17px;padding-left:15px;padding-right:15px;color:#404040;font-size:14px;font-weight:500;background-color:#e5e5e5;cursor:pointer}.tab.active[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]:hover{color:#3498db;background-color:#e2eff8}.tab[_ngcontent-%COMP%]:not(:last-child){margin-right:15px}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 0 10px;height:45px}.modal-header-right[_ngcontent-%COMP%]   .top-control-btn[_ngcontent-%COMP%]:last-child{margin-right:-4px}.modal-header.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-top:-19px;margin-left:-19px;margin-right:-19px;padding:10px 20px}.modal-header.with-padding[_ngcontent-%COMP%]{padding:10px 20px}.modal-body[_ngcontent-%COMP%]{height:calc(100% - 45px);position:relative}.modal-body.with-footer[_ngcontent-%COMP%]{height:calc(100% - 45px - 50px)}.modal-body.full-height[_ngcontent-%COMP%]{height:100%}.modal-body.with-min-size[_ngcontent-%COMP%]{min-width:850px;min-height:300px;margin-left:-19px;margin-right:-19px}.modal-body.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-left:-19px;margin-right:-19px;margin-bottom:-19px}.modal-body[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.modal-footer[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;justify-content:flex-end;background:#eee;margin:0 -19px -19px;padding:0 19px}.modal-footer-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#404040;padding-right:15px}.modal-footer-text.last[_ngcontent-%COMP%]{padding-left:15px;padding-right:0}.modal-footer-text.last[_ngcontent-%COMP%]:before{content:'|';position:relative;left:-13px}.modal-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.fi-list[_ngcontent-%COMP%]{display:flex;margin:25px 0;padding:15px 0;border-bottom:1px solid #ddd}.fi-list.single[_ngcontent-%COMP%]{padding:5px 0;margin:0;border-bottom:0}.fi-list-item[_ngcontent-%COMP%]{width:33%;flex:0 0 33%;padding:0 5px}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(1){padding-left:0}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(3){padding-right:0}.penetration-list.horizontal[_ngcontent-%COMP%]{display:flex;align-items:center}.penetration-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin:25px 0;padding:15px 0 30px;border-bottom:1px solid #ddd}.horizontal[_ngcontent-%COMP%]   .penetration-item[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:10px 15px 10px 0;margin:0;border-bottom:none}.penetration-title[_ngcontent-%COMP%]{width:30%;flex:0 0 30%;font-size:14px;color:#404040;padding-right:5px;overflow:hidden;text-overflow:ellipsis}.penetration-graph[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:0 5px}.penetration-rank[_ngcontent-%COMP%]{width:20%;flex:0 0 20%;padding:0 5px;text-align:center}.chargeback[_ngcontent-%COMP%]{text-align:center;margin:50px 0 30px}.chargeback[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{margin:0 0 5px;font-size:20px;font-weight:600}.chargeback-value[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#404040}.control-btn-settings[_ngcontent-%COMP%]{display:inline-block;width:24px;height:24px;position:relative;cursor:pointer}.control-btn-settings[_ngcontent-%COMP%]:before{content:'\\e8b8';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#5b5b5b;font-size:24px;font-family:\"Material Icons\"}.drill-info[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;list-style:none;padding:0;margin:0}.drill-info-item[_ngcontent-%COMP%]{color:#404040;font-size:14px;margin-right:25px}.drill-info-label[_ngcontent-%COMP%]{font-weight:400}.drill-info-value[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]{display:flex;height:100%}.grid-wrapper[_ngcontent-%COMP%]{width:340px;flex:1 0 340px}.grid-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 60px - 60px);position:relative}.grid-block[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0);flex:1 1 auto;overflow:hidden}"]],data:{}});function Le(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,2,"span",[["class","tab"]],[[2,"active",null]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onTabClick(e.context.$implicit)&&n),n}),null,null)),(e()(),n["\u0275ted"](1,null,[" "," "])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef])],null,(function(e,t){var l=t.component;e(t,0,0,t.context.$implicit===l.selectedTab),e(t,1,0,n["\u0275unv"](t,1,0,n["\u0275nov"](t,2).transform(l.i18n+"tab."+t.context.$implicit+".label")))}))}function Ee(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,1,"app-comments",[],[[8,"className",0]],[[null,"commentsClose"],[null,"commentsChange"]],(function(e,t,l){var n=!0,a=e.component;return"commentsClose"===t&&(n=!1!==a.onCloseComments()&&n),"commentsChange"===t&&(n=!1!==a.onCommentsChange(l)&&n),n}),v.b,v.a)),n["\u0275did"](1,4964352,null,0,C.a,[O.a,w.a,M.a,n.ChangeDetectorRef,y.b],{type:[0,"type"],subType:[1,"subType"],titles:[2,"titles"]},{commentsClose:"commentsClose",commentsChange:"commentsChange"})],(function(e,t){var l=t.component;e(t,1,0,l.commentType,l.commentSubType,l.commentTitles)}),(function(e,t){e(t,0,0,n["\u0275nov"](t,1).hostClass)}))}function Ne(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,4,"li",[["class","drill-info-item"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,1,"span",[["class","drill-info-label"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",":"])),(e()(),n["\u0275eld"](3,0,null,null,1,"span",[["class","drill-info-value"]],null,null,null,null,null)),(e()(),n["\u0275ted"](4,null,["",""]))],null,(function(e,t){e(t,2,0,t.context.$implicit.label),e(t,4,0,t.context.$implicit.value)}))}function Ve(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"div",[["class","modal-header with-outer-padding-overwrite"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"ul",[["class","drill-info"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,Ne)),n["\u0275did"](3,278528,null,0,D.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,3,0,t.component.drillInfo)}),null)}function Ge(e){return n["\u0275vid"](0,[n["\u0275qud"](402653184,1,{table:0}),n["\u0275qud"](402653184,2,{drillModal:0}),n["\u0275qud"](402653184,3,{transactionModal:0}),n["\u0275qud"](402653184,4,{journalModal:0}),(e()(),n["\u0275eld"](4,0,null,null,1,"app-sidebar",[],[[2,"opened",null]],null,null,K,V)),n["\u0275did"](5,114688,null,0,E,[N.a],null,null),(e()(),n["\u0275eld"](6,0,null,null,27,"div",[["class","grid-wrapper"]],null,null,null,null,null)),(e()(),n["\u0275eld"](7,0,null,null,14,"div",[["class","top-controls-block"]],null,null,null,null,null)),(e()(),n["\u0275eld"](8,0,null,null,5,"div",[["class","top-controls-block-left"]],null,null,null,null,null)),(e()(),n["\u0275eld"](9,0,null,null,4,"h3",[["class","top-controls-block-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](10,null,[" "," ",""])),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](14,0,null,null,7,"div",[["class","top-controls-block-right"]],null,null,null,null,null)),(e()(),n["\u0275eld"](15,0,null,null,2,"app-export-buttons",[],[[2,"small",null]],[[null,"dataExport"]],(function(e,t,l){var n=!0;return"dataExport"===t&&(n=!1!==e.component.exportDataAs(l)&&n),n}),U.b,U.a)),n["\u0275did"](16,114688,null,0,X.a,[T.a],{disabled:[0,"disabled"]},{dataExport:"dataExport"}),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](18,0,null,null,3,"button",[["class","top-control-btn"]],[[8,"disabled",0]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.openCommentsView()&&n),n}),null,null)),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](20,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["comment"])),(e()(),n["\u0275eld"](22,0,null,null,2,"div",[["class","tabs-block"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,Le)),n["\u0275did"](24,278528,null,0,D.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),n["\u0275eld"](25,0,null,null,8,"div",[["class","grid-block"]],null,null,null,null,null)),(e()(),n["\u0275eld"](26,0,null,null,3,"app-default-grid",[],null,[[null,"onTrackChanges"],[null,"filterChanged"]],(function(e,t,l){var n=!0,a=e.component;return"onTrackChanges"===t&&(n=!1!==a.onTrackTableChanges()&&n),"filterChanged"===t&&(n=!1!==a.onagGridChangeFilter(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j,H.a]),n["\u0275did"](28,4964352,[[1,4],["table",4]],0,W.a,[$.a,J.a,Q.a,ee.a,te.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],customGridOptions:[2,"customGridOptions"],loading:[3,"loading"],pagination:[4,"pagination"]},{onTrackChanges:"onTrackChanges",filterChanged:"filterChanged"}),n["\u0275pid"](131072,D.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](30,0,null,null,1,"app-details-totals",[],null,null,null,se,ae)),n["\u0275did"](31,770048,null,0,ne,[],{arrTotalsLabels:[0,"arrTotalsLabels"],values:[1,"values"]},null),(e()(),n["\u0275eld"](32,0,null,null,1,"app-bottom-bar",[],[[2,"opened",null]],null,null,ye,Me)),n["\u0275did"](33,245760,null,0,ue,[we],null,null),(e()(),n["\u0275and"](16777216,null,null,1,null,Ee)),n["\u0275did"](35,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275eld"](36,0,null,null,11,"app-modal",[["class","modal-generic"]],null,null,null,De.b,De.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](38,1228800,[[2,4],["drillModal",4]],0,_e.a,[ke.a,D.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275and"](16777216,null,0,1,null,Ve)),n["\u0275did"](40,16384,null,0,D.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275eld"](41,0,null,0,6,"div",[["class","modal-body with-min-size with-outer-padding-overwrite"]],null,null,null,null,null)),n["\u0275prd"](512,null,D.B,D.C,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["\u0275did"](43,278528,null,0,D.l,[D.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n["\u0275pod"](44,{"full-height":0}),(e()(),n["\u0275eld"](45,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,[[null,"cellClick"]],(function(e,t,l){var n=!0;return"cellClick"===t&&(n=!1!==e.component.onDrillCellClick(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j,H.a]),n["\u0275did"](47,4964352,null,0,W.a,[$.a,J.a,Q.a,ee.a,te.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},{cellClick:"cellClick"}),(e()(),n["\u0275eld"](48,0,null,null,6,"app-modal",[["class","modal-generic"]],null,null,null,De.b,De.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](50,1228800,[[3,4],["transactionModal",4]],0,_e.a,[ke.a,D.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275eld"](51,0,null,0,3,"div",[["class","modal-body with-min-size"]],null,null,null,null,null)),(e()(),n["\u0275eld"](52,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,[[null,"cellClick"]],(function(e,t,l){var n=!0;return"cellClick"===t&&(n=!1!==e.component.onTransactionCellClick(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j,H.a]),n["\u0275did"](54,4964352,null,0,W.a,[$.a,J.a,Q.a,ee.a,te.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},{cellClick:"cellClick"}),(e()(),n["\u0275eld"](55,0,null,null,6,"app-modal",[["class","modal-generic"]],null,null,null,De.b,De.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](57,1228800,[[4,4],["journalModal",4]],0,_e.a,[ke.a,D.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275eld"](58,0,null,0,3,"div",[["class","modal-body with-min-size"]],null,null,null,null,null)),(e()(),n["\u0275eld"](59,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,null,null,q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j,H.a]),n["\u0275did"](61,4964352,null,0,W.a,[$.a,J.a,Q.a,ee.a,te.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],customGridOptions:[2,"customGridOptions"],loading:[3,"loading"]},null)],(function(e,t){var l=t.component;e(t,5,0),e(t,16,0,n["\u0275unv"](t,16,0,n["\u0275nov"](t,17).transform(l.loading$))),e(t,24,0,l.tabs),e(t,28,0,l.data,l.columns,l.options,n["\u0275unv"](t,28,3,n["\u0275nov"](t,29).transform(l.loading$)),!0),e(t,31,0,l.totalsFields,l.amtFields),e(t,33,0),e(t,35,0,l.isCommentsView),e(t,40,0,null==l.drillInfo?null:l.drillInfo.length);var a=e(t,44,0,!(null!=l.drillInfo&&l.drillInfo.length));e(t,43,0,"modal-body with-min-size with-outer-padding-overwrite",a),e(t,47,0,l.drillData,l.drillColumns,l.drillSummaryFields,l.modalGridOptions,l.drillLoading),e(t,54,0,l.transactionData,l.transactionColumns,l.transactionSummaryFields,l.modalGridOptions,l.transactionLoading),e(t,61,0,l.journalData,l.journalColumns,l.modalGridOptions,l.journalLoading)}),(function(e,t){var l=t.component;e(t,4,0,n["\u0275nov"](t,5).isOpened);var a,i=null;e(t,10,0,null==(a=n["\u0275unv"](t,10,0,n["\u0275nov"](t,11).transform(l.selectedMeasure$)))?null:a.name,"1"===(null==(i=n["\u0275unv"](t,10,1,n["\u0275nov"](t,12).transform(l.selectedMeasure$)))?null:i.is_prorated)?" (Prorated)":"1"===(null==(i=n["\u0275unv"](t,10,1,n["\u0275nov"](t,13).transform(l.selectedMeasure$)))?null:i.is_proj)?" (Projected) ":""),e(t,15,0,n["\u0275nov"](t,16).small),e(t,18,0,n["\u0275unv"](t,18,0,n["\u0275nov"](t,19).transform(l.loading$))),e(t,32,0,n["\u0275nov"](t,33).isOpened)}))}function ze(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,1,"ng-component",[],null,null,null,Ge,Ae)),n["\u0275did"](1,245760,null,0,je,[D.d,x.j,Re.a,Fe.a,Z.a,N.a,Ie.a,$.a,we],null,null)],(function(e,t){e(t,1,0)}),null)}var Be=n["\u0275ccf"]("ng-component",je,ze,{},{},[]),Ke=l("s7LF"),Ue=l("QQfA"),Xe=l("IP0z"),qe=l("s6ns"),Je=l("POq0"),Ye=l("821u"),Ze=l("Xd0L"),He=l("/HVE"),We=l("IheW"),Qe=l("5cj1"),et=l("cUpR"),tt=l("gavF"),lt=l("4asF"),nt=l("Mz6y"),at=l("Mc5n"),it=l("hOhj"),ot=l("iInd"),st=l("Fwaw"),rt=l("zMNK"),dt=l("5GAg"),ut=l("l0Bn"),ct=l("kPC6"),pt=l("SXLW"),ht=l("tdaM"),mt=l("0sx3"),gt=l("81ID"),bt=l("oiVm"),ft=l("xSwO"),xt=l("t5D1"),vt=l("iTUp"),Ct=l("FFHx"),Ot=l("PyFA"),wt=l("aBBA"),Mt=l("Cr+6"),yt=l("Ny1k"),Dt=l("LL2G");class kt{}var _t=l("/Lwf"),Tt=l("yotz"),Pt=l("T3zS");l.d(t,"ByStoreModuleNgFactory",(function(){return St}));var St=n["\u0275cmf"](i,[],(function(e){return n["\u0275mod"]([n["\u0275mpd"](512,n.ComponentFactoryResolver,n["\u0275CodegenComponentFactoryResolver"],[[8,[o.a,s.a,r.b,r.a,d.a,u.a,c.a,p.a,h.a,m.a,g.a,b.b,f.a,Be]],[3,n.ComponentFactoryResolver],n.NgModuleRef]),n["\u0275mpd"](4608,D.p,D.o,[n.LOCALE_ID,[2,D.G]]),n["\u0275mpd"](4608,Ke.F,Ke.F,[]),n["\u0275mpd"](4608,Ue.c,Ue.c,[Ue.i,Ue.e,n.ComponentFactoryResolver,Ue.h,Ue.f,n.Injector,n.NgZone,D.d,Xe.b,[2,D.i]]),n["\u0275mpd"](5120,Ue.j,Ue.k,[Ue.c]),n["\u0275mpd"](5120,qe.c,qe.d,[Ue.c]),n["\u0275mpd"](135680,qe.e,qe.e,[Ue.c,n.Injector,[2,D.i],[2,qe.b],qe.c,[3,qe.e],Ue.e]),n["\u0275mpd"](4608,Je.c,Je.c,[]),n["\u0275mpd"](4608,Ye.i,Ye.i,[]),n["\u0275mpd"](5120,Ye.a,Ye.b,[Ue.c]),n["\u0275mpd"](4608,Ze.a,Ze.v,[[2,Ze.f],He.a]),n["\u0275mpd"](4608,We.k,We.q,[D.d,n.PLATFORM_ID,We.o]),n["\u0275mpd"](4608,We.r,We.r,[We.k,We.p]),n["\u0275mpd"](5120,We.a,(function(e){return[e]}),[We.r]),n["\u0275mpd"](4608,We.n,We.n,[]),n["\u0275mpd"](6144,We.l,null,[We.n]),n["\u0275mpd"](4608,We.j,We.j,[We.l]),n["\u0275mpd"](6144,We.b,null,[We.j]),n["\u0275mpd"](4608,We.f,We.m,[We.b,n.Injector]),n["\u0275mpd"](4608,We.c,We.c,[We.f]),n["\u0275mpd"](4608,Q.a,Q.a,[y.b]),n["\u0275mpd"](4608,Ke.f,Ke.f,[]),n["\u0275mpd"](4608,Qe.c,Qe.c,[We.c,et.b]),n["\u0275mpd"](5120,tt.c,tt.j,[Ue.c]),n["\u0275mpd"](4608,lt.a,lt.a,[qe.e]),n["\u0275mpd"](5120,nt.b,nt.c,[Ue.c]),n["\u0275mpd"](4608,et.e,Ze.c,[[2,Ze.g],[2,Ze.l]]),n["\u0275mpd"](4608,Qe.d,Qe.d,[]),n["\u0275mpd"](4608,at.f,at.f,[D.d,n.NgZone,it.i,at.h]),n["\u0275mpd"](4608,we,we,[x.j,Ie.a,N.a,Re.a,Fe.a,$.a]),n["\u0275mpd"](1073742336,D.c,D.c,[]),n["\u0275mpd"](1073742336,ot.s,ot.s,[[2,ot.x],[2,ot.o]]),n["\u0275mpd"](1073742336,x.g,x.g,[]),n["\u0275mpd"](1073742336,Ke.E,Ke.E,[]),n["\u0275mpd"](1073742336,Ke.m,Ke.m,[]),n["\u0275mpd"](1073742336,Xe.a,Xe.a,[]),n["\u0275mpd"](1073742336,Ze.l,Ze.l,[[2,Ze.d],[2,et.f]]),n["\u0275mpd"](1073742336,He.b,He.b,[]),n["\u0275mpd"](1073742336,Ze.u,Ze.u,[]),n["\u0275mpd"](1073742336,st.c,st.c,[]),n["\u0275mpd"](1073742336,rt.g,rt.g,[]),n["\u0275mpd"](1073742336,it.f,it.f,[]),n["\u0275mpd"](1073742336,Ue.g,Ue.g,[]),n["\u0275mpd"](1073742336,qe.k,qe.k,[]),n["\u0275mpd"](1073742336,Je.d,Je.d,[]),n["\u0275mpd"](1073742336,dt.a,dt.a,[]),n["\u0275mpd"](1073742336,Ye.j,Ye.j,[]),n["\u0275mpd"](1073742336,Ze.w,Ze.w,[]),n["\u0275mpd"](1073742336,Ze.n,Ze.n,[]),n["\u0275mpd"](1073742336,We.e,We.e,[]),n["\u0275mpd"](1073742336,We.d,We.d,[]),n["\u0275mpd"](1073742336,ut.a,ut.a,[]),n["\u0275mpd"](1073742336,ct.a,ct.a,[]),n["\u0275mpd"](1073742336,pt.AgGridModule,pt.AgGridModule,[]),n["\u0275mpd"](1073742336,ht.a,ht.a,[]),n["\u0275mpd"](1073742336,mt.a,mt.a,[]),n["\u0275mpd"](1073742336,Ke.A,Ke.A,[]),n["\u0275mpd"](1073742336,Qe.b,Qe.b,[]),n["\u0275mpd"](1073742336,tt.i,tt.i,[]),n["\u0275mpd"](1073742336,tt.f,tt.f,[]),n["\u0275mpd"](1073742336,gt.a,gt.a,[]),n["\u0275mpd"](1073742336,bt.a,bt.a,[]),n["\u0275mpd"](1073742336,nt.e,nt.e,[]),n["\u0275mpd"](1073742336,ft.a,ft.a,[]),n["\u0275mpd"](1073742336,xt.a,xt.a,[]),n["\u0275mpd"](1073742336,vt.a,vt.a,[]),n["\u0275mpd"](1073742336,Ct.a,Ct.a,[]),n["\u0275mpd"](1073742336,Ot.a,Ot.a,[[3,Ot.a],wt.a]),n["\u0275mpd"](1073742336,Mt.a,Mt.a,[]),n["\u0275mpd"](1073742336,yt.a,yt.a,[wt.a]),n["\u0275mpd"](1073742336,Dt.a,Dt.a,[[3,Dt.a],wt.a]),n["\u0275mpd"](1073742336,kt,kt,[]),n["\u0275mpd"](1073742336,at.g,at.g,[]),n["\u0275mpd"](1073742336,_t.a,_t.a,[]),n["\u0275mpd"](1073742336,Tt.b,Tt.b,[]),n["\u0275mpd"](1073742336,Pt.a,Pt.a,[]),n["\u0275mpd"](1073742336,i,i,[wt.a]),n["\u0275mpd"](256,Ze.e,Ze.i,[]),n["\u0275mpd"](256,We.o,"XSRF-TOKEN",[]),n["\u0275mpd"](256,We.p,"X-XSRF-TOKEN",[]),n["\u0275mpd"](1024,ot.m,(function(){return[[{path:"",component:je}]]}),[])])}))},lbNG:function(e,t,l){"use strict";l.d(t,"a",(function(){return d}));var n=l("8Y7J"),a=l("2Vo4"),i=l("itXk"),o=l("lJxs"),s=(l("/kTj"),l("Q34l")),r=l("A/Dr");class d{constructor(e,t,l,i,o,r,d,u){this.el=e,this.viewContainerRef=t,this.resolver=l,this.dialog=i,this.session=o,this.translate=r,this.editorApi=d,this.editorDisabled=!1,this.editorPlacement="bottom",this.onUpdate=new n.EventEmitter,this.highlighted=!1,this.editable=!1,this.editableAccessLevels=new Set([s.a.Admin,s.a.DashboardSupport]),this.highlightedAccessLevels=new Set([s.a.Corporate,s.a.Admin,s.a.DashboardSupport]),this.params$=new a.a(void 0),this.subs=[],this.debug=u.factory(new.target.name)}get title(){return this.editable?this.translate.instant("editor.editable-field.tooltip-text"):""}set sub(e){this.subs.push(e)}ngOnChanges(e){e.params&&this.params$.next(this.params)}ngOnInit(){this.sub=Object(i.b)(this.params$.pipe(Object(o.a)(e=>(this.debug.assert(!(e&&e.fields)||e.fields instanceof Array==1&&e.fields.length,"Params changed. 'fields' should be an array with at least one item. Params: %O",e),e&&e.fields.filter(e=>!!e.uid).length?e:void 0))),this.session.currentUser$).subscribe(([e,t])=>{const l=t.allowToEditBudget,n=this.highlightedAccessLevels.has(+t.AccessLevel),a=!!e;this.highlighted=n&&a,this.editable=l&&a,this.uidEditInfo=e})}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}openEditor(){if(!this.editable)return;if(this.debug.log("Open editor. Disabled: %s",this.editorDisabled),this.editorDisabled)return;const e=document.createEvent("HTMLEvents");e.initEvent("mouseleave",!0,!0),this.el.nativeElement.dispatchEvent(e);const t=this.resolver.resolveComponentFactory(r.a),l=this.viewContainerRef.createComponent(t),n=l.instance;n.hostElement=this.viewContainerRef.element.nativeElement,n.placement=this.editorPlacement,n.uidEditInfo=this.uidEditInfo,n.theme="dark";const a=n.cancel.subscribe(()=>l.destroy()),i=n.apply.subscribe(e=>{this.debug.assert(this.uidEditInfo,"There is no uid edit info");const t=Object.keys(e).map(e=>this.uidEditInfo.fields.find(t=>t.field===e)).map(t=>({uid:t.uid,field:t.fieldUpdate,value:e[t.field]}));l.destroy(),this.update(t)});l.onDestroy(()=>{a.unsubscribe(),i.unsubscribe()})}update(e){const t=e.map(e=>this.editorApi.updateFieldValue(this.params.type,e));Object(i.b)(t).subscribe(t=>{this.debug.log("Updated:",e),t.forEach(e=>{e.saved&&200!==e.saved.status&&this.dialog.warningT("Something went wrong.",{suffix:this.dialog.tryAgainLaterMessage})}),this.onUpdate.emit()},()=>this.dialog.warningT("Something went wrong.",{suffix:this.dialog.tryAgainLaterMessage}))}}}}]);