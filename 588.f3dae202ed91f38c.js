(self.webpackChunkteck=self.webpackChunkteck||[]).push([[588],{1249:function(U,E,i){"use strict";i.d(E,{J:function(){return B}});var p=i(15671),v=i(43144),T=i(60136),k=i(57777),D=i(81042),A=i(94327),t=i(92198),Y=i(61737),u=i(46940),C=i(57676),S=i(22451),d=i(96357),f=i(81876),y=i(65542),w=i(94720),V=i(53773),B=function(){var Z=function(H){(0,T.Z)(G,H);var $=(0,k.Z)(G);function G(L,M,O,F){var g;return(0,p.Z)(this,G),(g=$.call(this)).mineStateService=L,g.reportExportService=M,g.wsService=O,g.downloadService=F,g}return(0,v.Z)(G,[{key:"isConnectionEstablished$",value:function(){return this.wsService.status.pipe((0,t.h)(function(M){return M}))}},{key:"generateFileName",value:function(M,O,F){var g=u.ZA.isCDA(this.mineStateService.getSelectedMineArea())&&S.a.FILE_EXPORT_CDA||S.a.FILE_EXPORT,m=u.Ov.currentDateFormatter(g,this.mineStateService.getSelectedMineArea()),_=M[0].name,x=this.mineStateService.getSelectedMineArea().toUpperCase(),J="DABO_Export_",I="".concat(m,".").concat(O),K="kpiPerSelectedHoles"===F;switch(!0){case M.length>1&&!K&&F!==d.G.ASSAYS:return"".concat(J).concat(x,"_").concat(M.length,"patterns_").concat(I);case K&&1===M.length:return"".concat(J).concat(x,"-").concat(M[0].name,"_holes_report_selected_polygon_").concat(I);case M.length>1&&K:return"".concat(J).concat(x,"_").concat(M.length,"patterns_selected_polygon_").concat(I);case F===d.G.ASSAYS:return"".concat(J,"Assays_").concat(I);case F===d.G.VOM:return"".concat(J).concat(x,"_").concat(_,"_").concat(I);default:return"".concat(J).concat(x,"-").concat(_,"_").concat(I)}}},{key:"generateExportFile",value:function(M,O){this.reportExportService.reset(),this.reportExportService.generationHandler$.next(Object.assign({fileName:M,generationStarted:!0,reportId:(0,D.Z)()},O)),this.trackFileStatus(),this.wsService.send(O)}},{key:"establishConnection",value:function(){this.wsService.connect({url:C.yh.reportGeneration})}},{key:"trackFileStatus",value:function(){var M=this;this.reportExportService.cancelGeneration||(this.fileStatusSubscription=this.wsService.on().subscribe(function(O){var F=O.status.toLowerCase();if(F===f.p.ERROR&&(M.reportExportService.generationHandler$.next({generationError:!0,error:O.status}),M.wsService.closeConnection(),M.fileStatusSubscription.unsubscribe()),F===f.p.SUCCESS){var g=O.report_path.split("/")[2];M.downloadService.download(O.report_path).subscribe(function(m){return(0,A.saveAs)(m,g)}),M.reportExportService.generationHandler$.next({generationComplete:!0}),M.wsService.closeConnection(),M.fileStatusSubscription.unsubscribe()}},function(O){return M.reportExportService.generationHandler$.next({generationError:!0,error:O}),M.wsService.closeConnection(),M.fileStatusSubscription.unsubscribe(),(0,Y._)(O)}))}},{key:"close",value:function(){this.fileStatusSubscription&&this.fileStatusSubscription.unsubscribe(),this.wsService.closeConnection()}}]),G}(u.eO);return Z.\u0275fac=function($){return new($||Z)(y.LFG(w.Hj),y.LFG(w.jN),y.LFG(V.l),y.LFG(w.KS))},Z.\u0275prov=y.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z}()},81876:function(U,E,i){"use strict";i.d(E,{p:function(){return p}});var p=function(){return(v=p||(p={})).SUCCESS="success",v.ERROR="error",v.PENDING="pending",p;var v}()},96357:function(U,E,i){"use strict";i.d(E,{G:function(){return p}});var p=function(){return(v=p||(p={})).ASSAYS="assays",v.KPI="kpi",v.VALUE_TRACKER_TABLE="value_tracker_table",v.VOM="vom",p;var v}()},10079:function(U,E,i){"use strict";i.d(E,{P:function(){return p}});var p=function(){return(v=p||(p={})).PDF="pdf",v.XLSX="xlsx",v.CSV="csv",p;var v}()},18429:function(U,E,i){"use strict";i.r(E),i.d(E,{DaboTrackerModule:function(){return Ze}});var p=i(43144),v=i(15671),T=i(69808),k=i(57676),D=i(35442),A=i(17489),h=i(24850),t=i(65542),Y=i(40520),u=i(94720),C=function(){var e=function(){function o(n,a){(0,v.Z)(this,o),this.http=n,this.mineStateService=a}return(0,p.Z)(o,[{key:"getValueTrackerData",value:function(a){var c=this.getDateRequestParams(a);return this.http.get((0,k.FP)(this.mineStateService.getSelectedMineArea(),k.mb.daboTracker),{params:c})}},{key:"getDateRequestParams",value:function(a){var c=this.mineStateService.getSelectedMineArea(),r=(0,k.XD)(c).startOf("month").valueOf(),l=(0,k.XD)(c).endOf("day").valueOf();return{dateFrom:a?a.dateFrom.valueOf():r,dateTo:a?a.dateTo.valueOf():l,chosenPeriod:a?a.chosenPeriod:D.v.MONTH}}},{key:"updateValueTrackerData",value:function(a,c){var r=this.getDateRequestParams(c),l={month:a.month,drillMeters:this.modifyNumericInput(a.drillMeters,3),drillCost:this.modifyNumericInput(a.drillCost,2),PFOriginal:this.modifyNumericInput(a.PFOriginal,3),truckCostOpHr:this.modifyNumericInput(a.truckCostOpHr,2),targetLs:this.modifyNumericInput(a.targetLs,3)};return this.http.patch((0,k.FP)(this.mineStateService.getSelectedMineArea(),k.mb.daboTracker),Object.assign(Object.assign({},l),r)).pipe((0,h.U)(function(s){return Object.assign(Object.assign({},s),{updatedRow:Object.assign(Object.assign({},s.updatedRow),{month:a.month})})}))}},{key:"modifyNumericInput",value:function(a,c){if(a){var r=(0,A.round)(Number(a),c);return 0===r?Number(a):r}return null}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.LFG(Y.eN),t.LFG(u.Hj))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),S=i(40537),d=function(){return(e=d||(d={})).INITIAL="Loading initial data",e.LOADING="Loading data",e.UPDATING="Updating data",e.LOADING_FILES="Loading files",d;var e}(),f=function(){var e=function(){function o(){(0,v.Z)(this,o)}return(0,p.Z)(o,[{key:"transformDataOnEdit",value:function(a,c){var r=this.transformTableOnEdit(c,a);return{chart:this.transformChartOnEdit(r,a),rows:r,total:Object.assign({},a.total)}}},{key:"transformChartOnEdit",value:function(a,c){var r=this.transformResponseForChart(a);return(0,A.mapValues)(r,function(l,s){return["truckCostDelta","PFCostDelta","drillCostDelta"].includes(s)?l.map(function(P){return P.month===c.updatedRow.month?Object.assign(Object.assign({},P),{y:c.updatedRow[s]}):P}):l})}},{key:"transformTableOnEdit",value:function(a,c){var r=this;return a.rows.map(function(l){return l.month.value===c.updatedRow.month?Object.assign(Object.assign({},r.transformRow(c.updatedRow)),{highlightUpdate:!0}):l})}},{key:"transformResponse",value:function(a){var c=this,r=a.table.map(function(l){return c.transformRow(l)});return{chart:this.transformResponseForChart(r),rows:r,total:a.total}}},{key:"transformResponseForChart",value:function(a){var c=(0,A.findLastIndex)(a,this.areSomeDeltasPresent.bind(this)),r=a.findIndex(this.areSomeDeltasPresent.bind(this));return a.reduce(function(l,s,P){return P>=r&&P<=c&&(l.xAxis.push(s.month.value),["truckCostDelta","PFCostDelta","drillCostDelta"].forEach(function(b){l[b].push({month:s.month.value,y:s[b].value})})),l},{xAxis:[],truckCostDelta:[],PFCostDelta:[],drillCostDelta:[]})}},{key:"areSomeDeltasPresent",value:function(a){return null!==a.drillCostDelta.value||null!==a.truckCostDelta.value||null!==a.PFCostDelta.value}},{key:"hasInputError",value:function(a,c,r){var l=o.fieldsDependencies[c];return!!l&&null===r&&l.some(function(s){return null===a[s]})}},{key:"transformRow",value:function(a){var c=this;return(0,A.mapValues)(a,function(r,l){return{value:r,hasInputError:c.hasInputError(a,l,r)}})}}]),o}();return e.fieldsDependencies={drillCostDelta:["drillMeters","drillCost"],PFCostDelta:["PFOriginal"],truckCostDelta:["truckCostOpHr","targetLs"]},e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),y=function(){var e=function(){function o(n,a,c){(0,v.Z)(this,o),this.apiService=n,this.calculationService=a,this.spinnerService=c}return(0,p.Z)(o,[{key:"getValueTrackerData",value:function(a){var c=this;return this.apiService.getValueTrackerData(a).pipe((0,h.U)(function(r){return c.calculationService.transformResponse(r)}))}},{key:"updateValueTrackerData",value:function(a,c,r){var l=this;return this.spinnerService.startSpinner({active:!0,statusMessage:d.UPDATING}),this.apiService.updateValueTrackerData(a,r).pipe((0,h.U)(function(s){return l.calculationService.transformDataOnEdit(s,c)}),(0,S.x)(function(){l.spinnerService.stopSpinner()}))}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.LFG(C),t.LFG(f),t.LFG(u.V))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),w=i(8929),V=i(80013),B=function(){var e=function(){function o(){(0,v.Z)(this,o),this.filters$=new w.xQ}return(0,p.Z)(o,[{key:"setFilters",value:function(a){this.filters$.next(a)}},{key:"filtersChanged$",value:function(){return this.filters$.pipe((0,V.b)(500))}}]),o}();return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),Z=i(16410),H=i(32807),$=i(42155),G=i(77093),L=i(85899),M=i(4806),O=i(30325),F=i(60136),g=i(57777),m=i(19855),_=i(89255),x=i(7625),J=i(92198),I=i(46940),K=i(46792),ct=i(98871),q=i(42585),lt=i(20224),st=i(19889),dt=i(13761),ut=i(97202);function mt(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"dabo-time-ranges-switcher",7),t.NdJ("periodSelected",function(r){return t.CHM(n),t.oxw(2).onTimePeriodChange(r)}),t.qZA()}if(2&e){var a=t.oxw(2);t.Q6J("isCurrentMonthDefault",!0)("disabled",a.isPageNotAvailable)("resetPeriodValue",a.timeRange)("mineSite",a.mine)("selectedPeriodChanged",a.selectedPeriodType)}}function pt(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"dabo-time-ranges-datepicker",8),t.NdJ("selectedCustomDates",function(r){return t.CHM(n),t.oxw(2).onCustomDatesChange(r)}),t.qZA()}if(2&e){var a=t.oxw(2);t.Q6J("customDatesToReset",a.timeRange)}}function ft(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"dabo-dashboard-header",1),t.NdJ("mobileDetected",function(l){return t.CHM(n),t.oxw().isMobile=l}),t.ynx(1,2),t.TgZ(2,"dabo-time-period-dropdown",3),t.NdJ("timePeriodChange",function(l){return t.CHM(n),t.oxw().onPeriodTypeChange(l)}),t.qZA(),t.BQk(),t.ynx(3,4),t.YNc(4,mt,1,5,"dabo-time-ranges-switcher",5),t.YNc(5,pt,1,1,"dabo-time-ranges-datepicker",6),t.BQk(),t.qZA()}if(2&e){var a=o.$implicit,c=t.oxw();t.Q6J("isDisabled",c.isPageNotAvailable)("title",a("title.value-tracker")),t.xp6(2),t.Q6J("panelClass",c.isMobile?"dab-select":"")("disabled",c.isPageNotAvailable)("selectedPeriodType",c.selectedPeriodType)("periodDropdownOptions",c.timePeriodDropdown),t.xp6(2),t.Q6J("ngIf",!c.isCustomTimePeriod),t.xp6(1),t.Q6J("ngIf",c.isCustomTimePeriod)}}var gt=function(){var e=function(o){(0,F.Z)(a,o);var n=(0,g.Z)(a);function a(c,r,l,s,P){var b;return(0,v.Z)(this,a),(b=n.call(this,P,c,l)).mineStateService=c,b.pagePermissionService=r,b.timePeriodService=l,b.valueTrackerStateService=s,b.cdr=P,b.selectedPeriodType=D.v.MONTH,b.timePeriodDropdown=K.n,b.isMobile=!1,b}return(0,p.Z)(a,[{key:"isPageNotAvailable",get:function(){return!this.pagePermissionService.canAccess(m.K.VALUE_TRACKER)}},{key:"setFiltersState",value:function(){this.isPageNotAvailable||this.valueTrackerStateService.setFilters({dateFrom:this.timeRange.dateFrom,dateTo:this.timeRange.dateTo,chosenPeriod:this.selectedPeriodType})}},{key:"getDefaultTime",value:function(){return(0,k.XD)(this.mine)}}]),a}(ct.E);return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.Hj),t.Y36(u.GO),t.Y36(u.mb),t.Y36(B),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-value-tracker-header"]],features:[t.qOj],decls:1,vars:0,consts:[[3,"isDisabled","title","mobileDetected",4,"transloco"],[3,"isDisabled","title","mobileDetected"],["timePeriodTypeDropdown",""],[3,"panelClass","disabled","selectedPeriodType","periodDropdownOptions","timePeriodChange"],["timeFilters",""],[3,"isCurrentMonthDefault","disabled","resetPeriodValue","mineSite","selectedPeriodChanged","periodSelected",4,"ngIf"],[3,"customDatesToReset","selectedCustomDates",4,"ngIf"],[3,"isCurrentMonthDefault","disabled","resetPeriodValue","mineSite","selectedPeriodChanged","periodSelected"],[3,"customDatesToReset","selectedCustomDates"]],template:function(n,a){1&n&&t.YNc(0,ft,6,8,"dabo-dashboard-header",0)},directives:[q.KI,lt.E,st.Q,T.O5,dt.D,ut.J],encapsulation:2,changeDetection:0}),e}(),tt=i(87545),et=i(9224),vt=i(82768),Ct=i(81042),ht=i(10079),_t=i(96357),X=i(22451),bt=i(15439),Mt=i(1249),at=i(47423),Tt=i(55710),kt=ht.P.XLSX,xt=_t.G.VALUE_TRACKER_TABLE,Ot=function(){var e=function(o){(0,F.Z)(a,o);var n=(0,g.Z)(a);function a(c,r,l,s,P,b,N){var j;return(0,v.Z)(this,a),(j=n.call(this)).exportGenerator=c,j.mineStateService=r,j.valueTrackerStateService=l,j.valueTrackerPeriodService=s,j.reportExportService=P,j.cdr=b,j.route=N,j}return(0,p.Z)(a,[{key:"ngOnInit",value:function(){var r=this;this.subscribeOnRouteChanged(),this.trackReportExportStatus(),this.valueTrackerStateService.filters$.pipe((0,x.R)(this.destroy$)).subscribe(function(l){r.filters=l,r.cdr.markForCheck()})}},{key:"subscribeOnRouteChanged",value:function(){var r=this;this.route.data.pipe((0,x.R)(this.destroy$)).subscribe(function(){r.initFilters()})}},{key:"exportTable",value:function(){var r=this;this.exportGenerator.establishConnection();var s=this.getReportName()+".xlsx",P=Object.assign({reportType:xt,reportFormat:kt,reportId:(0,Ct.Z)()},this.valueTrackerPeriodService.getDateRequestParams(this.filters));this.isConnectionEstablished=this.exportGenerator.isConnectionEstablished$().pipe((0,x.R)(this.destroy$)).subscribe(function(){return r.exportGenerator.generateExportFile(s,P)})}},{key:"initFilters",value:function(){this.filters={dateFrom:(0,k.XD)(this.mineStateService.getSelectedMineArea()).startOf("month").valueOf(),dateTo:(0,k.XD)(this.mineStateService.getSelectedMineArea()).endOf("day").valueOf(),chosenPeriod:D.v.MONTH}}},{key:"trackReportExportStatus",value:function(){var r=this;this.reportExportService.generationHandler$.pipe((0,x.R)(this.destroy$)).subscribe(function(l){((null==l?void 0:l.generationCanceled)||(null==l?void 0:l.generationComplete)||(null==l?void 0:l.generationError))&&r.isConnectionEstablished&&r.isConnectionEstablished.unsubscribe()})}},{key:"formatDate",value:function(r,l){return I.Ov.transformToMineUTCTimeZone(this.mineStateService.getSelectedMineArea(),r,l)}},{key:"getReportName",value:function(){var r,l=this.mineStateService.getSelectedMineArea().toUpperCase(),s="DABO_".concat(l,"_Value Tracking Report"),P=this.formatDate((0,bt.now)(),X.a.FILE_EXPORT_FULL);if((null===(r=this.filters)||void 0===r?void 0:r.chosenPeriod)===D.v.MONTH){var b=this.formatDate(this.filters.dateTo,X.a.FILE_EXPORT_SHORT_YEAR);return"".concat(s,"_").concat(b," - ").concat(P)}var N=this.formatDate(this.filters.dateFrom,X.a.FILE_EXPORT_SHORT_YEAR),j=this.formatDate(this.filters.dateTo,X.a.FILE_EXPORT_SHORT_YEAR);return"".concat(s,"_").concat(N," - ").concat(j," - ").concat(P)}}]),a}(I.eO);return e.\u0275fac=function(n){return new(n||e)(t.Y36(Mt.J),t.Y36(u.Hj),t.Y36(B),t.Y36(C),t.Y36(u.jN),t.Y36(t.sBO),t.Y36(O.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-value-tracker-export"]],inputs:{exportDisabled:"exportDisabled"},features:[t.qOj],decls:2,vars:1,consts:[["daboDebounceClick","","mat-button","",1,"export-button","btn","btn--outline","btn--xs",3,"disabled","debounceClick"]],template:function(n,a){1&n&&(t.TgZ(0,"button",0),t.NdJ("debounceClick",function(){return a.exportTable()}),t._uU(1," Export\n"),t.qZA()),2&n&&t.Q6J("disabled",a.exportDisabled)},directives:[at.lW,Tt.J],encapsulation:2}),e}(),nt=i(4942),R=i(88279),Q=i(93075),Pt=i(44798),Dt=i.n(Pt),yt=i(29138),St=i.n(yt),Et=i(71973),At=i.n(Et),wt=i(465);function Ft(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Month"),t.qZA())}function Rt(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){var n=o.$implicit;t.xp6(1),t.Oqu(n.month.value)}}function It(e,o){1&e&&(t.TgZ(0,"td",14),t._uU(1,"Total"),t.qZA())}function Vt(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Drill m/op.hr Target"),t.qZA())}function Zt(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"td",15)(1,"input",16),t.NdJ("keyup.enter",function(){var l=t.CHM(n).$implicit;return t.oxw().onUpdate("drillMeters",l.month.value)})("blur",function(){var l=t.CHM(n).$implicit;return t.oxw().onBlur("drillMeters",l.month.value)}),t.qZA()()}2&e&&t.Q6J("formGroupName",o.$implicit.month.value)}function Nt(e,o){1&e&&t._UZ(0,"td",14)}function Lt(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Drill Cost/op.hr"),t.qZA())}function Ut(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"td",15)(1,"input",17),t.NdJ("keyup.enter",function(){var l=t.CHM(n).$implicit;return t.oxw().onUpdate("drillCost",l.month.value)})("blur",function(){var l=t.CHM(n).$implicit;return t.oxw().onBlur("drillCost",l.month.value)}),t.qZA()()}2&e&&t.Q6J("formGroupName",o.$implicit.month.value)}function Yt(e,o){1&e&&t._UZ(0,"td",14)}function Ht(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Drill Cost Delta, $"),t.qZA())}function jt(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=o.$implicit;t.ekj("has-input-error",n.drillCostDelta.hasInputError),t.xp6(1),t.hij(" ",t.xi3(2,3,n.drillCostDelta.value,"1.0-2")," ")}}function Bt(e,o){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.total.drillCostDelta,"1.0-2"))}}function Qt(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Standard PF, kg/m\xb3"),t.qZA())}function Gt(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"td",15)(1,"input",18),t.NdJ("keyup.enter",function(){var l=t.CHM(n).$implicit;return t.oxw().onUpdate("PFOriginal",l.month.value)})("blur",function(){var l=t.CHM(n).$implicit;return t.oxw().onBlur("PFOriginal",l.month.value)}),t.qZA()()}2&e&&t.Q6J("formGroupName",o.$implicit.month.value)}function Jt(e,o){1&e&&t._UZ(0,"td",14)}function $t(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"PF Cost Delta, $"),t.qZA())}function Wt(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=o.$implicit;t.ekj("has-input-error",n.PFCostDelta.hasInputError),t.xp6(1),t.hij(" ",t.xi3(2,3,n.PFCostDelta.value,"1.0-2")," ")}}function Kt(e,o){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.total.PFCostDelta,"1.0-2"))}}function Xt(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Truck Cost/op.hr"),t.qZA())}function zt(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"td",15)(1,"input",19),t.NdJ("keyup.enter",function(){var l=t.CHM(n).$implicit;return t.oxw().onUpdate("truckCostOpHr",l.month.value)})("blur",function(){var l=t.CHM(n).$implicit;return t.oxw().onBlur("truckCostOpHr",l.month.value)}),t.qZA()()}2&e&&t.Q6J("formGroupName",o.$implicit.month.value)}function qt(e,o){1&e&&t._UZ(0,"td",14)}function te(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Target LS, sec"),t.qZA())}function ee(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"td",15)(1,"input",20),t.NdJ("keyup.enter",function(){var l=t.CHM(n).$implicit;return t.oxw().onUpdate("targetLs",l.month.value)})("blur",function(){var l=t.CHM(n).$implicit;return t.oxw().onBlur("targetLs",l.month.value)}),t.qZA()()}2&e&&t.Q6J("formGroupName",o.$implicit.month.value)}function ae(e,o){1&e&&t._UZ(0,"td",14)}function ne(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Truck Cost Delta, $"),t.qZA())}function re(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=o.$implicit;t.ekj("has-input-error",n.truckCostDelta.hasInputError),t.xp6(1),t.hij(" ",t.xi3(2,3,n.truckCostDelta.value,"1.0-2")," ")}}function oe(e,o){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.total.truckCostDelta,"1.0-2"))}}function ie(e,o){1&e&&(t.TgZ(0,"th",12),t._uU(1,"Total Value, $"),t.qZA())}function ce(e,o){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=o.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,n.totalOpportunity.value,"1.0-2"))}}function le(e,o){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"customNumber"),t.qZA()),2&e){var n=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,n.total.totalOpportunity,"1.0-2"))}}function se(e,o){1&e&&t._UZ(0,"tr",21)}function de(e,o){1&e&&t._UZ(0,"tr",22),2&e&&t.ekj("mat-row--updated",o.$implicit.highlightUpdate)}function ue(e,o){if(1&e&&t._UZ(0,"tr",23),2&e){var n=t.oxw();t.Q6J("hidden",!n.isTotalVisible)}}var me=function(){var e=function(){function o(n){(0,v.Z)(this,o),this.formBuilder=n,this.rows=[],this.isTotalVisible=!1,this.appliedFormValue={},this.update=new t.vpe,this.handleExportDisabledState=new t.vpe,this.columnProperties=["month","drillMeters","drillCost","drillCostDelta","PFOriginal","PFCostDelta","truckCostOpHr","targetLs","truckCostDelta","totalOpportunity"]}return(0,p.Z)(o,[{key:"data",set:function(a){this.total=a.total,this.rows=a.rows,this.isTotalVisible=a.rows.length>1,this.initTableForm(),this.dataSource=new R.by(this.rows)}},{key:"onBlur",value:function(a,c){var r=this.tableForm.get(c).get(a);this.appliedFormValue[c][a]!==Number(r.value)&&this.onUpdate(a,c)}},{key:"onUpdate",value:function(a,c){var r=this.tableForm.get(c).get(a);r.valid&&this.update.emit(Object.assign(Object.assign({month:c},this.appliedFormValue[c]),(0,nt.Z)({},a,Number(r.value))))}},{key:"isAllInputsEmpty",value:function(a){var c=[];for(var r in a.value)if(a.value.hasOwnProperty(r)){var l=a.value[r];At()(Dt()(l,St()))||c.push(l)}c.length||this.handleExportDisabledState.emit(!0)}},{key:"initTableForm",value:function(){var a=this,c=[Q.kI.required,I.eQ.numericPositive,I.eQ.numericLimitForInteger(5)],r=this.rows.reduce(function(l,s){return Object.assign(Object.assign({},l),(0,nt.Z)({},s.month.value,a.formBuilder.group({drillMeters:[s.drillMeters.value,c],drillCost:[s.drillCost.value,c],PFOriginal:[s.PFOriginal.value,c],truckCostOpHr:[s.truckCostOpHr.value,c],targetLs:[s.targetLs.value,c]})))},{});this.tableForm=this.formBuilder.group(r),this.isAllInputsEmpty(this.tableForm),this.appliedFormValue=Object.assign({},this.tableForm.value)}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(Q.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-tracker-table"]],inputs:{data:"data"},outputs:{update:"update",handleExportDisabledState:"handleExportDisabledState"},decls:46,vars:15,consts:[[1,"table"],[3,"formGroup"],["mat-table","","aria-label","value-tracker-table",3,"dataSource"],[3,"matColumnDef"],["mat-header-cell","","scope","col",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-cell","",3,"formGroupName",4,"matCellDef"],["mat-cell","",3,"has-input-error",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"mat-row--updated",4,"matRowDef","matRowDefColumns"],["class","total","mat-footer-row","",3,"hidden",4,"matFooterRowDef"],["mat-header-cell","","scope","col"],["mat-cell",""],["mat-footer-cell",""],["mat-cell","",3,"formGroupName"],["type","text","formControlName","drillMeters",3,"keyup.enter","blur"],["type","text","formControlName","drillCost",3,"keyup.enter","blur"],["type","text","formControlName","PFOriginal",3,"keyup.enter","blur"],["type","text","formControlName","truckCostOpHr",3,"keyup.enter","blur"],["type","text","formControlName","targetLs",3,"keyup.enter","blur"],["mat-header-row",""],["mat-row",""],["mat-footer-row","",1,"total",3,"hidden"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"form",1)(2,"table",2),t.ynx(3,3),t.YNc(4,Ft,2,0,"th",4),t.YNc(5,Rt,2,1,"td",5),t.YNc(6,It,2,0,"td",6),t.BQk(),t.ynx(7,3),t.YNc(8,Vt,2,0,"th",4),t.YNc(9,Zt,2,1,"td",7),t.YNc(10,Nt,1,0,"td",6),t.BQk(),t.ynx(11,3),t.YNc(12,Lt,2,0,"th",4),t.YNc(13,Ut,2,1,"td",7),t.YNc(14,Yt,1,0,"td",6),t.BQk(),t.ynx(15,3),t.YNc(16,Ht,2,0,"th",4),t.YNc(17,jt,3,6,"td",8),t.YNc(18,Bt,3,4,"td",6),t.BQk(),t.ynx(19,3),t.YNc(20,Qt,2,0,"th",4),t.YNc(21,Gt,2,1,"td",7),t.YNc(22,Jt,1,0,"td",6),t.BQk(),t.ynx(23,3),t.YNc(24,$t,2,0,"th",4),t.YNc(25,Wt,3,6,"td",8),t.YNc(26,Kt,3,4,"td",6),t.BQk(),t.ynx(27,3),t.YNc(28,Xt,2,0,"th",4),t.YNc(29,zt,2,1,"td",7),t.YNc(30,qt,1,0,"td",6),t.BQk(),t.ynx(31,3),t.YNc(32,te,2,0,"th",4),t.YNc(33,ee,2,1,"td",7),t.YNc(34,ae,1,0,"td",6),t.BQk(),t.ynx(35,3),t.YNc(36,ne,2,0,"th",4),t.YNc(37,re,3,6,"td",8),t.YNc(38,oe,3,4,"td",6),t.BQk(),t.ynx(39,3),t.YNc(40,ie,2,0,"th",4),t.YNc(41,ce,3,4,"td",5),t.YNc(42,le,3,4,"td",6),t.BQk(),t.YNc(43,se,1,0,"tr",9),t.YNc(44,de,1,2,"tr",10),t.YNc(45,ue,1,1,"tr",11),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("formGroup",a.tableForm),t.xp6(1),t.Q6J("dataSource",a.dataSource),t.xp6(1),t.Q6J("matColumnDef","month"),t.xp6(4),t.Q6J("matColumnDef","drillMeters"),t.xp6(4),t.Q6J("matColumnDef","drillCost"),t.xp6(4),t.Q6J("matColumnDef","drillCostDelta"),t.xp6(4),t.Q6J("matColumnDef","PFOriginal"),t.xp6(4),t.Q6J("matColumnDef","PFCostDelta"),t.xp6(4),t.Q6J("matColumnDef","truckCostOpHr"),t.xp6(4),t.Q6J("matColumnDef","targetLs"),t.xp6(4),t.Q6J("matColumnDef","truckCostDelta"),t.xp6(4),t.Q6J("matColumnDef","totalOpportunity"),t.xp6(4),t.Q6J("matHeaderRowDef",a.columnProperties),t.xp6(1),t.Q6J("matRowDefColumns",a.columnProperties),t.xp6(1),t.Q6J("matFooterRowDef",a.columnProperties))},directives:[Q._Y,Q.JL,Q.sg,R.BZ,R.w1,R.fO,R.ge,R.Dz,R.ev,R.mD,R.yh,Q.x0,Q.Fj,Q.JJ,Q.u,R.as,R.XQ,R.nj,R.Gk,R.Ke,R.Q2],pipes:[wt.n],styles:["@keyframes tableRowAnimation{0%{background-color:#ffd64640}to{background-color:#fff}}table[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]{width:100%}.teck-basic-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{box-shadow:0 8px 24px #586b7a1a}.teck-basic-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{color:#afb3bb;border-color:transparent;-webkit-backface-visibility:hidden;background-color:#fff;font-weight:500;font-size:10px;vertical-align:middle}.teck-basic-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   .icon-holes[_ngcontent-%COMP%]{margin-right:4px}.teck-basic-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:#586b7a;font-size:12px}.teck-basic-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{background-color:#fff;height:48px}.teck-basic-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#ebeefc40}.teck-basic-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#0165bd0f}.teck-basic-table[_ngcontent-%COMP%]   .mat-row--updated[_ngcontent-%COMP%]{animation:5s tableRowAnimation}.teck-basic-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{color:#2e384d;border:none;font-size:14px;line-height:1.69;letter-spacing:normal}.teck-basic-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:first-child   .mat-cell[_ngcontent-%COMP%]{border-top:1px solid #f1f2fc}.teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{height:44px}.teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:first-of-type{padding-left:14px}.teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{height:33px}.teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:first-of-type, .teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   td.mat-footer-cell[_ngcontent-%COMP%]:first-of-type, .teck-basic-table--kpi[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:first-of-type{padding-left:16px}.teck-basic-table--kpi-two-cols[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{width:50%}.teck-basic-table--kpi-three-cols[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{width:33%}.teck-basic-table--kpi-pattern-design[_ngcontent-%COMP%]   .mat-column-name[_ngcontent-%COMP%]{width:40%}.teck-basic-table--kpi-pattern-design[_ngcontent-%COMP%]   .mat-column-design[_ngcontent-%COMP%]{width:15%}.teck-basic-table--kpi-pattern-design[_ngcontent-%COMP%]   .mat-column-patternId[_ngcontent-%COMP%]{width:30%;text-align:center}.teck-basic-table--kpi-pattern-design[_ngcontent-%COMP%]   .mat-column-executed[_ngcontent-%COMP%]{width:15%}.teck-basic-table--no-borders[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%], .teck-basic-table--no-borders[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border:none}.teck-basic-table--no-borders[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{min-height:33px;height:33px}.teck-basic-table--no-borders[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:first-of-type{margin-top:8px}.teck-basic-table.header-cell-text-center[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{text-align:center}.teck-basic-table.header-cell-text-center[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]   .mat-sort-header-container[_ngcontent-%COMP%]{justify-content:center}.teck-basic-table.body-cell-text-center[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .teck-basic-table.text-center[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%], .teck-basic-table.text-center[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{text-align:center}.assay-table[_ngcontent-%COMP%]   .mat-paginator[_ngcontent-%COMP%]   .mat-form-field-appearance-legacy[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%], .batch-edit-table[_ngcontent-%COMP%]   .mat-paginator[_ngcontent-%COMP%]   .mat-form-field-appearance-legacy[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%]{display:block}.table[_ngcontent-%COMP%]{min-width:523px;overflow-x:auto;margin-bottom:20px}.table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{min-width:1354px}.table[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box}.table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:nth-child(even){background-color:#fafbfe}.table[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{white-space:nowrap}.table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{background-color:#f7f7f8}.table[_ngcontent-%COMP%]   .mat-footer-row[_ngcontent-%COMP%]{height:34px}.table[_ngcontent-%COMP%]   .mat-footer-row.total[_ngcontent-%COMP%]{font-weight:500}.table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .mat-footer-cell[_ngcontent-%COMP%]{width:10%;padding:0;text-align:center;color:#586b7a}.table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:first-of-type, .table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:first-of-type, .table[_ngcontent-%COMP%]   .mat-footer-cell[_ngcontent-%COMP%]:first-of-type{color:#282d32;padding-left:38px;text-align:left}.table[_ngcontent-%COMP%]   .mat-header-cell.has-input-error[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .mat-cell.has-input-error[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .mat-footer-cell.has-input-error[_ngcontent-%COMP%]{color:#f44336}.table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{border-bottom:none;font-weight:400;font-size:12px;color:#00000080;padding:25px 0 13px}.table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:first-of-type{color:#00000080}.table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:last-of-type{font-weight:500}.table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{font-size:14px;font-weight:400;text-align:center;height:34px}.table[_ngcontent-%COMP%]   .mat-row--updated[_ngcontent-%COMP%]{animation:5s tableRowAnimation}.table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-right:rgba(88,107,122,.1);border-bottom:none}.table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80px;height:24px;padding:0 8px;background-color:#fff;border:.5px solid #c9c9c9;border-radius:2px;font-size:14px;color:#282d32}.table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   input.ng-invalid[_ngcontent-%COMP%]{border:.5px solid #f44336;color:#f44336;outline:none}.table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   input.ng-invalid[_ngcontent-%COMP%]:focus{border:.5px solid #f44336;color:#f44336;outline:none}.table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border:.5px solid #008cff;outline:none}"],changeDetection:0}),e}(),z=i(23178),W=i(48619),pe=i(52031),rt=i(3241),ot=function(){var e=function(){function o(n){(0,v.Z)(this,o),this.currencyPipe=n}return(0,p.Z)(o,[{key:"getConfig",value:function(a){var c=this;return(new pe.rc).setChart({height:480,plotBorderColor:W.C.PLOT_BORDER_COLOR,scrollablePlotArea:{minWidth:1280,opacity:0}}).setTitle({text:""}).setXAxis({categories:a.xAxis}).setYAxis({title:{text:"Cost, $",style:{color:W.C.SHULTLE_GRAY_TRANSPARENT}},labels:{style:{color:W.C.SHUTTLE_GRAY}}}).setPlotOptions({column:{centerInCategory:!1,borderWidth:0,minPointLength:3},series:{stickyTracking:!1,states:{inactive:{opacity:1}},cursor:"pointer"}}).setSeries([{type:"column",color:W.C.ANAKIWA_LIGHTER,name:"Drill Cost Delta",data:a.drillCostDelta},{type:"column",name:"PF Cost Delta",color:W.C.HELIOTROPE_DARKER,data:a.PFCostDelta},{type:"column",color:W.C.SALOMIE,name:"Truck Cost Delta",data:a.truckCostDelta}]).setTooltip({animation:!1,formatter:function(){return c.getTooltip(this)}}).setLegend({symbolHeight:12,symbolWidth:12,symbolRadius:0,itemStyle:{fontWeight:"normal"}}).build()}},{key:"getTooltip",value:function(a){var c=this.currencyPipe.transform(a.y,"USD","symbol","1.0-2");return"\n      ".concat(a.series.name,": ").concat(c," <br> ").concat(a.point.month,"\n    ")}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.LFG(rt.R))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}();function fe(e,o){1&e&&t._UZ(0,"dabo-no-data-message")}function ge(e,o){if(1&e&&t._UZ(0,"div",3),2&e){var n=t.oxw();t.Q6J("chart",n.chart)}}var ve=function(){var e=function(){function o(n){(0,v.Z)(this,o),this.valueTrackerChartService=n}return(0,p.Z)(o,[{key:"data",set:function(a){this.hasData=a.xAxis.length>0,this.hasData&&(this.chart=new z.kL(this.valueTrackerChartService.getConfig(a)))}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.Y36(ot))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-value-tracker-chart"]],inputs:{data:"data"},decls:3,vars:2,consts:[[1,"value-tracker-chart"],[4,"ngIf"],[3,"chart",4,"ngIf"],[3,"chart"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0),t.YNc(1,fe,1,0,"dabo-no-data-message",1),t.YNc(2,ge,1,1,"div",2),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",!a.hasData),t.xp6(1),t.Q6J("ngIf",a.hasData))},directives:[T.O5,z.Dm],encapsulation:2,changeDetection:0}),e}();function Ce(e,o){1&e&&t._UZ(0,"mat-progress-bar",7)}function he(e,o){if(1&e){var n=t.EpF();t.TgZ(0,"dabo-tracker-table",10),t.NdJ("handleExportDisabledState",function(){return t.CHM(n),t.oxw(2).disableExport()})("update",function(r){return t.CHM(n),t.oxw(2).onUpdate(r)}),t.qZA()}if(2&e){var a=t.oxw(2);t.Q6J("data",a.data)}}function _e(e,o){if(1&e&&t._UZ(0,"dabo-value-tracker-chart",11),2&e){var n=t.oxw(2);t.Q6J("data",n.data.chart)}}function be(e,o){if(1&e&&(t.ynx(0),t.YNc(1,he,1,1,"dabo-tracker-table",8),t.YNc(2,_e,1,1,"dabo-value-tracker-chart",9),t.BQk()),2&e){var n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.data),t.xp6(1),t.Q6J("ngIf",n.data)}}function Me(e,o){1&e&&t._UZ(0,"dabo-no-data-message")}function Te(e,o){if(1&e&&t.YNc(0,Me,1,0,"dabo-no-data-message",12),2&e){var n=t.oxw();t.Q6J("ngIf",n.data)}}var ke=function(){var e=function(o){(0,F.Z)(a,o);var n=(0,g.Z)(a);function a(c,r,l,s,P){var b;return(0,v.Z)(this,a),(b=n.call(this)).stateService=c,b.facadeService=r,b.exportStateService=l,b.route=s,b.cdr=P,b.loading=!1,b.save$=new w.xQ,b.exportDisabled=!1,b}return(0,p.Z)(a,[{key:"hasData",get:function(){var r;return!(0,A.isEmpty)(null===(r=this.data)||void 0===r?void 0:r.rows)}},{key:"ngOnInit",value:function(){this.getInitialData(),this.trackGenerationStatus(),this.trackFiltersChange(),this.trackSaveStatus()}},{key:"onUpdate",value:function(r){this.save$.next(r)}},{key:"disableExport",value:function(){this.exportDisabled=!0,this.cdr.detectChanges()}},{key:"trackSaveStatus",value:function(){var r=this;this.save$.pipe((0,tt.w)(function(l){return r.facadeService.updateValueTrackerData(l,r.data,r.filters)}),(0,x.R)(this.destroy$)).subscribe(function(l){var s;r.data=l,r.loading=!1,r.exportDisabled=null===(s=r.generationStatus)||void 0===s?void 0:s.generationStarted,r.cdr.markForCheck()})}},{key:"getInitialData",value:function(){var r=this;this.route.data.pipe((0,x.R)(this.destroy$)).subscribe(function(l){r.data=l.valueTracker,r.cdr.markForCheck()})}},{key:"trackFiltersChange",value:function(){var r=this;this.stateService.filters$.pipe((0,x.R)(this.destroy$)).subscribe(function(l){r.filters=l}),this.stateService.filtersChanged$().pipe((0,tt.w)(function(l){return r.loading=!0,r.cdr.markForCheck(),r.facadeService.getValueTrackerData(l)}),(0,x.R)(this.destroy$)).subscribe(function(l){var s;r.data=l,r.loading=!1,r.exportDisabled=!1,(!r.hasData||(null===(s=r.generationStatus)||void 0===s?void 0:s.generationStarted))&&r.disableExport(),r.cdr.markForCheck()})}},{key:"trackGenerationStatus",value:function(){var r=this;this.exportStateService.generationHandler$.pipe((0,x.R)(this.destroy$)).subscribe(function(l){var s;r.generationStatus=l,r.exportDisabled=null===(s=r.generationStatus)||void 0===s?void 0:s.generationStarted,!r.generationStatus&&!r.hasData&&(r.exportDisabled=!0),r.cdr.markForCheck()})}}]),a}(I.eO);return e.\u0275fac=function(n){return new(n||e)(t.Y36(B),t.Y36(y),t.Y36(u.jN),t.Y36(O.gz),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-value-tracker-widget"]],features:[t.qOj],decls:8,vars:6,consts:[[1,"teck-basic-card","widget-tracker"],[3,"widgetIcon","widgetTitle"],["headerAdditionalActions","",3,"exportDisabled"],["widgetBody","",1,"widget-body"],["color","primary","mode","indeterminate",4,"ngIf"],[4,"ngIf","ngIfElse"],["noData",""],["color","primary","mode","indeterminate"],[3,"data","handleExportDisabledState","update",4,"ngIf"],[3,"data",4,"ngIf"],[3,"data","handleExportDisabledState","update"],[3,"data"],[4,"ngIf"]],template:function(n,a){if(1&n&&(t.TgZ(0,"mat-card",0)(1,"dabo-widget-collapsible",1),t._UZ(2,"dabo-value-tracker-export",2),t.TgZ(3,"div",3),t.YNc(4,Ce,1,0,"mat-progress-bar",4),t.YNc(5,be,3,2,"ng-container",5),t.YNc(6,Te,1,1,"ng-template",null,6,t.W1O),t.qZA()()()),2&n){var c=t.MAs(7);t.xp6(1),t.Q6J("widgetIcon","icon-cost")("widgetTitle","DABO Value Tracker"),t.xp6(1),t.Q6J("exportDisabled",a.exportDisabled),t.xp6(2),t.Q6J("ngIf",a.loading),t.xp6(1),t.Q6J("ngIf",a.hasData)("ngIfElse",c)}},directives:[et.a8,vt._,Ot,T.O5,L.pW,me,ve],styles:["[_nghost-%COMP%]     .mat-expansion-panel-header .mat-content .icon-cost:before{color:#e1c06b}[_nghost-%COMP%]     .mat-expansion-panel-header .mat-content .icon-map-feedback:before{color:#ff8c00}.widget-tracker[_ngcontent-%COMP%]{width:100%;margin:0 0 20px}.widget-tracker[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box;margin:auto 0}.widget-tracker[_ngcontent-%COMP%]   .widget-body[_ngcontent-%COMP%]{margin-bottom:20px}.widget-tracker[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]   .mat-toolbar-row[_ngcontent-%COMP%]{padding-right:20px}.widget-tracker[_ngcontent-%COMP%]   .toolbar-title[_ngcontent-%COMP%]{color:#282d32;font-weight:500;font-size:12px;line-height:16px}.widget-tracker.mat-card[_ngcontent-%COMP%]{padding:0}"],changeDetection:0}),e}(),xe=i(57491);function Oe(e,o){1&e&&t._UZ(0,"dabo-value-tracker-widget")}function Pe(e,o){1&e&&t._UZ(0,"dabo-no-data-container")}var De=function(){var e=function(o){(0,F.Z)(a,o);var n=(0,g.Z)(a);function a(c,r,l,s,P,b){var N;return(0,v.Z)(this,a),(N=n.call(this)).title=c,N.pagePermissionService=r,N.cdr=l,N.mineStateService=s,N.router=P,N.customEventService=b,N.noFunctionality=!1,N}return(0,p.Z)(a,[{key:"ngOnInit",value:function(){var r=this;window.dispatchEvent(new Event("resize")),this.title.setTitle(m.K.VALUE_TRACKER),this.mineStateService.selectedMineArea$.pipe((0,x.R)(this.destroy$)).subscribe(function(l){r.selectedMineArea=l.value,r.noFunctionality=!r.pagePermissionService.canAccess(m.K.VALUE_TRACKER),r.cdr.markForCheck()}),this.sendDefaultParams(),this.sendDefaultStateCollectorEvent()}},{key:"sendDefaultStateCollectorEvent",value:function(){var r=this;this.router.events.pipe((0,J.h)(function(l){return l instanceof O.m2}),(0,x.R)(this.destroy$)).subscribe(function(){return r.sendDefaultParams()})}},{key:"sendDefaultParams",value:function(){this.customEventService.event(_.R.DEFAULT_STATE_COLLECTOR,{date_type:D.v.MONTH,page_url:this.router.url})}}]),a}(I.eO);return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.yD),t.Y36(u.GO),t.Y36(t.sBO),t.Y36(u.Hj),t.Y36(O.F0),t.Y36(u.qL))},e.\u0275cmp=t.Xpm({type:e,selectors:[["dabo-dabo-tracker"]],features:[t.qOj],decls:5,vars:4,consts:[[1,"page-block","value-tracker-page"],[1,"page-block__content"],[4,"ngIf"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"dabo-value-tracker-header"),t.TgZ(2,"div",1),t.YNc(3,Oe,1,0,"dabo-value-tracker-widget",2),t.qZA(),t.YNc(4,Pe,1,0,"dabo-no-data-container",2),t.qZA()),2&n&&(t.xp6(2),t.ekj("no-functionality",a.noFunctionality),t.xp6(1),t.Q6J("ngIf",!a.noFunctionality),t.xp6(1),t.Q6J("ngIf",a.noFunctionality))},directives:[gt,T.O5,ke,xe.z],styles:[".page-block.value-tracker-page[_ngcontent-%COMP%]   .page-block__content[_ngcontent-%COMP%]{padding-bottom:20px;height:auto;margin-top:84px}.page-block.value-tracker-page[_ngcontent-%COMP%]   .page-block__content.no-functionality[_ngcontent-%COMP%]{margin-top:0}"],changeDetection:0}),e}(),it=function(){var e=function(){function o(n,a){(0,v.Z)(this,o),this.service=n,this.pagePermissionService=a}return(0,p.Z)(o,[{key:"resolve",value:function(a){if(this.pagePermissionService.canAccess(m.K.VALUE_TRACKER))return this.service.getValueTrackerData()}}]),o}();return e.\u0275fac=function(n){return new(n||e)(t.LFG(y),t.LFG(u.GO))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e}(),ye=[{path:"",component:De,resolve:{valueTracker:it}},{path:"**",redirectTo:""}],Se=function(){var e=(0,p.Z)(function o(){(0,v.Z)(this,o)});return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[it],imports:[[O.Bz.forChild(ye)],O.Bz]}),e}(),Ee=i(70167),Ae=i(34594),we=i(89936),Fe=i(90508),Re=i(66270),Ie=i(73885),Ve=i(1302),Ze=function(){var e=(0,p.Z)(function o(){(0,v.Z)(this,o)});return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[rt.R,C,y,B,f,ot,{provide:q.Hn,useValue:{scope:"date",alias:"dateTranslation"}},{provide:z.mA,useFactory:function(){return[Re,Ie]}},{provide:Fe.sG,useValue:I.Kt}],imports:[[Se,T.ez,R.p0,Ae.g0,Z.L,H.q,$.o9,Ee.n,G.ae,L.Cv,M.j,et.QW,Q.UX,we.d,z.SD,q.y4,at.ot,Ve.o]]}),e}()},94327:function(U,E){var v;void 0!==(v=function(){"use strict";function k(u,C,S){var d=new XMLHttpRequest;d.open("GET",u),d.responseType="blob",d.onload=function(){Y(d.response,C,S)},d.onerror=function(){console.error("could not download file")},d.send()}function D(u){var C=new XMLHttpRequest;C.open("HEAD",u,!1);try{C.send()}catch(S){}return 200<=C.status&&299>=C.status}function A(u){try{u.dispatchEvent(new MouseEvent("click"))}catch(S){var C=document.createEvent("MouseEvents");C.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(C)}}var h="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,t=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Y=h.saveAs||("object"!=typeof window||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!t?function(u,C,S){var d=h.URL||h.webkitURL,f=document.createElement("a");f.download=C=C||u.name||"download",f.rel="noopener","string"==typeof u?(f.href=u,f.origin===location.origin?A(f):D(f.href)?k(u,C,S):A(f,f.target="_blank")):(f.href=d.createObjectURL(u),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){A(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,C,S){if(C=C||u.name||"download","string"!=typeof u)navigator.msSaveOrOpenBlob(function T(u,C){return void 0===C?C={autoBom:!1}:"object"!=typeof C&&(console.warn("Deprecated: Expected third argument to be a object"),C={autoBom:!C}),C.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\ufeff",u],{type:u.type}):u}(u,S),C);else if(D(u))k(u,C,S);else{var d=document.createElement("a");d.href=u,d.target="_blank",setTimeout(function(){A(d)})}}:function(u,C,S,d){if((d=d||open("","_blank"))&&(d.document.title=d.document.body.innerText="downloading..."),"string"==typeof u)return k(u,C,S);var f="application/octet-stream"===u.type,y=/constructor/i.test(h.HTMLElement)||h.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||f&&y||t)&&"undefined"!=typeof FileReader){var V=new FileReader;V.onloadend=function(){var H=V.result;H=w?H:H.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=H:location=H,d=null},V.readAsDataURL(u)}else{var B=h.URL||h.webkitURL,Z=B.createObjectURL(u);d?d.location=Z:location.href=Z,d=null,setTimeout(function(){B.revokeObjectURL(Z)},4e4)}});h.saveAs=Y.saveAs=Y,U.exports=Y}.apply(E,[]))&&(U.exports=v)},29138:function(U,E,i){var p=i(93337),v=i(72671);U.exports=function k(D){return"number"==typeof D||v(D)&&"[object Number]"==p(D)}},81042:function(U,E,i){"use strict";i.d(E,{Z:function(){return S}});var p,v=new Uint8Array(16);function T(){if(!p&&!(p="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(v)}for(var k=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,A=function D(d){return"string"==typeof d&&k.test(d)},h=[],t=0;t<256;++t)h.push((t+256).toString(16).substr(1));var S=function C(d,f,y){var w=(d=d||{}).random||(d.rng||T)();if(w[6]=15&w[6]|64,w[8]=63&w[8]|128,f){y=y||0;for(var V=0;V<16;++V)f[y+V]=w[V];return f}return function Y(d){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,y=(h[d[f+0]]+h[d[f+1]]+h[d[f+2]]+h[d[f+3]]+"-"+h[d[f+4]]+h[d[f+5]]+"-"+h[d[f+6]]+h[d[f+7]]+"-"+h[d[f+8]]+h[d[f+9]]+"-"+h[d[f+10]]+h[d[f+11]]+h[d[f+12]]+h[d[f+13]]+h[d[f+14]]+h[d[f+15]]).toLowerCase();if(!A(y))throw TypeError("Stringified UUID is invalid");return y}(w)}},9224:function(U,E,i){"use strict";i.d(E,{QW:function(){return F},a8:function(){return L}});var p=i(43144),v=i(15671),T=i(65542),k=i(76360),D=i(90508),A=["*",[["mat-card-footer"]]],h=["*","mat-card-footer"],L=function(){var g=(0,p.Z)(function m(_){(0,v.Z)(this,m),this._animationMode=_});return g.\u0275fac=function(_){return new(_||g)(T.Y36(k.Qb,8))},g.\u0275cmp=T.Xpm({type:g,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(_,x){2&_&&T.ekj("_mat-animation-noopable","NoopAnimations"===x._animationMode)},exportAs:["matCard"],ngContentSelectors:h,decls:2,vars:0,template:function(_,x){1&_&&(T.F$t(A),T.Hsn(0),T.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),g}(),F=function(){var g=(0,p.Z)(function m(){(0,v.Z)(this,m)});return g.\u0275fac=function(_){return new(_||g)},g.\u0275mod=T.oAB({type:g}),g.\u0275inj=T.cJS({imports:[[D.BQ],D.BQ]}),g}()}}]);