(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{"/gN3":function(t,l,e){"use strict";var n=e("tFIl");class a extends n.a{constructor(t={}){super(),this.momentIsUtc=!1,this.fillAll(t,["order","name","width","minWidth","pinned","field","tooltipField","align","labelFormat","filter","drillIndex","editable","hide","children","valueGetter","valueFormatter","valueSetter","valueParser","momentFormat","momentIsUtc","customFormatter","cellRenderer","cellEditor","cellEditorParams","cellRendererFramework","cellRendererParams","cellClass","data"])}get hasDrill(){return null!==this.drillIndex}get hasNumericFormat(){return this.labelFormat!==o.Date&&this.labelFormat!==o.Moment&&this.labelFormat!==o.Default&&this.labelFormat!==o.Custom}get hasDefaultFormat(){return this.labelFormat===o.Default}get hasMoneyFormat(){return this.labelFormat===o.Money||this.labelFormat===o.Money2}get hasPercentageFormat(){return this.labelFormat===o.Percentage||this.labelFormat===o.Percentage1DecWithZeroMantissa||this.labelFormat===o.Percentage2DecWithZeroMantissa}}var o=function(t){return t[t.Date=0]="Date",t[t.Moment=1]="Moment",t[t.Money=2]="Money",t[t.Money2=3]="Money2",t[t.MoneyAbbr=4]="MoneyAbbr",t[t.Integer=5]="Integer",t[t.Float=6]="Float",t[t.FloatWithTwoDecimalPlaces=7]="FloatWithTwoDecimalPlaces",t[t.FloatWithOneDecimalPlace=8]="FloatWithOneDecimalPlace",t[t.Cnt=9]="Cnt",t[t.Percentage=10]="Percentage",t[t.Percentage1DecWithZeroMantissa=11]="Percentage1DecWithZeroMantissa",t[t.Percentage2DecWithZeroMantissa=12]="Percentage2DecWithZeroMantissa",t[t.Custom=13]="Custom",t[t.Default=14]="Default",t}({}),i=function(t){return t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t}({}),r=function(t){return t[t.None=0]="None",t[t.String=1]="String",t[t.NumberRange=2]="NumberRange",t[t.DateRange=3]="DateRange",t[t.MultiChoice=4]="MultiChoice",t}({});class s{constructor(t={}){Object.keys(t).forEach(l=>this[l]=new.target.value(t[l]))}static value(t,l=null){return null==t?l:t}}e.d(l,"a",(function(){return a})),e.d(l,"d",(function(){return o})),e.d(l,"b",(function(){return i})),e.d(l,"c",(function(){return r})),e.d(l,"e",(function(){return s}))},Exwp:function(t,l,e){"use strict";e.r(l);var n=e("8Y7J");const a="cabinet.operations.by-store.";class o{constructor(t){t.addLoaderWithPrefixedTranslations("/cabinet/operations/by-store",a)}}var i=e("pMnS"),r=e("NcP4"),s=e("t68o"),c=e("zbXB"),d=e("GsI2"),u=e("eliu"),p=e("0Xvm"),m=e("VOAG"),g=e("aYrz"),h=e("tfhy"),b=e("HOtD"),f=e("ubcW"),x=e("FpoO"),v=e("JNvI"),C=e("pGru"),y=e("YbeN"),M=e("RiRU"),O=e("/kTj"),_=e("OTv+"),P=e("eeq/"),w=e("zXMq"),k=e("2Vgt"),T=e("+2T5"),F=e("SVse"),D=e("S5eV"),R=e("zeHk"),A=e("+bil"),S=e("S+vS"),I=e("ChPW"),E=e("TSSN"),B=e("IqdZ"),G=e("TUN4"),$=e("K5C0"),j=e("mvzq"),N=e("Mz6y"),V=e("QQfA"),z=e("hOhj"),L=e("/HVE"),q=e("5GAg"),Z=e("IP0z"),W=e("cUpR"),X=e("MlvX"),J=e("Xd0L"),K=e("Azqq"),U=e("JjoW"),H=e("s7LF"),Y=e("HsOI"),Q=e("dJrM"),tt=e("omvX"),lt=e("oJZn"),et=e("pBi1"),nt=e("mS0u"),at=e("MmlZ"),ot=e("fFD9"),it=e("pCim");class rt{constructor(t,l,e){this.translate=t,this.filterData=l,this.dataService=e,this.i18n=a,this.isOpened=!0,this.isEmptyChartPanel=!1,this.chartClick=new n.EventEmitter,this.totalItemClick=new n.EventEmitter,this.editTotalFields=new n.EventEmitter,this.isAccClient=!1,this.isByStackedBars=!1,this.subs=[]}get hasEditTotalButton(){return!this.isAccClient&&this.totals&&this.totals.length>1}get chartClass(){return{"by-salesperson":this.viewType===it.e.BySalesperson,"by-make":this.viewType===it.e.ByMake,"by-model":this.viewType===it.e.ByModel,"by-customer":this.viewType===it.e.ByCustomer}}set sub(t){this.subs.push(t)}ngOnInit(){this.data$=this.dataService.bottomBarData$,this.initSubscriptions()}ngOnDestroy(){this.subs.forEach(t=>t.unsubscribe())}onToggle(){this.isOpened=!this.isOpened}onChartClick(t){this.chartClick.emit(t.data)}onTotalItemClick(t){this.totalItemClick.emit(t)}onEditTotalFields(){this.editTotalFields.emit()}onFilterChange(t,l){switch(t){case"viewType":this.dataService.setBottomBarViewType(l)}}onByStackedBarsChange(t){this.dataService.setByStackedBars(t),this.isByStackedBars=t}initSubscriptions(){this.sub=this.filterData.selectedReport$.subscribe(t=>{this.isEmptyChartPanel=!this.filterData.isSalesReport(t)}),this.sub=this.translate.get(["bottom-bar.filters.view.label","bottom-bar.filters.view.by-salesperson.label","bottom-bar.filters.view.by-make.label","bottom-bar.filters.view.by-model.label","bottom-bar.filters.view.by-customer.label"].map(t=>a+t)).pipe(Object(ot.a)(this.dataService.bottomBarViewType$)).subscribe(([t,l])=>{const e={label:t[a+"bottom-bar.filters.view.label"],name:"viewType",items:[{label:t[a+"bottom-bar.filters.view.by-salesperson.label"],value:it.e.BySalesperson},{label:t[a+"bottom-bar.filters.view.by-make.label"],value:it.e.ByMake},{label:t[a+"bottom-bar.filters.view.by-model.label"],value:it.e.ByModel},{label:t[a+"bottom-bar.filters.view.by-customer.label"],value:it.e.ByCustomer}]};e.value=l,this.viewType=l,this.filters=[e]})}}var st=e("9oLD"),ct=e("2Vo4"),dt=e("pLZG"),ut=e("/uUt"),pt=e("Kj3r"),mt=e("lJxs"),gt=e("w1tV"),ht=e("vkgz"),bt=e("LvDl");class ft{constructor(t,l,e,n){this.filterData=t,this.dataApi=l,this.translate=e,this.formatter=n,this.defaultViewType=it.e.BySalesperson,this._data$=new ct.a(void 0),this._loading$=new ct.a(void 0),this._bottomBarData$=new ct.a(void 0),this._bottomBarViewType$=new ct.a(this.defaultViewType),this._byStackedBars$=new ct.a(!1),this.subs=[],this.initInternal()}set sub(t){this.subs.push(t)}destroy(){this.subs.forEach(t=>t.unsubscribe()),this.subs=[],this._data$.next(void 0),this._bottomBarData$.next(void 0),this._bottomBarViewType$.next(this.defaultViewType)}init(){this.initSubscriptions()}setBottomBarViewType(t){this._bottomBarViewType$.next(t)}setByStackedBars(t){this._byStackedBars$.next(t)}initInternal(){this.data$=this._data$.pipe(Object(dt.a)(t=>!!t)),this.loading$=this._loading$.asObservable(),this.bottomBarViewType$=this._bottomBarViewType$.pipe(Object(dt.a)(t=>!!t),Object(ut.a)()),this.bottomBarData$=this.data$.pipe(Object(ot.a)(this.bottomBarViewType$,this._byStackedBars$,this.filterData.isAcc$,this.translate.get(["bottom-bar.chart.amount.label","bottom-bar.chart.count.label"].map(t=>a+t))),Object(pt.a)(100),Object(mt.a)(([t,l,e,n,o])=>{const i={};for(const a of t.data){const t=a[l];if(!t)continue;const e="F"===a.status&&n,o=e?"accFrontGross":"FrontGross",r=e?"accBackGross":"BackGross";i[t]||(i[t]={title:t,frontGross:0,backGross:0,cnt:0}),i[t].frontGross+=a[o]?+a[o]:+a.amt||0,i[t].backGross+=a[r]?+a[r]:0,i[t].cnt+=1}const r=bt.sortBy(Object.keys(i).map(t=>i[t]),[t=>t.title.toLowerCase()]),s={data:[[],[]],labels:[],colors:[[],[]],tooltip:{titles:[[],[]],labels:[[],[]]},xAxes:{stacked:e,ticks:{fontSize:12}},yAxes:{stacked:e}};for(const c of r)["frontGross","backGross"].forEach((t,l)=>{s.data[l].push(+c[t]),s.colors[l].push(0===l?"blue":"blue-light"),s.tooltip.titles[l].push(c.title),s.tooltip.labels[l].push(o[a+"bottom-bar.chart.amount.label"]+": "+this.formatter.abbrMoney(+c[t],{K:1,M:1})+" | "+o[a+"bottom-bar.chart.count.label"]+": "+this.formatter.number(+c.cnt,{noZeroMantissa:!0}))}),s.labels.push(c.title.substr(0,25));return s}),Object(gt.a)())}initSubscriptions(){this.sub=this.filterData.value$.pipe(Object(pt.a)(100),Object(ht.a)(()=>this._loading$.next(!0))).subscribe(t=>{this.dataApi.getByStore(t).subscribe(t=>{this._data$.next(t),this._loading$.next(!1)})}),this.sub=this.filterData.viewTypeFilter$.pipe(Object(dt.a)(t=>!!t)).subscribe(({type:t})=>{this.setBottomBarViewType(t)})}}var xt=n["\u0275crt"]({encapsulation:0,styles:[[".grid-wrapper[_ngcontent-%COMP%]{width:100%;flex:1 1 100%;height:100%;max-width:100%;background-color:#fff;box-shadow:2px 2px 5px 1px #c1bebe}.top-controls-block[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:space-between}.top-controls-block-left[_ngcontent-%COMP%]{width:calc(100% - 160px);flex:1 1 calc(100% - 160px);padding:20px 20px 10px;display:flex;align-items:center}.top-controls-block-right[_ngcontent-%COMP%]{width:160px;flex:1 0 160px;padding:20px 20px 10px;display:flex;align-items:center;justify-content:flex-end}.top-controls-block-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#404040;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.filters-block[_ngcontent-%COMP%]{height:70px;padding:10px 20px 20px}.grid-block[_ngcontent-%COMP%]{display:flex;height:calc(100% - 60px - 70px)}.grid-block-content[_ngcontent-%COMP%]{width:calc(100% - 40px);flex:1 0 calc(100% - 40px);position:relative}.grid-block-content[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0)}.grid-block-sidebar[_ngcontent-%COMP%]{width:40px;flex:0 0 40px;border-left:1px solid #ddd}.grid-block-more-info-trigger[_ngcontent-%COMP%]{display:block;height:60px;cursor:pointer;position:relative}.grid-block-more-info-trigger[_ngcontent-%COMP%]:before{content:'\\E5D4';font-family:\"Material Icons\";font-size:24px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.grid-block-more-info-trigger.opened[_ngcontent-%COMP%]:before{content:'\\E5D3'}.top-control-btn[_ngcontent-%COMP%]{color:#5b5b5b;cursor:pointer;margin-left:20px;margin-top:-2px;display:inline-block}.top-control-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.mat-checked[_ngcontent-%COMP%]   .top-control-label[_ngcontent-%COMP%]{color:#2196f3}.tabs-block[_ngcontent-%COMP%]{height:60px;padding:10px 20px 16px}.tab[_ngcontent-%COMP%]{display:inline-block;height:34px;line-height:34px;border-radius:17px;padding-left:15px;padding-right:15px;color:#404040;font-size:14px;font-weight:500;background-color:#e5e5e5;cursor:pointer}.tab.active[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]:hover{color:#3498db;background-color:#e2eff8}.tab[_ngcontent-%COMP%]:not(:last-child){margin-right:15px}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 0 10px;height:45px}.modal-header-right[_ngcontent-%COMP%]   .top-control-btn[_ngcontent-%COMP%]:last-child{margin-right:-4px}.modal-header.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-top:-19px;margin-left:-19px;margin-right:-19px;padding:10px 20px}.modal-header.with-padding[_ngcontent-%COMP%]{padding:10px 20px}.modal-body[_ngcontent-%COMP%]{height:calc(100% - 45px);position:relative}.modal-body.with-footer[_ngcontent-%COMP%]{height:calc(100% - 45px - 50px)}.modal-body.full-height[_ngcontent-%COMP%]{height:100%}.modal-body.with-min-size[_ngcontent-%COMP%]{min-width:850px;min-height:300px;margin-left:-19px;margin-right:-19px}.modal-body.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-left:-19px;margin-right:-19px;margin-bottom:-19px}.modal-body[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.modal-footer[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;justify-content:flex-end;background:#eee;margin:0 -19px -19px;padding:0 19px}.modal-footer-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#404040;padding-right:15px}.modal-footer-text.last[_ngcontent-%COMP%]{padding-left:15px;padding-right:0}.modal-footer-text.last[_ngcontent-%COMP%]:before{content:'|';position:relative;left:-13px}.modal-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.fi-list[_ngcontent-%COMP%]{display:flex;margin:25px 0;padding:15px 0;border-bottom:1px solid #ddd}.fi-list.single[_ngcontent-%COMP%]{padding:5px 0;margin:0;border-bottom:0}.fi-list-item[_ngcontent-%COMP%]{width:33%;flex:0 0 33%;padding:0 5px}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(1){padding-left:0}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(3){padding-right:0}.penetration-list.horizontal[_ngcontent-%COMP%]{display:flex;align-items:center}.penetration-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin:25px 0;padding:15px 0 30px;border-bottom:1px solid #ddd}.horizontal[_ngcontent-%COMP%]   .penetration-item[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:10px 15px 10px 0;margin:0;border-bottom:none}.penetration-title[_ngcontent-%COMP%]{width:30%;flex:0 0 30%;font-size:14px;color:#404040;padding-right:5px;overflow:hidden;text-overflow:ellipsis}.penetration-graph[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:0 5px}.penetration-rank[_ngcontent-%COMP%]{width:20%;flex:0 0 20%;padding:0 5px;text-align:center}.chargeback[_ngcontent-%COMP%]{text-align:center;margin:50px 0 30px}.chargeback[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{margin:0 0 5px;font-size:20px;font-weight:600}.chargeback-value[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#404040}.control-btn-settings[_ngcontent-%COMP%]{display:inline-block;width:24px;height:24px;position:relative;cursor:pointer}.control-btn-settings[_ngcontent-%COMP%]:before{content:'\\e8b8';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#5b5b5b;font-size:24px;font-family:\"Material Icons\"}.drill-info[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;list-style:none;padding:0;margin:0}.drill-info-item[_ngcontent-%COMP%]{color:#404040;font-size:14px;margin-right:25px}.drill-info-label[_ngcontent-%COMP%]{font-weight:400}.drill-info-value[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]{display:block;flex:0 0 50px;transition:flex .5s ease}.opened[_nghost-%COMP%]{flex:0 0 275px}.empty-chart-panel[_nghost-%COMP%]{flex:0 0 50px}.bottom-bar-header[_ngcontent-%COMP%]{height:50px;padding:5px 20px;display:flex;align-items:center;justify-content:space-between;border-top:1px solid #ddd}  .opened .bottom-bar-header{border-top:none;border-bottom:1px solid #ddd}.bottom-bar-header.narrow[_ngcontent-%COMP%]{height:110px}.bottom-bar-header-left[_ngcontent-%COMP%], .bottom-bar-header-right[_ngcontent-%COMP%]{display:flex;align-items:center}.narrow[_ngcontent-%COMP%]   .bottom-bar-header-right[_ngcontent-%COMP%]{display:block}.bottom-bar-body[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .5s ease}  .opened .bottom-bar-body{height:calc(100% - 50px)}  .opened .bottom-bar-body.wide{height:calc(100% - 110px)}.bottom-bar-trigger[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:#747474;cursor:pointer;position:relative;padding-left:24px;text-transform:uppercase}.bottom-bar-trigger[_ngcontent-%COMP%]:before{content:'\\e316';font-family:\"Material Icons\";font-size:24px;color:inherit;cursor:inherit;display:inline-block;position:absolute;left:0;top:50%;transform:translateY(-54%)}  .opened .bottom-bar-trigger:before{content:'\\e313'}.bottom-bar-label[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#404040;margin-right:20px}.store-details[_ngcontent-%COMP%]{height:100%}.store-details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;padding:20px 20px 10px;height:80px}.store-details-body[_ngcontent-%COMP%]{height:calc(100% - 80px);padding:10px 20px 20px}.store-details-heading[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500;color:#404040}mat-form-field[_ngcontent-%COMP%]{margin-right:15px}app-bar-chart[_ngcontent-%COMP%]{max-height:125px}.chart-label[_ngcontent-%COMP%]{display:inline-block;font-size:12px;color:#747474;margin-top:15px;margin-right:20px;position:relative;padding-left:22px}.chart-label[_ngcontent-%COMP%]:before{content:'';display:inline-block;width:12px;height:12px;position:absolute;top:50%;left:0;transform:translateY(-45%)}.chart-label.front-gross[_ngcontent-%COMP%]:before{background-color:#00458f}.chart-label.back-gross[_ngcontent-%COMP%]:before{background-color:#44b4d4}.totals-list[_ngcontent-%COMP%]{display:flex;width:600px;margin:0;padding:0;list-style:none}.totals-list-item[_ngcontent-%COMP%]{width:33%;flex:0 0 33%;font-size:14px;font-weight:500;color:#404040}.totals-list-label[_ngcontent-%COMP%]{display:inline-block}.totals-list-value.clickable[_ngcontent-%COMP%]{color:#3498db;text-decoration:underline;cursor:pointer}"]],data:{}});function vt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"button",[["class","bottom-bar-trigger"]],null,[[null,"click"]],(function(t,l,e){var n=!0;return"click"===l&&(n=!1!==t.component.onToggle()&&n),n}),null,null)),(t()(),n["\u0275ted"](1,null,["",""])),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef])],null,(function(t,l){var e=l.component;t(l,1,0,n["\u0275unv"](l,1,0,n["\u0275nov"](l,2).transform(e.i18n+(e.isOpened?"bottom-bar.expand.label":"bottom-bar.collapse.label"))))}))}function Ct(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,6,null,null,null,null,null,null,null)),(t()(),n["\u0275eld"](1,0,null,null,1,"span",[["class","totals-list-label"]],null,null,null,null,null)),(t()(),n["\u0275ted"](2,null,["",""])),(t()(),n["\u0275ted"](-1,null,[": "])),(t()(),n["\u0275eld"](4,0,null,null,2,"span",[["class","totals-list-value"]],[[2,"clickable",null]],[[null,"click"]],(function(t,l,e){var n=!0;return"click"===l&&(n=!1!==(t.parent.context.$implicit.clickable&&t.component.onTotalItemClick(t.parent.context.$implicit))&&n),n}),null,null)),(t()(),n["\u0275ted"](5,null,["",""])),n["\u0275ppd"](6,2)],null,(function(t,l){t(l,2,0,l.parent.context.$implicit.label),t(l,4,0,l.parent.context.$implicit.clickable);var e=n["\u0275unv"](l,5,0,t(l,6,0,n["\u0275nov"](l.parent.parent.parent.parent,0),l.parent.context.$implicit.value,"cnt"));t(l,5,0,e)}))}function yt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"li",[["class","totals-list-item"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Ct)),n["\u0275did"](2,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(t,l){t(l,2,0,l.context.$implicit.label)}),null)}function Mt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"ul",[["class","totals-list"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,yt)),n["\u0275did"](2,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(t,l){t(l,2,0,l.context.$implicit)}),null)}function Ot(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,null,null,null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Mt)),n["\u0275did"](2,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),n["\u0275and"](0,null,null,0))],(function(t,l){t(l,2,0,l.component.accTotals)}),null)}function _t(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"span",[["class","bottom-bar-label"]],null,null,null,null,null)),(t()(),n["\u0275ted"](1,null,["",": ",""])),n["\u0275ppd"](2,2)],null,(function(t,l){var e=l.parent.context.$implicit.label,a=n["\u0275unv"](l,1,1,t(l,2,0,n["\u0275nov"](l.parent.parent.parent,0),l.parent.context.$implicit.value,l.parent.context.$implicit.format));t(l,1,0,e,a)}))}function Pt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,null,null,null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,_t)),n["\u0275did"](2,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275and"](0,null,null,0))],(function(t,l){t(l,2,0,l.context.$implicit.visible)}),null)}function wt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,null,null,null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Pt)),n["\u0275did"](2,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),n["\u0275and"](0,null,null,0))],(function(t,l){t(l,2,0,l.component.totals)}),null)}function kt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,16777216,null,null,2,"button",[["class","control-btn-settings"]],null,[[null,"click"],[null,"longpress"],[null,"keydown"],[null,"touchend"]],(function(t,l,e){var a=!0,o=t.component;return"longpress"===l&&(a=!1!==n["\u0275nov"](t,1).show()&&a),"keydown"===l&&(a=!1!==n["\u0275nov"](t,1)._handleKeydown(e)&&a),"touchend"===l&&(a=!1!==n["\u0275nov"](t,1)._handleTouchend()&&a),"click"===l&&(a=!1!==o.onEditTotalFields()&&a),a}),null,null)),n["\u0275did"](1,212992,null,0,N.d,[V.c,n.ElementRef,z.e,n.ViewContainerRef,n.NgZone,L.a,q.c,q.h,N.b,[2,Z.b],[2,N.a],[2,W.f]],{message:[0,"message"]},null),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275and"](0,null,null,0))],(function(t,l){var e=l.component;t(l,1,0,n["\u0275unv"](l,1,0,n["\u0275nov"](l,2).transform(e.i18n+"edit-total-fields.button.tooltip")))}),null)}function Tt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],(function(t,l,e){var a=!0;return"click"===l&&(a=!1!==n["\u0275nov"](t,1)._selectViaInteraction()&&a),"keydown"===l&&(a=!1!==n["\u0275nov"](t,1)._handleKeydown(e)&&a),a}),X.b,X.a)),n["\u0275did"](1,8568832,[[10,4]],0,J.p,[n.ElementRef,n.ChangeDetectorRef,[2,J.j],[2,J.o]],{value:[0,"value"]},null),(t()(),n["\u0275ted"](2,0,[" "," "]))],(function(t,l){t(l,1,0,l.context.$implicit.value)}),(function(t,l){t(l,0,0,n["\u0275nov"](l,1)._getTabIndex(),n["\u0275nov"](l,1).selected,n["\u0275nov"](l,1).multiple,n["\u0275nov"](l,1).active,n["\u0275nov"](l,1).id,n["\u0275nov"](l,1)._getAriaSelected(),n["\u0275nov"](l,1).disabled.toString(),n["\u0275nov"](l,1).disabled),t(l,2,0,l.context.$implicit.label)}))}function Ft(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,11,"mat-select",[["class","mat-select"],["role","listbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[1,"id",0],[1,"tabindex",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-required",0],[1,"aria-disabled",0],[1,"aria-invalid",0],[1,"aria-owns",0],[1,"aria-multiselectable",0],[1,"aria-describedby",0],[1,"aria-activedescendant",0],[2,"mat-select-disabled",null],[2,"mat-select-invalid",null],[2,"mat-select-required",null],[2,"mat-select-empty",null]],[[null,"ngModelChange"],[null,"keydown"],[null,"focus"],[null,"blur"]],(function(t,l,e){var a=!0,o=t.component;return"keydown"===l&&(a=!1!==n["\u0275nov"](t,5)._handleKeydown(e)&&a),"focus"===l&&(a=!1!==n["\u0275nov"](t,5)._onFocus()&&a),"blur"===l&&(a=!1!==n["\u0275nov"](t,5)._onBlur()&&a),"ngModelChange"===l&&(a=!1!==o.onFilterChange(t.context.$implicit.name,e)&&a),a}),K.b,K.a)),n["\u0275prd"](6144,null,J.j,null,[U.c]),n["\u0275did"](2,671744,null,0,H.v,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),n["\u0275prd"](2048,null,H.r,null,[H.v]),n["\u0275did"](4,16384,null,0,H.s,[[4,H.r]],null,null),n["\u0275did"](5,2080768,null,3,U.c,[z.i,n.ChangeDetectorRef,n.NgZone,J.b,n.ElementRef,[2,Z.b],[2,H.u],[2,H.k],[2,Y.c],[6,H.r],[8,null],U.a,q.j],{placeholder:[0,"placeholder"]},null),n["\u0275qud"](603979776,10,{options:1}),n["\u0275qud"](603979776,11,{optionGroups:1}),n["\u0275qud"](603979776,12,{customTrigger:0}),n["\u0275prd"](2048,[[1,4],[2,4]],Y.d,null,[U.c]),(t()(),n["\u0275and"](16777216,null,1,1,null,Tt)),n["\u0275did"](11,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(t,l){t(l,2,0,l.context.$implicit.value),t(l,5,0,l.context.$implicit.label),t(l,11,0,l.context.$implicit.items)}),(function(t,l){t(l,0,1,[n["\u0275nov"](l,4).ngClassUntouched,n["\u0275nov"](l,4).ngClassTouched,n["\u0275nov"](l,4).ngClassPristine,n["\u0275nov"](l,4).ngClassDirty,n["\u0275nov"](l,4).ngClassValid,n["\u0275nov"](l,4).ngClassInvalid,n["\u0275nov"](l,4).ngClassPending,n["\u0275nov"](l,5).id,n["\u0275nov"](l,5).tabIndex,n["\u0275nov"](l,5)._getAriaLabel(),n["\u0275nov"](l,5)._getAriaLabelledby(),n["\u0275nov"](l,5).required.toString(),n["\u0275nov"](l,5).disabled.toString(),n["\u0275nov"](l,5).errorState,n["\u0275nov"](l,5).panelOpen?n["\u0275nov"](l,5)._optionIds:null,n["\u0275nov"](l,5).multiple,n["\u0275nov"](l,5)._ariaDescribedby||null,n["\u0275nov"](l,5)._getAriaActiveDescendant(),n["\u0275nov"](l,5).disabled,n["\u0275nov"](l,5).errorState,n["\u0275nov"](l,5).required,n["\u0275nov"](l,5).empty])}))}function Dt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,12,"mat-form-field",[["class","mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-has-label",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,Q.b,Q.a)),n["\u0275did"](1,7520256,null,9,Y.c,[n.ElementRef,n.ChangeDetectorRef,[2,J.h],[2,Z.b],[2,Y.a],L.a,n.NgZone,[2,tt.a]],null,null),n["\u0275qud"](603979776,1,{_controlNonStatic:0}),n["\u0275qud"](335544320,2,{_controlStatic:0}),n["\u0275qud"](603979776,3,{_labelChildNonStatic:0}),n["\u0275qud"](335544320,4,{_labelChildStatic:0}),n["\u0275qud"](603979776,5,{_placeholderChild:0}),n["\u0275qud"](603979776,6,{_errorChildren:1}),n["\u0275qud"](603979776,7,{_hintChildren:1}),n["\u0275qud"](603979776,8,{_prefixChildren:1}),n["\u0275qud"](603979776,9,{_suffixChildren:1}),(t()(),n["\u0275and"](16777216,null,1,1,null,Ft)),n["\u0275did"](12,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(t,l){t(l,12,0,l.component.filters)}),(function(t,l){t(l,0,1,["standard"==n["\u0275nov"](l,1).appearance,"fill"==n["\u0275nov"](l,1).appearance,"outline"==n["\u0275nov"](l,1).appearance,"legacy"==n["\u0275nov"](l,1).appearance,n["\u0275nov"](l,1)._control.errorState,n["\u0275nov"](l,1)._canLabelFloat,n["\u0275nov"](l,1)._shouldLabelFloat(),n["\u0275nov"](l,1)._hasFloatingLabel(),n["\u0275nov"](l,1)._hideControlPlaceholder(),n["\u0275nov"](l,1)._control.disabled,n["\u0275nov"](l,1)._control.autofilled,n["\u0275nov"](l,1)._control.focused,"accent"==n["\u0275nov"](l,1).color,"warn"==n["\u0275nov"](l,1).color,n["\u0275nov"](l,1)._shouldForward("untouched"),n["\u0275nov"](l,1)._shouldForward("touched"),n["\u0275nov"](l,1)._shouldForward("pristine"),n["\u0275nov"](l,1)._shouldForward("dirty"),n["\u0275nov"](l,1)._shouldForward("valid"),n["\u0275nov"](l,1)._shouldForward("invalid"),n["\u0275nov"](l,1)._shouldForward("pending"),!n["\u0275nov"](l,1)._animationsEnabled])}))}function Rt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,23,"div",[["class","bottom-bar-body"]],[[2,"wide",null]],null,null,null,null)),(t()(),n["\u0275eld"](1,0,null,null,22,"div",[["class","store-details"]],null,null,null,null,null)),(t()(),n["\u0275eld"](2,0,null,null,9,"div",[["class","store-details-header"]],null,null,null,null,null)),(t()(),n["\u0275eld"](3,0,null,null,7,"div",[["class","store-details-header-left"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Dt)),n["\u0275did"](5,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275eld"](6,0,null,null,4,"mat-slide-toggle",[["class","mat-slide-toggle"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checked",null],[2,"mat-disabled",null],[2,"mat-slide-toggle-label-before",null],[2,"_mat-animation-noopable",null]],[[null,"change"],[null,"focus"]],(function(t,l,e){var a=!0,o=t.component;return"focus"===l&&(a=!1!==n["\u0275nov"](t,8)._inputElement.nativeElement.focus()&&a),"change"===l&&(a=!1!==o.onByStackedBarsChange(e.checked)&&a),a}),lt.b,lt.a)),n["\u0275prd"](5120,null,H.q,(function(t){return[t]}),[et.b]),n["\u0275did"](8,1228800,null,0,et.b,[n.ElementRef,q.h,n.ChangeDetectorRef,[8,null],n.NgZone,et.a,[2,tt.a],[2,Z.b]],{checked:[0,"checked"]},{change:"change"}),(t()(),n["\u0275ted"](9,0,[" "," "])),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](11,0,null,null,0,"div",[["class","store-details-header-right"]],null,null,null,null,null)),(t()(),n["\u0275eld"](12,0,null,null,11,"div",[["class","store-details-body"]],null,null,null,null,null)),(t()(),n["\u0275eld"](13,0,null,null,4,"app-bar-chart",[],null,[[null,"chartClick"]],(function(t,l,e){var n=!0;return"chartClick"===l&&(n=!1!==t.component.onChartClick(e)&&n),n}),nt.b,nt.a)),n["\u0275prd"](512,null,F.A,F.B,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["\u0275did"](15,278528,null,0,F.k,[F.A],{ngClass:[0,"ngClass"]},null),n["\u0275did"](16,638976,null,0,at.a,[n.ElementRef,P.a],{config:[0,"config"]},{chartClick:"chartClick"}),n["\u0275pid"](131072,F.b,[n.ChangeDetectorRef]),(t()(),n["\u0275eld"](18,0,null,null,2,"span",[["class","chart-label front-gross"]],null,null,null,null,null)),(t()(),n["\u0275ted"](19,null,["",""])),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](21,0,null,null,2,"span",[["class","chart-label back-gross"]],null,null,null,null,null)),(t()(),n["\u0275ted"](22,null,["",""])),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef])],(function(t,l){var e=l.component;t(l,5,0,e.filters),t(l,8,0,e.isByStackedBars),t(l,15,0,e.chartClass),t(l,16,0,n["\u0275unv"](l,16,0,n["\u0275nov"](l,17).transform(e.data$)))}),(function(t,l){var e=l.component;t(l,0,0,e.isAccClient),t(l,6,0,n["\u0275nov"](l,8).id,n["\u0275nov"](l,8).disabled?null:-1,n["\u0275nov"](l,8).checked,n["\u0275nov"](l,8).disabled,"before"==n["\u0275nov"](l,8).labelPosition,"NoopAnimations"===n["\u0275nov"](l,8)._animationMode),t(l,9,0,n["\u0275unv"](l,9,0,n["\u0275nov"](l,10).transform(e.i18n+"bottom-bar.stacked-bars.label"))),t(l,19,0,n["\u0275unv"](l,19,0,n["\u0275nov"](l,20).transform(e.i18n+"bottom-bar.chart.frontend-gross.label"))),t(l,22,0,n["\u0275unv"](l,22,0,n["\u0275nov"](l,23).transform(e.i18n+"bottom-bar.chart.backend-gross.label")))}))}function At(t){return n["\u0275vid"](0,[n["\u0275pid"](0,_.a,[P.a,O.b]),(t()(),n["\u0275eld"](1,0,null,null,10,"div",[["class","bottom-bar-header"]],[[2,"narrow",null]],null,null,null,null)),(t()(),n["\u0275eld"](2,0,null,null,2,"div",[["class","bottom-bar-header-left"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,vt)),n["\u0275did"](4,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275eld"](5,0,null,null,6,"div",[["class","bottom-bar-header-right"]],[[2,"account-client",null]],null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Ot)),n["\u0275did"](7,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275and"](16777216,null,null,1,null,wt)),n["\u0275did"](9,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275and"](16777216,null,null,1,null,kt)),n["\u0275did"](11,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275and"](16777216,null,null,1,null,Rt)),n["\u0275did"](13,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(t,l){var e=l.component;t(l,4,0,!e.isEmptyChartPanel),t(l,7,0,e.isAccClient),t(l,9,0,!e.isAccClient),t(l,11,0,e.hasEditTotalButton),t(l,13,0,!e.isEmptyChartPanel)}),(function(t,l){var e=l.component;t(l,1,0,e.isAccClient),t(l,5,0,e.isAccClient)}))}var St=e("zp2H"),It=e("v67E"),Et=e("2v1Z"),Bt=e("BFEL"),Gt=e("zp1y"),$t=e("wd/R"),jt=e("BTBr"),Nt=e("VHTt"),Vt=e("/gN3"),zt=e("NAMS");class Lt{constructor(t,l,e,n,o,i,r){this.document=t,this.translate=l,this.dialog=e,this.tracking=n,this.filterData=o,this.dataApi=i,this.dataService=r,this.i18n=a,this.allowPagination=!1,this.isAccClient=!1,this.showAccTotals=!1,this.isCommentsView=!1,this.commentType=zt.a.Operations,this.PARTS_REPORT=6,this.SP_REPORT=5,this.SRO_REPORT=7,this.subs=[]}set sub(t){this.subs.push(t)}ngOnInit(){this.dataService.init(),this.filterData.setCurrentPage(it.b.ByStore),this.filterData.showFilters(["store","dateRange","report","view","opsfilter"]),this.loading$=this.dataService.loading$,this.initGridOptions(),this.initStreams(),this.initSubscriptions()}ngOnDestroy(){this.dataService.destroy(),this.subs.forEach(t=>t.unsubscribe())}onTrackTableChanges(){this.trackAction(jt.a.Load,this.table.grid)}onFilterChanged(t){const l=t.api.getModel();this.setTotals(l&&l.rowsToDisplay)}exportDataAs(t){const l=(new Date).toDateString(),e=this.filterData.getFiltersListItems();this.sub=this.translate.get(a+"byPage.export.file-name").subscribe(n=>{const a=n+" "+l;switch(t){case Nt.a.XLS:this.table.exportDataAsXls(a,e),this.trackAction(jt.a.ExportXls,this.table.grid);break;case Nt.a.PDF:this.table.exportDataAsPdf(a,e,()=>this.trackAction(jt.a.ExportPdf,this.table.grid),{max:11,invisible:["comment_count"]})}})}exportDetailsDataAs(t){this.sub=this.translate.get(a+"drill.modal.export.file-name").subscribe(l=>{const e=l+" "+this.selectedControl;switch(t){case Nt.a.XLS:this.detailsGrid.exportDataAsXls(e);break;case Nt.a.PDF:this.detailsGrid.exportDataAsPdf(e)}})}exportBalanceDataAs(t){this.sub=this.translate.get(a+"balance.modal.export.file-name").subscribe(l=>{switch(t){case Nt.a.XLS:this.balanceGrid.exportDataAsXls(l);break;case Nt.a.PDF:this.balanceGrid.exportDataAsPdf(l)}})}openEditTotalFieldsModal(){this.editTotalFieldsModal.showModal()}closeEditTotalFieldsModal(){this.editTotalFieldsModal.closeModal()}saveTotalFields(t){this.dataApi.saveTotalFields({report:this.report.value,fields:t}).subscribe(()=>{this.sub=this.translate.get(a+"total-fields.message.success").subscribe(t=>this.dialog.success(t)),t.forEach(t=>{this.totals.forEach(l=>{l.field===t.field&&(l.visible=t.visible)}),this.columns.forEach(l=>{l.field===t.field&&l.data&&(l.data.isTotal=t.visible)})}),this.closeEditTotalFieldsModal()})}onTotalItemClick(t){switch(t.key){case"balance":this.showBalanceModal()}}onCloseComments(){this.commentNode=null,this.isCommentsView=!1,this.table.agGrid.api.refreshCells(),this.hostClass="host-old"}onCommentsChange(t){this.commentNode.setDataValue("comment_last",t.last),this.commentNode.setDataValue("comment_count",t.total)}trackAction(t,l){const e=this.filterData.getFiltersListItems();this.tracking.log({page:jt.b.Operations,section:jt.c.ByStore,event:t,params:e,grid:l})}initStreams(){}initSubscriptions(){this.sub=this.dataService.data$.pipe(Object(Gt.a)(this.filterData.selectedReport$)).subscribe(([t,l])=>{this.columns=[],t.labels.forEach((t,e)=>{this.columns.push(new Vt.a({field:t.c,name:t.b,labelFormat:this.mapColLabelFormat(t.c),filter:this.mapColFilter(t.c),cellRenderer:this.mapColCellRenderer(t.c),align:this.mapColAlign(t.c),data:{isTotal:+t.totalfield},pinned:this.isAccClient&&this.filterData.isAccReport(l)&&e<=5?"left":null}))}),this.data=t.data,this.balanceAmt=+t.balanceAmt,this.allowPagination=this.data.length>1e3,setTimeout(()=>{this.setTotals()}),this.trackAction(jt.a.Load)}),this.sub=this.filterData.selectedReport$.pipe(Object(ot.a)(this.filterData.reports$),Object(mt.a)(([t,l])=>l.find(l=>l.value===t))).subscribe(t=>this.report=t),this.sub=this.filterData.selectedStore$.pipe(Object(ot.a)(this.filterData.stores$),Object(mt.a)(([t,l])=>l.find(l=>l.value===t))).subscribe(t=>this.store=t),this.sub=this.filterData.isAcc$.pipe(Object(ot.a)(this.filterData.selectedReport$)).subscribe(([t,l])=>{this.isAccClient=t,this.reportId=l,this.showAccTotals=t&&this.filterData.isAccTotalsReport(l)}),this.hostClass="host-old"}setTotals(t){this.showAccTotals?this.setAccTotals(t):this.setCommonTotals(t)}setCommonTotals(t){this.totals=[],this.accTotals=[];let l=[];if(l=t?t.map(t=>t.data):this.data,this.columns.filter(t=>t.hasMoneyFormat&&!!l.find(l=>!!l[t.field]||0===l[t.field])).forEach(t=>{const e=l.reduce((l,e)=>+e[t.field]+l,0);this.totals.push({field:t.field,label:t.name,value:e,format:"amt",visible:t.data&&t.data.isTotal})}),this.reportId===this.PARTS_REPORT){let t=0;l.filter(t=>!!t.PartsCount&&0!=+t.PartsCount).forEach(l=>{t+=1}),this.translate.get(a+"table.total.count").subscribe(l=>{this.totals.push({field:"count",label:l,value:t,format:"cnt",visible:!0})})}else this.reportId===this.SP_REPORT?this.translate.get(a+"table.total.count").subscribe(t=>{this.totals.push({field:"PartDesc",label:t,value:this.table.getCount(),format:"cnt",visible:!0})}):this.reportId===this.SRO_REPORT.toString()?this.translate.get(a+"table.total.count").subscribe(t=>{let l=this.table.getCount();void 0===this.data&&null===this.data||(l=[...new Set(this.data.map(t=>t.RO))].length),this.totals.push({field:"count",label:t,value:l,format:"cnt",visible:!0})}):this.translate.get(a+"table.total.count").subscribe(t=>{this.totals.push({field:"count",label:t,value:this.table.getCount(),format:"cnt",visible:!0})})}setAccTotals(t){this.totals=[],this.accTotals=[];let l=[];l=t?t.map(t=>t.data):this.data,this.translate.get(["acc-total.acc-front-gross","acc-total.acc-back-gross","acc-total.acc-total-gross","acc-total.fi-front-gross","acc-total.fi-back-gross","acc-total.fi-total-gross","acc-total.amount","acc-total.deal-count","acc-total.total-avg","acc-total.avg-days","acc-total.memo-balance-amount","acc-total.acc-avg-front","acc-total.acc-avg-back","acc-total.acc-avg-total","acc-total.fi-avg-front","acc-total.fi-avg-back","acc-total.fi-avg-total"].map(t=>a+t)).pipe(Object(Gt.a)(this.filterData.selectedAccView$)).subscribe(([t,e])=>{let n=0;const o={acc:{front:0,back:0,total:0},fi:{front:0,back:0,total:0},deal:l.reduce((t,l)=>(l.dealCnt?+l.dealCnt:0)+t,0)},i=0===o.deal?1:o.deal;if(-1!==[it.d.FiOnlyNotDelivered,it.d.FiOnlyAccVariance].indexOf(e)){for(const t of l)o.acc.front+=t.accFrontGross?+t.accFrontGross:0,o.acc.back+=t.accBackGross?+t.accBackGross:0,o.fi.front+=t.FrontGross?+t.FrontGross:0,o.fi.back+=t.BackGross?+t.BackGross:0;o.acc.total=o.acc.front+o.acc.back,o.fi.total=o.fi.front+o.fi.back}else if(l.filter(t=>t.accFI&&-1!==t.accFI.indexOf("ACC")).forEach(t=>{o.acc.front+=t.accFrontGross?+t.accFrontGross:0,o.acc.back+=t.accBackGross?+t.accBackGross:0,o.acc.total+=t.accTotalGross?+t.accTotalGross:0}),-1!==[it.d.Summary,it.d.FiOnly].indexOf(e)){const t=$t().add(-1,"days");l.filter(t=>t.accFI&&-1!==t.accFI.indexOf("FI")).forEach(l=>{o.fi.front+=l.FrontGross?+l.FrontGross:0,o.fi.back+=l.BackGross?+l.BackGross:0,o.fi.total+=l.amt?+l.amt:0,n+=t.diff($t(l.acctDate),"days")})}switch(e){case it.d.Summary:this.accTotals.push([{label:t[a+"acc-total.acc-front-gross"],value:o.acc.front},{label:t[a+"acc-total.acc-back-gross"],value:o.acc.back},{label:t[a+"acc-total.acc-total-gross"],value:o.acc.total}]),this.accTotals.push([{label:t[a+"acc-total.fi-front-gross"],value:o.fi.front},{label:t[a+"acc-total.fi-back-gross"],value:o.fi.back},{label:t[a+"acc-total.fi-total-gross"],value:o.fi.total}]),this.accTotals.push([{label:t[a+"acc-total.amount"],value:o.acc.total+o.fi.total},{label:t[a+"acc-total.deal-count"],value:o.deal},{label:t[a+"acc-total.total-avg"],value:(o.acc.total+o.fi.total)/i}]),this.accTotals.push([{label:"",value:""},{label:"",value:""},{label:t[a+"acc-total.memo-balance-amount"],value:this.balanceAmt,clickable:!0,key:"balance"}]);break;case it.d.Accounting:this.accTotals.push([{label:t[a+"acc-total.acc-front-gross"],value:o.acc.front},{label:t[a+"acc-total.acc-back-gross"],value:o.acc.back},{label:t[a+"acc-total.acc-total-gross"],value:o.acc.total}]),this.accTotals.push([{label:t[a+"acc-total.acc-avg-front"],value:o.acc.front/i},{label:t[a+"acc-total.acc-avg-back"],value:o.acc.back/i},{label:t[a+"acc-total.acc-avg-total"],value:o.acc.total/i}]),this.accTotals.push([{label:"",value:""},{label:t[a+"acc-total.deal-count"],value:o.deal},{label:"",value:""}]);break;case it.d.FiOnly:this.accTotals.push([{label:t[a+"acc-total.fi-front-gross"],value:o.fi.front},{label:t[a+"acc-total.fi-back-gross"],value:o.fi.back},{label:t[a+"acc-total.fi-total-gross"],value:o.fi.total}]),this.accTotals.push([{label:t[a+"acc-total.fi-avg-front"],value:o.fi.front/i},{label:t[a+"acc-total.fi-avg-back"],value:o.fi.back/i},{label:t[a+"acc-total.fi-avg-total"],value:o.fi.total/i}]),this.accTotals.push([{label:"",value:""},{label:t[a+"acc-total.deal-count"],value:o.deal},{label:"",value:""}]);break;default:this.accTotals.push([{label:t[a+"acc-total.acc-front-gross"],value:o.acc.front},{label:t[a+"acc-total.acc-back-gross"],value:o.acc.back},{label:t[a+"acc-total.acc-total-gross"],value:o.acc.total}]),this.accTotals.push([{label:t[a+"acc-total.fi-front-gross"],value:o.fi.front},{label:t[a+"acc-total.fi-back-gross"],value:o.fi.back},{label:t[a+"acc-total.fi-total-gross"],value:o.fi.total}]),this.accTotals.push([{label:"",value:""},{label:t[a+"acc-total.deal-count"],value:o.deal},{label:t[a+"acc-total.total-avg"],value:(o.acc.total+(e===it.d.FiOnlyAccVariance?0:o.fi.total))/i}])}e===it.d.FiOnly&&this.accTotals.push([{label:"",value:""},{label:"",value:""},{label:t[a+"acc-total.avg-days"],value:n/i}])})}mapColLabelFormat(t){return{entry:Vt.d.Date,Age:Vt.d.Integer,FrontGross:Vt.d.Money,BackGross:Vt.d.Money,accFrontGross:Vt.d.Money,accBackGross:Vt.d.Money,accTotalGross:Vt.d.Money,TotalGross:Vt.d.Money,amt:Vt.d.Money,Cost:Vt.d.Money,TotalSale:Vt.d.Money,TotalCost:Vt.d.Money,TotalPartsSale:Vt.d.Money,TotalGP:Vt.d.Money,BackGrossVar:Vt.d.Money,frontGrossVar:Vt.d.Money,FrontGrossVar:Vt.d.Money,Laborgross:Vt.d.Money,Partsgross:Vt.d.Money,PartsCount:Vt.d.Integer,ROTotal_C:Vt.d.Money,ROTotal_I:Vt.d.Money,ROTotal_W:Vt.d.Money,ROTotal:Vt.d.Money}[t]||Vt.d.Default}mapColFilter(t){return{entry:Vt.c.DateRange,strYear:Vt.c.NumberRange,DealType:Vt.c.MultiChoice,Make:Vt.c.MultiChoice,Model:Vt.c.MultiChoice,Age:Vt.c.NumberRange,status:Vt.c.MultiChoice,SalesmenName:Vt.c.MultiChoice,FIManagerName:Vt.c.MultiChoice,FrontGross:Vt.c.NumberRange,BackGross:Vt.c.NumberRange,accFrontGross:Vt.c.NumberRange,accBackGross:Vt.c.NumberRange,accTotalGross:Vt.c.NumberRange,amt:Vt.c.NumberRange,Cost:Vt.c.NumberRange,TotalSale:Vt.c.NumberRange,TotalCost:Vt.c.NumberRange,BackGrossVar:Vt.c.NumberRange,frontGrossVar:Vt.c.NumberRange,FrontGrossVar:Vt.c.NumberRange}[t]||Vt.c.String}mapColCellRenderer(t){const l=(t,l)=>{const e=this.document.createElement("span");return e.innerText=t.valueFormatted,e.className="link",e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.selectedControl=t.data[l],this.isByStock="stock"===l,this.showDetailsModal()}),e};return{deal:t=>l(t,"deal"),stock:t=>l(t,"stock"),comment_count:t=>{const l=this.document.createElement("span");return l.innerText=t.valueFormatted,l.className="ag-comments-trigger",l.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),this.commentNode=t.node,this.commentSubType=t.data.comment_key,this.commentTitles=t.columnApi.getAllDisplayedColumns().filter(t=>-1===t.getColId().indexOf("comment_")).map(l=>({label:l.getColDef().headerName,value:l.getColDef().valueFormatter(t)})),this.isCommentsView=!0,this.hostClass="host-new"}),l}}[t]}mapColAlign(t){return{comment_count:Vt.b.Right,accFI:Vt.b.Right}[t]||Vt.b.Left}showDetailsModal(){this.detailsData=null,this.detailsTotals=[],this.detailsLoading=!0,this.detailsModal.showModal();const t=["drill.modal.grid.column.gl-acc","drill.modal.grid.column.gl-desc","drill.modal.grid.column.gl-type","drill.modal.grid.column.gl-date","drill.modal.grid.column.posting-desc","drill.modal.grid.column.post-amount","drill.modal.grid.column.jrn-id","drill.modal.grid.column.ref-idc","drill.modal.grid.column.gross-spec","drill.modal.footer.total.count"].map(t=>a+t);this.sub=this.translate.get(t).pipe(Object(Gt.a)(this.filterData.value$)).subscribe(([l,{report:e,store:n}])=>{const o={d:Vt.d.Date,PostAmount:Vt.d.Money2},i={d:Vt.c.DateRange,PostAmount:Vt.c.NumberRange};this.detailsColumns=["GLAcct","GLDesc","AccType","d","a","PostAmount","JournalID","b","GLGross"].map((e,n)=>new Vt.a({field:e,name:l[t[n]],labelFormat:o[e]||Vt.d.Default,filter:i[e]||Vt.c.String,align:Vt.b.Right})),this.detailsTotalsFields=this.detailsColumns.filter(t=>t.hasNumericFormat).map(t=>t.field),this.dataApi.getDetailsByControl({report:e,store:n,control:this.selectedControl,byStock:this.isByStock}).subscribe(({data:t})=>{this.detailsData=t,this.detailsLoading=!1;const e=t.reduce((t,l)=>t+ +l.PostAmount,0);this.detailsTotals=[{label:l[a+"drill.modal.grid.column.post-amount"],value:e,format:"amt2"},{label:l[a+"drill.modal.footer.total.count"],value:t.length,format:"cnt"}]})})}showBalanceModal(){this.balanceData=null,this.balanceTotals=[],this.balanceLoading=!0,this.balanceModal.showModal();const t=["balance.modal.grid.column.gl-acc","balance.modal.grid.column.gl-desc","balance.modal.grid.column.gl-type","balance.modal.grid.column.gl-date","balance.modal.grid.column.posting-desc","balance.modal.grid.column.post-amount","balance.modal.grid.column.jrn-id","balance.modal.grid.column.ref-id","balance.modal.grid.column.fi-stock-type","balance.modal.grid.column.fi-deal-type","balance.modal.grid.column.fi-status","balance.modal.footer.total.count"].map(t=>a+t);this.sub=this.translate.get(t).pipe(Object(Gt.a)(this.filterData.value$)).subscribe(([l,e])=>{const n={d:Vt.d.Date,PostAmount:Vt.d.Money},o={d:Vt.c.DateRange,PostAmount:Vt.c.NumberRange};this.balanceColumns=["GLAcct","GLDesc","AccType","d","a","PostAmount","JournalID","b","StockType","DealType","Status"].map((e,a)=>new Vt.a({field:e,name:l[t[a]],labelFormat:n[e]||Vt.d.Default,filter:o[e]||Vt.c.String,align:Vt.b.Right})),this.balanceTotalsFields=this.balanceColumns.filter(t=>t.hasNumericFormat).map(t=>t.field),this.dataApi.getDetailsBalance(e).subscribe(({data:t})=>{this.balanceData=t,this.balanceLoading=!1;const e=t.reduce((t,l)=>t+ +l.PostAmount,0);this.balanceTotals=[{label:l[a+"balance.modal.grid.column.post-amount"],value:e,format:"amt"},{label:l[a+"balance.modal.footer.total.count"],value:t.length,format:"cnt"}]})})}initGridOptions(){this.gridOptions={}}}var qt=e("xxE9"),Zt=n["\u0275crt"]({encapsulation:0,styles:[[".grid-wrapper[_ngcontent-%COMP%]{width:100%;flex:1 1 100%;height:100%;max-width:100%;background-color:#fff;box-shadow:2px 2px 5px 1px #c1bebe}.top-controls-block[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:space-between}.top-controls-block-left[_ngcontent-%COMP%]{width:calc(100% - 160px);flex:1 1 calc(100% - 160px);padding:20px 20px 10px;display:flex;align-items:center}.top-controls-block-right[_ngcontent-%COMP%]{width:160px;flex:1 0 160px;padding:20px 20px 10px;display:flex;align-items:center;justify-content:flex-end}.top-controls-block-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#404040;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.filters-block[_ngcontent-%COMP%]{height:70px;padding:10px 20px 20px}.grid-block[_ngcontent-%COMP%]{display:flex}.grid-block-content[_ngcontent-%COMP%]{width:calc(100% - 40px);flex:1 0 calc(100% - 40px);position:relative}.grid-block-content[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0)}.grid-block-sidebar[_ngcontent-%COMP%]{width:40px;flex:0 0 40px;border-left:1px solid #ddd}.grid-block-more-info-trigger[_ngcontent-%COMP%]{display:block;height:60px;cursor:pointer;position:relative}.grid-block-more-info-trigger[_ngcontent-%COMP%]:before{content:'\\E5D4';font-family:\"Material Icons\";font-size:24px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.grid-block-more-info-trigger.opened[_ngcontent-%COMP%]:before{content:'\\E5D3'}.top-control-btn[_ngcontent-%COMP%]{color:#5b5b5b;cursor:pointer;margin-left:20px;margin-top:-2px;display:inline-block}.top-control-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.mat-checked[_ngcontent-%COMP%]   .top-control-label[_ngcontent-%COMP%]{color:#2196f3}.tabs-block[_ngcontent-%COMP%]{height:60px;padding:10px 20px 16px}.tab[_ngcontent-%COMP%]{display:inline-block;height:34px;line-height:34px;border-radius:17px;padding-left:15px;padding-right:15px;color:#404040;font-size:14px;font-weight:500;background-color:#e5e5e5;cursor:pointer}.tab.active[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]:hover{color:#3498db;background-color:#e2eff8}.tab[_ngcontent-%COMP%]:not(:last-child){margin-right:15px}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 0 10px;height:45px}.modal-header-right[_ngcontent-%COMP%]   .top-control-btn[_ngcontent-%COMP%]:last-child{margin-right:-4px}.modal-header.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-top:-19px;margin-left:-19px;margin-right:-19px;padding:10px 20px}.modal-header.with-padding[_ngcontent-%COMP%]{padding:10px 20px}.modal-body[_ngcontent-%COMP%]{height:calc(100% - 45px);position:relative}.modal-body.with-footer[_ngcontent-%COMP%]{height:calc(100% - 45px - 50px)}.modal-body.full-height[_ngcontent-%COMP%]{height:100%}.modal-body.with-min-size[_ngcontent-%COMP%]{min-width:850px;min-height:300px;margin-left:-19px;margin-right:-19px}.modal-body.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-left:-19px;margin-right:-19px;margin-bottom:-19px}.modal-body[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.modal-footer[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;justify-content:flex-end;background:#eee;margin:0 -19px -19px;padding:0 19px}.modal-footer-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#404040;padding-right:15px}.modal-footer-text.last[_ngcontent-%COMP%]{padding-left:15px;padding-right:0}.modal-footer-text.last[_ngcontent-%COMP%]:before{content:'|';position:relative;left:-13px}.modal-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.fi-list[_ngcontent-%COMP%]{display:flex;margin:25px 0;padding:15px 0;border-bottom:1px solid #ddd}.fi-list.single[_ngcontent-%COMP%]{padding:5px 0;margin:0;border-bottom:0}.fi-list-item[_ngcontent-%COMP%]{width:33%;flex:0 0 33%;padding:0 5px}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(1){padding-left:0}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(3){padding-right:0}.penetration-list.horizontal[_ngcontent-%COMP%]{display:flex;align-items:center}.penetration-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin:25px 0;padding:15px 0 30px;border-bottom:1px solid #ddd}.horizontal[_ngcontent-%COMP%]   .penetration-item[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:10px 15px 10px 0;margin:0;border-bottom:none}.penetration-title[_ngcontent-%COMP%]{width:30%;flex:0 0 30%;font-size:14px;color:#404040;padding-right:5px;overflow:hidden;text-overflow:ellipsis}.penetration-graph[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:0 5px}.penetration-rank[_ngcontent-%COMP%]{width:20%;flex:0 0 20%;padding:0 5px;text-align:center}.chargeback[_ngcontent-%COMP%]{text-align:center;margin:50px 0 30px}.chargeback[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{margin:0 0 5px;font-size:20px;font-weight:600}.chargeback-value[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#404040}.control-btn-settings[_ngcontent-%COMP%]{display:inline-block;width:24px;height:24px;position:relative;cursor:pointer}.control-btn-settings[_ngcontent-%COMP%]:before{content:'\\e8b8';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#5b5b5b;font-size:24px;font-family:\"Material Icons\"}.drill-info[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;list-style:none;padding:0;margin:0}.drill-info-item[_ngcontent-%COMP%]{color:#404040;font-size:14px;margin-right:25px}.drill-info-label[_ngcontent-%COMP%]{font-weight:400}.drill-info-value[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]{display:flex;height:100%;background-color:#fff}.host-new[_nghost-%COMP%]{flex:0 0 calc(100% - 450px)!important;width:calc(100% - 450px)!important}.host-old[_nghost-%COMP%]{flex:0 0 100%!important;width:100%!important}[_nghost-%COMP%]     app-bar-chart{width:100%;overflow-x:auto}[_nghost-%COMP%]     app-bar-chart.by-salesperson .chart{width:2500px}[_nghost-%COMP%]     app-bar-chart.by-customer .chart{width:9000px}[_nghost-%COMP%]     .ag-theme-material .link{text-decoration:underline}[_nghost-%COMP%]     .ag-theme-material span.ag-group-contracted{flex:0 0 20px;margin-right:4px}[_nghost-%COMP%]     .ag-theme-material .green, [_nghost-%COMP%]     .ag-theme-material .green-light, [_nghost-%COMP%]     .ag-theme-material .orange, [_nghost-%COMP%]     .ag-theme-material .red{position:relative;padding-right:15px}[_nghost-%COMP%]     .ag-theme-material .green-light:before, [_nghost-%COMP%]     .ag-theme-material .green:before, [_nghost-%COMP%]     .ag-theme-material .orange:before, [_nghost-%COMP%]     .ag-theme-material .red:before{content:'';display:block;width:12px;height:12px;border-radius:50%;position:absolute;top:50%;right:0;transform:translateY(-50%)}[_nghost-%COMP%]     .ag-theme-material .green:before{background-color:#1d8700}[_nghost-%COMP%]     .ag-theme-material .green-light:before{background-color:#8aa309}[_nghost-%COMP%]     .ag-theme-material .orange:before{background-color:#e9910b}[_nghost-%COMP%]     .ag-theme-material .red:before{background-color:#d74901}.grid-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 60px);position:relative}.grid-block[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0);flex:1 1 auto;overflow:hidden}.top-controls-block-right[_ngcontent-%COMP%]{align-items:flex-start}"]],data:{}});function Wt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,1,"app-comments",[],[[8,"className",0]],[[null,"commentsClose"],[null,"commentsChange"]],(function(t,l,e){var n=!0,a=t.component;return"commentsClose"===l&&(n=!1!==a.onCloseComments()&&n),"commentsChange"===l&&(n=!1!==a.onCommentsChange(e)&&n),n}),x.b,x.a)),n["\u0275did"](1,4964352,null,0,v.a,[C.a,y.a,M.a,n.ChangeDetectorRef,O.b],{type:[0,"type"],subType:[1,"subType"],titles:[2,"titles"]},{commentsClose:"commentsClose",commentsChange:"commentsChange"})],(function(t,l){var e=l.component;t(l,1,0,e.commentType,e.commentSubType,e.commentTitles)}),(function(t,l){t(l,0,0,n["\u0275nov"](l,1).hostClass)}))}function Xt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"span",[["class","modal-footer-text"]],[[2,"last",null]],null,null,null,null)),(t()(),n["\u0275ted"](1,null,[" ",": "," "])),n["\u0275ppd"](2,2)],null,(function(t,l){t(l,0,0,l.context.last);var e=l.context.$implicit.label,a=n["\u0275unv"](l,1,1,t(l,2,0,n["\u0275nov"](l.parent,0),l.context.$implicit.value,l.context.$implicit.format));t(l,1,0,e,a)}))}function Jt(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,2,"span",[["class","modal-footer-text"]],[[2,"last",null]],null,null,null,null)),(t()(),n["\u0275ted"](1,null,[" ",": "," "])),n["\u0275ppd"](2,2)],null,(function(t,l){t(l,0,0,l.context.last);var e=l.context.$implicit.label,a=n["\u0275unv"](l,1,1,t(l,2,0,n["\u0275nov"](l.parent,0),l.context.$implicit.value,l.context.$implicit.format));t(l,1,0,e,a)}))}function Kt(t){return n["\u0275vid"](0,[n["\u0275pid"](0,_.a,[P.a,O.b]),n["\u0275qud"](402653184,1,{table:0}),n["\u0275qud"](402653184,2,{editTotalFieldsModal:0}),n["\u0275qud"](402653184,3,{detailsModal:0}),n["\u0275qud"](402653184,4,{detailsGrid:0}),n["\u0275qud"](402653184,5,{balanceModal:0}),n["\u0275qud"](402653184,6,{balanceGrid:0}),(t()(),n["\u0275eld"](7,0,null,null,15,"div",[["class","grid-wrapper"]],null,null,null,null,null)),(t()(),n["\u0275eld"](8,0,null,null,7,"div",[["class","top-controls-block"]],null,null,null,null,null)),(t()(),n["\u0275eld"](9,0,null,null,2,"div",[["class","top-controls-block-left"]],null,null,null,null,null)),(t()(),n["\u0275eld"](10,0,null,null,1,"h3",[["class","top-controls-block-heading"]],null,null,null,null,null)),(t()(),n["\u0275ted"](11,null,["",""])),(t()(),n["\u0275eld"](12,0,null,null,3,"div",[["class","top-controls-block-right"]],null,null,null,null,null)),(t()(),n["\u0275eld"](13,0,null,null,2,"app-export-buttons",[],[[2,"small",null]],[[null,"dataExport"]],(function(t,l,e){var n=!0;return"dataExport"===l&&(n=!1!==t.component.exportDataAs(e)&&n),n}),w.b,w.a)),n["\u0275did"](14,114688,null,0,k.a,[T.a],{disabled:[0,"disabled"]},{dataExport:"dataExport"}),n["\u0275pid"](131072,F.b,[n.ChangeDetectorRef]),(t()(),n["\u0275eld"](16,0,null,null,6,"div",[["class","grid-block"]],null,null,null,null,null)),(t()(),n["\u0275eld"](17,0,null,null,3,"app-default-grid",[],null,[[null,"onTrackChanges"],[null,"filterChanged"]],(function(t,l,e){var n=!0,a=t.component;return"onTrackChanges"===l&&(n=!1!==a.onTrackTableChanges()&&n),"filterChanged"===l&&(n=!1!==a.onFilterChanged(e)&&n),n}),D.b,D.a)),n["\u0275prd"](512,null,R.a,R.a,[A.a,S.a,I.a,E.j]),n["\u0275did"](19,4964352,[[1,4],["table",4]],0,B.a,[P.a,R.a,G.a,$.a,j.a,O.b,T.a],{data:[0,"data"],columns:[1,"columns"],customGridOptions:[2,"customGridOptions"],loading:[3,"loading"],pagination:[4,"pagination"]},{onTrackChanges:"onTrackChanges",filterChanged:"filterChanged"}),n["\u0275pid"](131072,F.b,[n.ChangeDetectorRef]),(t()(),n["\u0275eld"](21,0,null,null,1,"app-bottom-bar",[],[[2,"opened",null],[2,"empty-chart-panel",null]],[[null,"editTotalFields"],[null,"totalItemClick"]],(function(t,l,e){var n=!0,a=t.component;return"editTotalFields"===l&&(n=!1!==a.openEditTotalFieldsModal()&&n),"totalItemClick"===l&&(n=!1!==a.onTotalItemClick(e)&&n),n}),At,xt)),n["\u0275did"](22,245760,null,0,rt,[E.j,st.a,ft],{totals:[0,"totals"],accTotals:[1,"accTotals"],isAccClient:[2,"isAccClient"]},{totalItemClick:"totalItemClick",editTotalFields:"editTotalFields"}),(t()(),n["\u0275and"](16777216,null,null,1,null,Wt)),n["\u0275did"](24,16384,null,0,F.m,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),n["\u0275eld"](25,0,null,null,18,"app-modal",[["class","modal-generic"]],null,null,null,St.b,St.a)),n["\u0275prd"](512,null,It.a,It.a,[O.b]),n["\u0275did"](27,1228800,[[3,4],["detailsModal",4]],0,Et.a,[It.a,F.d,n.ElementRef,n.Renderer2,O.b],{modalTitle:[0,"modalTitle"]},null),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](29,0,null,0,7,"div",[["class","modal-header"]],null,null,null,null,null)),(t()(),n["\u0275eld"](30,0,null,null,3,"div",[["class","modal-header-left"]],null,null,null,null,null)),(t()(),n["\u0275eld"](31,0,null,null,2,"h2",[["class","modal-heading"]],null,null,null,null,null)),(t()(),n["\u0275ted"](32,null,[" ",": "," "])),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](34,0,null,null,2,"div",[["class","modal-header-right"]],null,null,null,null,null)),(t()(),n["\u0275eld"](35,0,null,null,1,"app-export-buttons",[],[[2,"small",null]],[[null,"dataExport"]],(function(t,l,e){var n=!0;return"dataExport"===l&&(n=!1!==t.component.exportDetailsDataAs(e)&&n),n}),w.b,w.a)),n["\u0275did"](36,114688,null,0,k.a,[T.a],null,{dataExport:"dataExport"}),(t()(),n["\u0275eld"](37,0,null,0,3,"div",[["class","modal-body with-footer with-min-size"]],null,null,null,null,null)),(t()(),n["\u0275eld"](38,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,null,null,D.b,D.a)),n["\u0275prd"](512,null,R.a,R.a,[A.a,S.a,I.a,E.j]),n["\u0275did"](40,4964352,[[4,4],["detailsGrid",4]],0,B.a,[P.a,R.a,G.a,$.a,j.a,O.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},null),(t()(),n["\u0275eld"](41,0,null,0,2,"div",[["class","modal-footer"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Xt)),n["\u0275did"](43,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),n["\u0275eld"](44,0,null,null,15,"app-modal",[["class","modal-generic"]],null,null,null,St.b,St.a)),n["\u0275prd"](512,null,It.a,It.a,[O.b]),n["\u0275did"](46,1228800,[[5,4],["balanceModal",4]],0,Et.a,[It.a,F.d,n.ElementRef,n.Renderer2,O.b],{modalTitle:[0,"modalTitle"]},null),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](48,0,null,0,4,"div",[["class","modal-header"]],null,null,null,null,null)),(t()(),n["\u0275eld"](49,0,null,null,0,"div",[["class","modal-header-left"]],null,null,null,null,null)),(t()(),n["\u0275eld"](50,0,null,null,2,"div",[["class","modal-header-right"]],null,null,null,null,null)),(t()(),n["\u0275eld"](51,0,null,null,1,"app-export-buttons",[],[[2,"small",null]],[[null,"dataExport"]],(function(t,l,e){var n=!0;return"dataExport"===l&&(n=!1!==t.component.exportBalanceDataAs(e)&&n),n}),w.b,w.a)),n["\u0275did"](52,114688,null,0,k.a,[T.a],null,{dataExport:"dataExport"}),(t()(),n["\u0275eld"](53,0,null,0,3,"div",[["class","modal-body with-footer with-min-size"]],null,null,null,null,null)),(t()(),n["\u0275eld"](54,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,null,null,D.b,D.a)),n["\u0275prd"](512,null,R.a,R.a,[A.a,S.a,I.a,E.j]),n["\u0275did"](56,4964352,[[6,4],["balanceGrid",4]],0,B.a,[P.a,R.a,G.a,$.a,j.a,O.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},null),(t()(),n["\u0275eld"](57,0,null,0,2,"div",[["class","modal-footer"]],null,null,null,null,null)),(t()(),n["\u0275and"](16777216,null,null,1,null,Jt)),n["\u0275did"](59,278528,null,0,F.l,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(t()(),n["\u0275eld"](60,0,null,null,5,"app-modal",[["class","modal-budget-form"]],null,null,null,St.b,St.a)),n["\u0275prd"](512,null,It.a,It.a,[O.b]),n["\u0275did"](62,1228800,[[2,4],["editTotalFieldsModal",4]],0,Et.a,[It.a,F.d,n.ElementRef,n.Renderer2,O.b],{modalTitle:[0,"modalTitle"]},null),n["\u0275pid"](131072,E.i,[E.j,n.ChangeDetectorRef]),(t()(),n["\u0275eld"](64,0,null,0,1,"app-edit-total-fields",[],null,[[null,"save"],[null,"cancel"]],(function(t,l,e){var n=!0,a=t.component;return"save"===l&&(n=!1!==a.saveTotalFields(e)&&n),"cancel"===l&&(n=!1!==a.closeEditTotalFieldsModal()&&n),n}),f.c,f.b)),n["\u0275did"](65,638976,null,0,Bt.a,[],{report:[0,"report"],data:[1,"data"]},{save:"save",cancel:"cancel"})],(function(t,l){var e=l.component;t(l,14,0,n["\u0275unv"](l,14,0,n["\u0275nov"](l,15).transform(e.loading$))),t(l,19,0,e.data,e.columns,e.gridOptions,n["\u0275unv"](l,19,3,n["\u0275nov"](l,20).transform(e.loading$)),e.allowPagination),t(l,22,0,e.totals,e.accTotals,e.showAccTotals),t(l,24,0,e.isCommentsView),t(l,27,0,n["\u0275unv"](l,27,0,n["\u0275nov"](l,28).transform(e.i18n+"drill.modal.title"))),t(l,36,0),t(l,40,0,e.detailsData,e.detailsColumns,e.detailsTotalsFields,e.gridOptions,e.detailsLoading),t(l,43,0,e.detailsTotals),t(l,46,0,n["\u0275unv"](l,46,0,n["\u0275nov"](l,47).transform(e.i18n+"balance.modal.title"))),t(l,52,0),t(l,56,0,e.balanceData,e.balanceColumns,e.balanceTotalsFields,e.gridOptions,e.balanceLoading),t(l,59,0,e.balanceTotals),t(l,62,0,n["\u0275unv"](l,62,0,n["\u0275nov"](l,63).transform(e.i18n+"edit-total-fields.modal.title"))),t(l,65,0,null==e.report?null:e.report.label,e.totals)}),(function(t,l){var e=l.component;t(l,11,0,null==e.store?null:e.store.label),t(l,13,0,n["\u0275nov"](l,14).small),t(l,21,0,n["\u0275nov"](l,22).isOpened,n["\u0275nov"](l,22).isEmptyChartPanel),t(l,32,0,n["\u0275unv"](l,32,0,n["\u0275nov"](l,33).transform(e.i18n+(e.isByStock?"drill.modal.stock-number.label":"drill.modal.deal.label"))),e.selectedControl),t(l,35,0,n["\u0275nov"](l,36).small),t(l,51,0,n["\u0275nov"](l,52).small)}))}function Ut(t){return n["\u0275vid"](0,[(t()(),n["\u0275eld"](0,0,null,null,1,"ng-component",[],[[8,"className",0]],null,null,Kt,Zt)),n["\u0275did"](1,245760,null,0,Lt,[F.d,E.j,S.a,I.a,st.a,qt.a,ft],null,null)],(function(t,l){t(l,1,0)}),(function(t,l){t(l,0,0,n["\u0275nov"](l,1).hostClass)}))}var Ht=n["\u0275ccf"]("ng-component",Lt,Ut,{},{},[]),Yt=e("POq0"),Qt=e("s6ns"),tl=e("821u"),ll=e("IheW"),el=e("5cj1"),nl=e("gavF"),al=e("4asF"),ol=e("Mc5n"),il=e("iInd"),rl=e("zMNK"),sl=e("Fwaw"),cl=e("l0Bn"),dl=e("kPC6"),ul=e("SXLW"),pl=e("tdaM"),ml=e("0sx3"),gl=e("81ID"),hl=e("oiVm"),bl=e("xSwO"),fl=e("t5D1"),xl=e("iTUp"),vl=e("FFHx"),Cl=e("PyFA"),yl=e("aBBA"),Ml=e("Cr+6"),Ol=e("CSbZ"),_l=e("/Lwf"),Pl=e("yotz"),wl=e("T3zS");e.d(l,"ByStoreModuleNgFactory",(function(){return kl}));var kl=n["\u0275cmf"](o,[],(function(t){return n["\u0275mod"]([n["\u0275mpd"](512,n.ComponentFactoryResolver,n["\u0275CodegenComponentFactoryResolver"],[[8,[i.a,r.a,s.a,c.b,c.a,d.a,u.a,p.a,m.a,g.a,h.a,b.b,f.a,Ht]],[3,n.ComponentFactoryResolver],n.NgModuleRef]),n["\u0275mpd"](4608,F.o,F.n,[n.LOCALE_ID,[2,F.F]]),n["\u0275mpd"](4608,H.F,H.F,[]),n["\u0275mpd"](4608,Yt.c,Yt.c,[]),n["\u0275mpd"](4608,V.c,V.c,[V.i,V.e,n.ComponentFactoryResolver,V.h,V.f,n.Injector,n.NgZone,F.d,Z.b,[2,F.i]]),n["\u0275mpd"](5120,V.j,V.k,[V.c]),n["\u0275mpd"](5120,U.a,U.b,[V.c]),n["\u0275mpd"](4608,W.e,J.c,[[2,J.g],[2,J.l]]),n["\u0275mpd"](5120,N.b,N.c,[V.c]),n["\u0275mpd"](5120,Qt.c,Qt.d,[V.c]),n["\u0275mpd"](135680,Qt.e,Qt.e,[V.c,n.Injector,[2,F.i],[2,Qt.b],Qt.c,[3,Qt.e],V.e]),n["\u0275mpd"](4608,tl.i,tl.i,[]),n["\u0275mpd"](5120,tl.a,tl.b,[V.c]),n["\u0275mpd"](4608,J.a,J.v,[[2,J.f],L.a]),n["\u0275mpd"](4608,ll.k,ll.q,[F.d,n.PLATFORM_ID,ll.o]),n["\u0275mpd"](4608,ll.r,ll.r,[ll.k,ll.p]),n["\u0275mpd"](5120,ll.a,(function(t){return[t]}),[ll.r]),n["\u0275mpd"](4608,ll.n,ll.n,[]),n["\u0275mpd"](6144,ll.l,null,[ll.n]),n["\u0275mpd"](4608,ll.j,ll.j,[ll.l]),n["\u0275mpd"](6144,ll.b,null,[ll.j]),n["\u0275mpd"](4608,ll.f,ll.m,[ll.b,n.Injector]),n["\u0275mpd"](4608,ll.c,ll.c,[ll.f]),n["\u0275mpd"](4608,G.a,G.a,[O.b]),n["\u0275mpd"](4608,H.f,H.f,[]),n["\u0275mpd"](4608,el.c,el.c,[ll.c,W.b]),n["\u0275mpd"](5120,nl.c,nl.j,[V.c]),n["\u0275mpd"](4608,al.a,al.a,[Qt.e]),n["\u0275mpd"](4608,el.d,el.d,[]),n["\u0275mpd"](4608,ol.f,ol.f,[F.d,n.NgZone,z.i,ol.h]),n["\u0275mpd"](4608,ft,ft,[st.a,qt.a,E.j,P.a]),n["\u0275mpd"](1073742336,F.c,F.c,[]),n["\u0275mpd"](1073742336,H.E,H.E,[]),n["\u0275mpd"](1073742336,H.m,H.m,[]),n["\u0275mpd"](1073742336,il.s,il.s,[[2,il.x],[2,il.o]]),n["\u0275mpd"](1073742336,E.g,E.g,[]),n["\u0275mpd"](1073742336,Yt.d,Yt.d,[]),n["\u0275mpd"](1073742336,Y.e,Y.e,[]),n["\u0275mpd"](1073742336,Z.a,Z.a,[]),n["\u0275mpd"](1073742336,rl.g,rl.g,[]),n["\u0275mpd"](1073742336,L.b,L.b,[]),n["\u0275mpd"](1073742336,z.f,z.f,[]),n["\u0275mpd"](1073742336,V.g,V.g,[]),n["\u0275mpd"](1073742336,J.l,J.l,[[2,J.d],[2,W.f]]),n["\u0275mpd"](1073742336,J.u,J.u,[]),n["\u0275mpd"](1073742336,J.s,J.s,[]),n["\u0275mpd"](1073742336,J.q,J.q,[]),n["\u0275mpd"](1073742336,U.d,U.d,[]),n["\u0275mpd"](1073742336,et.d,et.d,[]),n["\u0275mpd"](1073742336,et.c,et.c,[]),n["\u0275mpd"](1073742336,q.a,q.a,[]),n["\u0275mpd"](1073742336,N.e,N.e,[]),n["\u0275mpd"](1073742336,sl.c,sl.c,[]),n["\u0275mpd"](1073742336,Qt.k,Qt.k,[]),n["\u0275mpd"](1073742336,tl.j,tl.j,[]),n["\u0275mpd"](1073742336,J.w,J.w,[]),n["\u0275mpd"](1073742336,J.n,J.n,[]),n["\u0275mpd"](1073742336,ll.e,ll.e,[]),n["\u0275mpd"](1073742336,ll.d,ll.d,[]),n["\u0275mpd"](1073742336,cl.a,cl.a,[]),n["\u0275mpd"](1073742336,dl.a,dl.a,[]),n["\u0275mpd"](1073742336,ul.AgGridModule,ul.AgGridModule,[]),n["\u0275mpd"](1073742336,pl.a,pl.a,[]),n["\u0275mpd"](1073742336,ml.a,ml.a,[]),n["\u0275mpd"](1073742336,H.A,H.A,[]),n["\u0275mpd"](1073742336,el.b,el.b,[]),n["\u0275mpd"](1073742336,nl.i,nl.i,[]),n["\u0275mpd"](1073742336,nl.f,nl.f,[]),n["\u0275mpd"](1073742336,gl.a,gl.a,[]),n["\u0275mpd"](1073742336,hl.a,hl.a,[]),n["\u0275mpd"](1073742336,bl.a,bl.a,[]),n["\u0275mpd"](1073742336,fl.a,fl.a,[]),n["\u0275mpd"](1073742336,xl.a,xl.a,[]),n["\u0275mpd"](1073742336,vl.a,vl.a,[]),n["\u0275mpd"](1073742336,Cl.a,Cl.a,[[3,Cl.a],yl.a]),n["\u0275mpd"](1073742336,Ml.a,Ml.a,[]),n["\u0275mpd"](1073742336,Ol.a,Ol.a,[yl.a]),n["\u0275mpd"](1073742336,ol.g,ol.g,[]),n["\u0275mpd"](1073742336,_l.a,_l.a,[]),n["\u0275mpd"](1073742336,Pl.b,Pl.b,[]),n["\u0275mpd"](1073742336,wl.a,wl.a,[]),n["\u0275mpd"](1073742336,o,o,[yl.a]),n["\u0275mpd"](256,J.e,J.i,[]),n["\u0275mpd"](256,ll.o,"XSRF-TOKEN",[]),n["\u0275mpd"](256,ll.p,"X-XSRF-TOKEN",[]),n["\u0275mpd"](1024,il.m,(function(){return[[{path:"",component:Lt}]]}),[])])}))},"OTv+":function(t,l,e){"use strict";e.d(l,"a",(function(){return n})),e("/kTj");class n{constructor(t,l){this.formatter=t,this.debug=l.factory(new.target.name)}transform(t,l,e){if(null===t)return 0;switch(Array.isArray(t)&&"from-array"!==l&&(t="%"===t[1]&&"from-array-abbr"!==l?t[0]/100:t[0]),"from-array-abbr"===l&&(l="abbr"),l){case"money":case"amt":return this.formatter.money(t);case"amt2":return this.formatter.money(t,{fractional:2,noZeroMantissa:!1,currencySign:"$"});case"per":return this.formatter.percentage(t);case"per1":return this.formatter.percentage(t,1,!1);case"per2":return this.formatter.percentage(t,2,!1);case"per-3f":return this.formatter.percentage(t,3);case"per-round":return this.formatter.percentage(t,0);case"number":case"cnt":return this.formatter.number(t,{fractional:0});case"cnt0":this.formatter.number(t,{fractional:0,thousandDelimiter:""});case"abbr":return this.formatter.abbrNum(t,e);case"abbr-money":return this.formatter.abbrMoney(t,e);case"from-array":return this.formatter.fromArray(t,e);default:return this.debug.warn("Unknown format: %s. Value: %s",l,t),this.formatter.number(t,{fractional:0})}}}}}]);