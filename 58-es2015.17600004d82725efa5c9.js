(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{"OTv+":function(e,t,l){"use strict";l.d(t,"a",(function(){return n})),l("/kTj");class n{constructor(e,t){this.formatter=e,this.debug=t.factory(new.target.name)}transform(e,t,l){if(null===e)return 0;switch(Array.isArray(e)&&"from-array"!==t&&(e="%"===e[1]&&"from-array-abbr"!==t?e[0]/100:e[0]),"from-array-abbr"===t&&(t="abbr"),t){case"money":case"amt":return this.formatter.money(e);case"amt2":return this.formatter.money(e,{fractional:2,noZeroMantissa:!1,currencySign:"$"});case"per":return this.formatter.percentage(e);case"per1":return this.formatter.percentage(e,1,!1);case"per2":return this.formatter.percentage(e,2,!1);case"per-3f":return this.formatter.percentage(e,3);case"per-round":return this.formatter.percentage(e,0);case"number":case"cnt":return this.formatter.number(e,{fractional:0});case"cnt0":this.formatter.number(e,{fractional:0,thousandDelimiter:""});case"abbr":return this.formatter.abbrNum(e,l);case"abbr-money":return this.formatter.abbrMoney(e,l);case"from-array":return this.formatter.fromArray(e,l);default:return this.debug.warn("Unknown format: %s. Value: %s",t,e),this.formatter.number(e,{fractional:0})}}}},Tn9L:function(e,t,l){"use strict";l.d(t,"a",(function(){return n}));class n{transform(e,t){if(e){if(t){let t="";return(e=e.replace("&","|&")).split("&").forEach(e=>{t=t+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()+" "}),e=t,t="",e.split(" ").forEach(e=>{t=t+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()+" "}),t.trim().replace("| ","&")}return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}return e}}},hTFM:function(e,t,l){"use strict";l.r(t);var n=l("8Y7J");const a="cabinet.kpi.by-store.";class i{constructor(e){e.addLoaderWithPrefixedTranslations("/cabinet/kpi/by-store",a)}}var o=l("pMnS"),s=l("t68o"),r=l("zbXB"),d=l("GsI2"),u=l("eliu"),c=l("0Xvm"),p=l("VOAG"),h=l("aYrz"),m=l("tfhy"),g=l("NcP4"),b=l("HOtD"),f=l("qFRm"),x=l("TSSN"),v=l("FpoO"),C=l("JNvI"),O=l("pGru"),w=l("YbeN"),M=l("RiRU"),y=l("/kTj"),k=l("SVse"),D=l("lbNG"),_=l("S+vS"),T=l("+2T5"),P=l("kDjO"),S=l("OTv+"),$=l("eeq/");class F{constructor(){this.showValue=!0,this.onEditValue=new n.EventEmitter,this.theme="default"}get simpleClass(){return!this.showValue}get themeDefault(){return"default"===this.theme}get themeSmall(){return"small"===this.theme}get valueClass(){const e=this.data&&this.data.valueStatus;return{green:e>0,yellow:0===e,red:e<0,minimum:(this.data&&this.data.percentage)<5}}get width(){let e=Math.abs(this.data.percentage);return e>100&&(e=100),e+"%"}ngOnInit(){}updateValue(e){this.onEditValue.emit(e)}}var j=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;position:relative;height:24px;border-radius:4px;background-color:#e0e0e0;overflow:hidden}.progress[_ngcontent-%COMP%]{height:24px;position:absolute;top:0;left:0}.progress.green[_ngcontent-%COMP%]{background-color:#1e8700;color:#fff}.progress.yellow[_ngcontent-%COMP%]{background-color:#f3c118;color:#404040}.progress.red[_ngcontent-%COMP%]{background-color:#c00;color:#fff}.progress-value[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:inherit;padding:0 10px;line-height:24px}"]],data:{}});function R(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,4,null,null,null,null,null,null,null)),(e()(),n["\u0275eld"](1,16777216,null,null,3,"span",[["class","progress-value"]],[[8,"title",0],[2,"field-highlighted",null],[2,"field-editable",null]],[[null,"onUpdate"],[null,"click"]],(function(e,t,l){var a=!0,i=e.component;return"click"===t&&(a=!1!==n["\u0275nov"](e,2).openEditor()&&a),"onUpdate"===t&&(a=!1!==i.updateValue(l)&&a),a}),null,null)),n["\u0275did"](2,737280,null,0,D.a,[n.ElementRef,n.ViewContainerRef,n.ComponentFactoryResolver,_.a,T.a,x.j,P.a,y.b],{params:[0,"params"]},{onUpdate:"onUpdate"}),(e()(),n["\u0275ted"](3,null,[" "," "])),n["\u0275ppd"](4,2),(e()(),n["\u0275and"](0,null,null,0))],(function(e,t){e(t,2,0,t.component.data.valueEdit)}),(function(e,t){var l=t.component;e(t,1,0,n["\u0275nov"](t,2).title,n["\u0275nov"](t,2).highlighted,n["\u0275nov"](t,2).editable);var a=n["\u0275unv"](t,3,0,e(t,4,0,n["\u0275nov"](t.parent.parent,0),l.data.value,l.data.format));e(t,3,0,a)}))}function I(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,null,null,null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"span",[["class","progress-value"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,[" "," "])),n["\u0275ppd"](3,2)],null,(function(e,t){var l=t.component,a=l.showValue?n["\u0275unv"](t,2,0,e(t,3,0,n["\u0275nov"](t.parent.parent,0),l.data.value,l.data.format)):"";e(t,2,0,a)}))}function A(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,6,"span",[["class","progress"]],[[4,"width",null]],null,null,null,null)),n["\u0275prd"](512,null,k.B,k.C,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["\u0275did"](2,278528,null,0,k.l,[k.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),n["\u0275and"](16777216,null,null,1,null,R)),n["\u0275did"](4,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275and"](16777216,null,null,1,null,I)),n["\u0275did"](6,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){var l=t.component;e(t,2,0,"progress",l.valueClass),e(t,4,0,l.showValue&&l.data.valueEdit),e(t,6,0,!l.data.valueEdit)}),(function(e,t){e(t,0,0,t.component.width)}))}function E(e){return n["\u0275vid"](2,[n["\u0275pid"](0,S.a,[$.a,y.b]),(e()(),n["\u0275and"](16777216,null,null,1,null,A)),n["\u0275did"](2,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,2,0,t.component.data)}),null)}class L{constructor(e){this.filterData=e,this.i18n=a,this.isOpened=!0}ngOnInit(){this.categories$=this.filterData.measureCategories$,this.measures$=this.filterData.measures$,this.selectedKpi$=this.filterData.selectedKpi$}onToggle(){this.isOpened=!this.isOpened}onItemClick(e){this.filterData.updateFilter({name:"kpiIndex",value:e.kpiIndex})}}var N=l("dBrL"),V=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;background-color:#fff;width:40px;flex:0 0 40px;margin:-20px 20px -20px -20px;overflow:hidden;transition:width .5s ease,flex .5s ease;position:relative;box-shadow:2px 2px 5px 1px #c1bebe}.opened[_nghost-%COMP%]{width:430px;flex:0 0 430px}.opened[_nghost-%COMP%]   .sidebar-inner[_ngcontent-%COMP%]{width:430px;transform:translateX(0)}.opened[_nghost-%COMP%]   .sidebar-toggle[_ngcontent-%COMP%]{right:12px}.opened[_nghost-%COMP%]   .sidebar-toggle[_ngcontent-%COMP%]:before{content:'\\e314'}.sidebar-inner[_ngcontent-%COMP%]{height:100%;width:430px;transform:translateX(-100%);transition:transform .5s ease}.sidebar-header[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;padding:5px 20px}.sidebar-body[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow:auto}.sidebar-toggle[_ngcontent-%COMP%]{width:24px;height:24px;display:block;cursor:pointer;position:absolute;top:12px;right:8px;transition:right .5s ease;z-index:1}.sidebar-toggle[_ngcontent-%COMP%]:before{content:'\\e315';font-family:\"Material Icons\";font-size:24px;color:#747474;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.sidebar-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.info-block[_ngcontent-%COMP%]{background-color:#fff;border-bottom:1px solid #ddd;padding:10px 20px;min-height:60px;cursor:pointer;position:relative}.info-block[_ngcontent-%COMP%]:before{content:'';width:3px;height:calc(100% + 2px);position:absolute;top:-1px;left:0;background-color:transparent}.info-block.selected[_ngcontent-%COMP%], .info-block[_ngcontent-%COMP%]:hover{background-color:#f3f8fc}.info-block.selected[_ngcontent-%COMP%]:before, .info-block[_ngcontent-%COMP%]:hover:before{background-color:#106cb5}.info-block.selected[_ngcontent-%COMP%]   .info-block-heading[_ngcontent-%COMP%], .info-block[_ngcontent-%COMP%]:hover   .info-block-heading[_ngcontent-%COMP%]{color:#3498db}.info-block-heading[_ngcontent-%COMP%]{font-size:13px;font-weight:400;line-height:1.4;color:#404040;margin:0 0 6px}.info-block-category[_ngcontent-%COMP%]{font-size:18px;color:#404040;font-weight:500;padding:15px 20px}"]],data:{}});function G(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"div",[["class","info-block"]],[[2,"selected",null]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==(!e.parent.context.$implicit.selected&&e.component.onItemClick(e.parent.context.$implicit))&&n),n}),null,null)),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](2,0,null,null,1,"h4",[["class","info-block-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](3,null,["",""])),(e()(),n["\u0275eld"](4,0,null,null,1,"app-progress-bar",[],[[2,"without-value",null],[2,"theme-default",null],[2,"theme-small",null]],null,null,E,j)),n["\u0275did"](5,114688,null,0,F,[],{data:[0,"data"]},null)],(function(e,t){e(t,5,0,t.parent.context.$implicit.progressBar)}),(function(e,t){var l=t.component;e(t,0,0,t.parent.context.$implicit.kpiIndex===n["\u0275unv"](t,0,0,n["\u0275nov"](t,1).transform(l.selectedKpi$))),e(t,3,0,t.parent.context.$implicit.name),e(t,4,0,n["\u0275nov"](t,5).simpleClass,n["\u0275nov"](t,5).themeDefault,n["\u0275nov"](t,5).themeSmall)}))}function z(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,2,null,null,null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,G)),n["\u0275did"](2,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275and"](0,null,null,0))],(function(e,t){e(t,2,0,t.context.$implicit.section_id-0==t.parent.context.$implicit.id-0)}),null)}function B(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,1,"div",[["class","info-block-category"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",""])),(e()(),n["\u0275and"](16777216,null,null,2,null,z)),n["\u0275did"](4,278528,null,0,k.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,4,0,n["\u0275unv"](t,4,0,n["\u0275nov"](t,5).transform(l.measures$)))}),(function(e,t){e(t,2,0,t.context.$implicit.name)}))}function K(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,0,"button",[["class","sidebar-toggle"]],null,[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onToggle()&&n),n}),null,null)),(e()(),n["\u0275eld"](1,0,null,null,5,"div",[["class","sidebar-inner"]],null,null,null,null,null)),(e()(),n["\u0275eld"](2,0,null,null,0,"div",[["class","sidebar-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](3,0,null,null,3,"div",[["class","sidebar-body"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,2,null,B)),n["\u0275did"](5,278528,null,0,k.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,5,0,n["\u0275unv"](t,5,0,n["\u0275nov"](t,6).transform(l.categories$)))}),null)}var U=l("zXMq"),X=l("2Vgt"),q=l("S5eV"),J=l("zeHk"),Y=l("+bil"),Z=l("ChPW"),H=l("IqdZ"),W=l("TUN4"),Q=l("K5C0"),ee=l("mvzq"),te=l("Tn9L");class le{constructor(){this.arrTotalsLabels=[],this.values={}}ngOnInit(){}ngOnChanges(){}ngOnDestroy(){}}var ne=n["\u0275crt"]({encapsulation:0,styles:[[".totalgrid[_ngcontent-%COMP%]{text-align:-webkit-right;padding-top:10px}.totalgridTable[_ngcontent-%COMP%]{white-space:nowrap}.totalCellText[_ngcontent-%COMP%]{text-align:right;padding-right:10px}"]],data:{}});function ae(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"td",[["class","totalCellText"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"strong",[],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",":"])),n["\u0275ppd"](3,2),(e()(),n["\u0275ted"](4,null,[" "," "])),n["\u0275ppd"](5,2)],null,(function(e,t){var l=t.component,a=n["\u0275unv"](t,2,0,e(t,3,0,n["\u0275nov"](t.parent.parent,0),t.context.$implicit.label,!0));e(t,2,0,a);var i=n["\u0275unv"](t,4,0,e(t,5,0,n["\u0275nov"](t.parent.parent,1),l.values[t.context.$implicit.key],"1.0-0"));e(t,4,0,i)}))}function ie(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"table",[["border","0"],["width","100%"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"tr",[],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,ae)),n["\u0275did"](3,278528,null,0,k.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,3,0,t.component.arrTotalsLabels)}),null)}function oe(e){return n["\u0275vid"](2,[n["\u0275pid"](0,te.a,[]),n["\u0275pid"](0,k.f,[n.LOCALE_ID]),(e()(),n["\u0275eld"](2,0,null,null,8,"div",[["class","totalgrid"]],null,null,null,null,null)),(e()(),n["\u0275eld"](3,0,null,null,7,"table",[["border","0"],["class","totalgridTable"]],null,null,null,null,null)),(e()(),n["\u0275eld"](4,0,null,null,6,"tr",[],null,null,null,null,null)),(e()(),n["\u0275eld"](5,0,null,null,5,"td",[],null,null,null,null,null)),n["\u0275prd"](512,null,k.D,k.E,[n.ElementRef,n.KeyValueDiffers,n.Renderer2]),n["\u0275did"](7,278528,null,0,k.q,[k.D],{ngStyle:[0,"ngStyle"]},null),n["\u0275pod"](8,{width:0}),(e()(),n["\u0275and"](16777216,null,null,1,null,ie)),n["\u0275did"](10,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(e,t){var l=t.component,n=e(t,8,0,"100%");e(t,7,0,n),e(t,10,0,null==l.arrTotalsLabels?null:l.arrTotalsLabels.length)}),null)}var se=l("mS0u"),re=l("MmlZ");class de{constructor(e){this.dataService=e,this.i18n=a,this.isOpened=!0,this.subs=[]}set sub(e){this.subs.push(e)}ngOnInit(){this.data$=this.dataService.bottomBarData$,this.initSubscriptions()}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}onToggle(){this.isOpened=!this.isOpened}initSubscriptions(){this.sub=this.dataService.selectedStore$.subscribe(e=>this.selectedStore=e)}}var ue=l("2Vo4"),ce=l("pLZG"),pe=l("zp1y"),he=l("lJxs"),me=l("vkgz"),ge=l("fFD9"),be=l("Kj3r"),fe=l("w1tV"),xe=l("SxV6"),ve=l("W+wd"),Ce=function(e){return e.Grid="grid",e.Details="details",e.Trend="trend",e}({});class Oe{constructor(e,t,l,n,a,i){this.translate=e,this.dataApi=t,this.filterData=l,this.instanceAppSettingsApi=n,this.coreCache=a,this.formatter=i,this._tabData$=new ue.a(void 0),this._loading$=new ue.a(void 0),this._selectedTab$=new ue.a(Ce.Grid),this._selectedStore$=new ue.a(void 0),this._selectedStoreData$=new ue.a(void 0),this.subs=[],this.initInternal()}set sub(e){this.subs.push(e)}destroy(){this.subs.forEach(e=>e.unsubscribe()),this.subs=[],this._selectedTab$.next(Ce.Grid),this.resetStoreData()}init(){this.initSubscriptions()}selectStore(e){const t=this._selectedStore$.getValue();t&&t.id===e.id?this.resetStoreData():this._selectedStore$.next(e)}setTab(e){this._selectedTab$.next(e)}resetStoreData(){this._selectedStore$.getValue()&&(this._selectedStore$.next(void 0),this._selectedStoreData$.next(void 0))}initInternal(){this.loading$=this._loading$.asObservable(),this.selectedTab$=this._selectedTab$.pipe(Object(ce.a)(e=>!!e)),this.tabData$=this._tabData$.pipe(Object(ce.a)(e=>!!e)),this.selectedStore$=this._selectedStore$.asObservable(),this.bottomBarData$=this.filterData.selectedMeasure$.pipe(Object(pe.a)(this.filterData.currentPage$),Object(ce.a)(([,e])=>e===ve.d.ByStore),Object(he.a)(([e])=>e),Object(me.a)(()=>this.resetStoreData()),Object(ge.a)(this._selectedStoreData$),Object(be.a)(200),Object(he.a)(([e,t])=>{const l={data:[],labels:[],colors:[],tooltip:{titles:[],labels:[]}},n={"-1":"red",0:"yellow",1:"green"},a=t?t.data:e.stores||[];for(const i of a){let e;switch(l.data.push(+i.value[0]),l.labels.push(t?i.xaxis:i.abbrev),l.colors.push(n[String(i.color)]||"yellow"),l.tooltip.titles.push(t?i.hover_pre:i.storeName),i.value[1]){case"$":e=this.formatter.abbrMoney(i.value[0],{K:1,M:1});break;case"%":e=this.formatter.percentage(String(i.value[0]/100));break;default:e=this.formatter.number(i.value[0],{fractional:0})}l.tooltip.labels.push(e)}return l}),Object(fe.a)())}initSubscriptions(){this.sub=this.filterData.change$.pipe(Object(me.a)(()=>this._loading$.next(!0)),Object(pe.a)(this.instanceAppSettingsApi.settings$,this.coreCache.storesById$.pipe(Object(xe.a)()),this.selectedTab$)).subscribe(([e,t,l,n])=>{this.dataApi.getByStore(e).subscribe(e=>{for(const n of e){const e=n.variance&&n.variance.value?+n.variance.value[0]:0;n.progressBar={value:e,valueStatus:n.variance?n.variance.color:0,percentage:100*e,format:"per"},n.isProjected=!!+n.is_proj,n.stores.forEach(e=>{const a=l.get(+e.id),i=e.data,o=+n.is_proj||+n.is_prorated?i.value_actual[0]:i.value[0];e.rank=+e.current_pos,e.pRank=+e.previous_pos,e.storeName=a?a[t.storeNameType]:e.name,e.abbrev=a?a.abbreviation:e.name,e.value=i.value,e.amount="%"===i.value[1]?o/100:o,e.pAmount="%"===i.value[1]?i.value[0]/100:i.value[0],e.budget="%"===i.budget[1]?i.budget[0]/100:i.budget[0],e.delta=i.delta.value[0],e.deltaRank=i.delta.color})}this.filterData.setMeasures(e),this.resetStoreData(),n===Ce.Grid&&this._loading$.next(!1)})}),this.sub=this.selectedStore$.pipe(Object(ce.a)(e=>!!e),Object(he.a)(e=>e.id),Object(pe.a)(this.filterData.value$),Object(he.a)(([e,{dateIndex:t,kpiIndex:l,period:n}])=>({store:e,dateIndex:t,kpiIndex:l,period:n}))).subscribe(e=>{this.dataApi.getStoreTrendData(e).subscribe(e=>{const t=e&&e[0];this._selectedStoreData$.next({id:t.storeName,data:t.trends})})}),this.sub=this.selectedTab$.pipe(Object(ge.a)(this.filterData.selectedMeasure$),Object(be.a)(100),Object(ce.a)(([e])=>e===Ce.Grid)).subscribe(([e,t])=>{this._tabData$.next(t.stores)}),this.sub=this.selectedTab$.pipe(Object(ge.a)(this.filterData.selectedKpi$,this.filterData.selectedGroup$,this.filterData.selectedDate$,this.filterData.selectedPeriod$,this.filterData.selectedAccView$),Object(be.a)(100),Object(ce.a)(([e])=>-1!==[Ce.Details,Ce.Trend].indexOf(e)),Object(pe.a)(this.filterData.selectedMeasure$),Object(me.a)(()=>this._loading$.next(!0)),Object(me.a)(()=>this.resetStoreData())).subscribe(([[e,t,l,n,a,i],o])=>{const s={kpiIndex:t,kpiSubType:o.kpiSubType,section_id:o.section_id,numDays:o.numDays,group:l,dateIndex:n,period:a,view:i};switch(e){case Ce.Details:this.dataApi.getByStoreDetails(s).subscribe(e=>{this._tabData$.next(e),this._loading$.next(!1)});break;case Ce.Trend:this.dataApi.getStoreTrendData(s).subscribe(e=>{this._tabData$.next(e),this._loading$.next(!1)})}})}}var we=n["\u0275crt"]({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;flex:0 0 40px;transition:flex .5s ease}.opened[_nghost-%COMP%]{flex:0 0 275px}.bottom-bar-header[_ngcontent-%COMP%]{height:40px;padding:5px 20px;display:flex;align-items:center;border-top:1px solid #ddd}  .opened .bottom-bar-header{border-top:none;border-bottom:1px solid #ddd}.bottom-bar-body[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .5s ease}  .opened .bottom-bar-body{height:calc(100% - 40px)}.bottom-bar-trigger[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:#747474;cursor:pointer;position:relative;padding-left:24px;text-transform:uppercase}.bottom-bar-trigger[_ngcontent-%COMP%]:before{content:'\\e316';font-family:\"Material Icons\";font-size:24px;color:inherit;cursor:inherit;display:inline-block;position:absolute;left:0;top:50%;transform:translateY(-54%)}  .opened .bottom-bar-trigger:before{content:'\\e313'}.store-details[_ngcontent-%COMP%]{height:100%}.store-details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;padding:10px 20px 5px;height:50px}.store-details-body[_ngcontent-%COMP%]{height:calc(100% - 50px);padding:0 20px 10px;overflow:auto}.store-details-heading[_ngcontent-%COMP%]{margin:10px 0 0;font-size:16px;font-weight:500;color:#404040}app-bar-chart[_ngcontent-%COMP%]{min-height:166px;max-height:175px;transform:translateY(10px)}"]],data:{}});function Me(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"div",[["class","bottom-bar-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"button",[["class","bottom-bar-trigger"]],null,[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onToggle()&&n),n}),null,null)),(e()(),n["\u0275ted"](2,null,["",""])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),(e()(),n["\u0275eld"](4,0,null,null,11,"div",[["class","bottom-bar-body"]],null,null,null,null,null)),(e()(),n["\u0275eld"](5,0,null,null,10,"div",[["class","store-details"]],null,null,null,null,null)),(e()(),n["\u0275eld"](6,0,null,null,5,"div",[["class","store-details-header"]],null,null,null,null,null)),(e()(),n["\u0275eld"](7,0,null,null,4,"div",[["class","store-details-header-left"]],null,null,null,null,null)),(e()(),n["\u0275eld"](8,0,null,null,3,"h3",[["class","store-details-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](9,null,[" ",": "," "])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef]),(e()(),n["\u0275eld"](12,0,null,null,3,"div",[["class","store-details-body"]],null,null,null,null,null)),(e()(),n["\u0275eld"](13,0,null,null,2,"app-bar-chart",[],null,null,null,se.b,se.a)),n["\u0275did"](14,638976,null,0,re.a,[n.ElementRef,$.a],{config:[0,"config"]},null),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef])],(function(e,t){var l=t.component;e(t,14,0,n["\u0275unv"](t,14,0,n["\u0275nov"](t,15).transform(l.data$)))}),(function(e,t){var l=t.component;e(t,2,0,n["\u0275unv"](t,2,0,n["\u0275nov"](t,3).transform(l.i18n+(l.isOpened?"bottom-bar.expand.label":"bottom-bar.collapse.label")))),e(t,9,0,n["\u0275unv"](t,9,0,n["\u0275nov"](t,10).transform(l.i18n+"bottom-bar.header.store.label")),l.selectedStore?l.selectedStore.storeName:n["\u0275unv"](t,9,1,n["\u0275nov"](t,11).transform(l.i18n+"bottom-bar.header.store.all.label")))}))}var ye=l("zp2H"),ke=l("v67E"),De=l("2v1Z"),_e=l("BTBr"),Te=l("NAMS"),Pe=l("/gN3"),Se=l("VHTt");class $e{constructor(e,t,l,n,i,o,s,r){this.document=e,this.translate=t,this.instanceAppSettingsApi=l,this.coreCache=n,this.tracking=i,this.filterData=o,this.dataApi=s,this.dataService=r,this.i18n=a,this.allowPagination=!1,this.isCommentsView=!1,this.selectedSection=0,this.amtFields={},this.subs=[]}set sub(e){this.subs.push(e)}ngOnInit(){this.filterData.setCurrentPage(ve.d.ByStore),this.dataService.init(),this.initGridOptions(),this.initStreams(),this.initSubscriptions()}ngOnDestroy(){this.dataService.destroy(),this.subs.forEach(e=>e.unsubscribe())}openCommentsView(){this.commentType=Te.a.Kpi,this.commentSubType=this.selectedKpi,this.isCommentsView=!0}onCloseComments(){this.commentType=null,this.commentSubType=null,this.commentTitles=null,this.commentNode=null,this.isCommentsView=!1}onCommentsChange(e){this.commentType!==Te.a.Kpi&&(this.commentNode.setDataValue("comment_last",e.last),this.commentNode.setDataValue("comment_count",e.total))}onTabClick(e){e!==this.selectedTab&&this.dataService.setTab(e)}onCellClick(e){switch(this.selectedTab){case Ce.Grid:this.dataService.selectStore(e.data);break;case Ce.Details:this.showDrillModal(e)}}onDrillCellClick(e){this.showTransactionModal(e)}onTransactionCellClick(e){this.showJournalModal(e)}onTrackTableChanges(){this.trackAction(_e.a.Load,this.table.grid)}exportDataAs(e){const t=(new Date).toDateString(),l=this.filterData.getFiltersListItems();this.sub=this.translate.get(a+"tab."+this.selectedTab+".label").pipe(Object(pe.a)(this.selectedMeasure$)).subscribe(([n,a])=>{const i=n+" "+a.name+" "+t;switch(e){case Se.a.XLS:this.table.exportDataAsXls(i,l),this.trackAction(_e.a.ExportXls,this.table.grid);break;case Se.a.PDF:this.table.exportDataAsPdf(i,l,()=>this.trackAction(_e.a.ExportPdf,this.table.grid),{invisible:["comment_count"]})}})}onagGridChangeFilter({api:e}){const t=e.getModel(),l=Array(t.getRowCount()).fill("").map((e,l)=>t.getRow(l).data);this.amtFields=[];for(const n of l)if(n.sn)for(const e of Object.keys(n))n.hasOwnProperty(e)&&this.addValueToSum(e,n[e])}trackAction(e,t){const l=this.filterData.getFiltersListItems();this.tracking.log({page:_e.b.Kpi,section:_e.c.ByStore,subSection:this.selectedTab||Ce.Grid,event:e,params:l,grid:t})}initStreams(){this.loading$=this.dataService.loading$,this.selectedMeasure$=this.filterData.selectedMeasure$}initSubscriptions(){this.sub=this.translate.get(["grid.column.rank","grid.column.prank","grid.column.store-name","grid.column.current-amount","grid.column.projected-amount","grid.column.budget","grid.column.delta","grid.column.total","grid.column.line-description"].map(e=>a+e)).pipe(Object(ge.a)(this.dataService.tabData$),Object(pe.a)(this.selectedMeasure$,this.dataService.selectedTab$,this.instanceAppSettingsApi.settings$,this.coreCache.storesById$.pipe(Object(xe.a)()))).subscribe(([[e,t],l,n,a,i])=>{let o={};switch(n){case Ce.Grid:o=this.getGridTabOptions(t,l,e);break;case Ce.Details:o=this.getDetailsTabOptions(t,l,a,i);break;case Ce.Trend:o=this.getTrendTabOptions(t,a,i,e)}this.columns=o.columns,this.data=o.rows,this.totalsFields=o.totalsFields,this.allowPagination=this.data.length>1e3,this.trackAction(_e.a.Load)}),this.sub=this.selectedMeasure$.subscribe(e=>{this.selectedKpi=e&&e.kpiIndex,this.selectedSection=+e.section_id;const t=e.section_id===ve.a.Docs,l=["category","kpiType","group","kpiIndex","date","period"];e.section_id===ve.a.Operarions&&this.selectedTab===Ce.Details&&l.push("view"),this.filterData.showFilters(l),this.tabs=t?[Ce.Grid,Ce.Details,Ce.Trend]:[Ce.Grid,Ce.Details],this.selectedTab!==Ce.Trend||t||this.dataService.setTab(Ce.Grid)}),this.sub=this.dataService.selectedStore$.subscribe(e=>{!e&&this.table&&this.table.agGrid&&this.table.agGrid.api&&(this.table.agGrid.api.deselectAll(),this.table.agGrid.api.clearFocusedCell())}),this.sub=this.dataService.selectedTab$.subscribe(e=>{this.selectedTab=e;const t=["category","kpiType","group","kpiIndex","date","period"];this.selectedSection===+ve.a.Operarions&&this.selectedTab===Ce.Details&&t.push("view"),this.filterData.showFilters(t)})}mapColCellRenderer(e){return{comment_count:e=>{const t=this.document.createElement("span");return t.innerText=e.valueFormatted,t.className="ag-comments-trigger",t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.commentNode=e.node,this.commentType=e.data.commentType,this.commentSubType=e.data.comment_key,this.commentTitles=e.columnApi.getAllDisplayedColumns().filter(e=>-1===e.getColId().indexOf("comment_")).map(t=>({label:t.getColDef().headerName,value:t.getColDef().valueFormatter(e)})),this.isCommentsView=!0}),t}}[e]}mapColFilter(e,t){let l=Pe.c.String;return-1!==[Pe.d.Integer,Pe.d.Money,Pe.d.Percentage].indexOf(t)?l=Pe.c.NumberRange:(t===Pe.d.Date||e.toLowerCase().indexOf("date")>=0)&&(l=Pe.c.DateRange),"fistatus".indexOf(e.toLowerCase())>=0?Pe.c.MultiChoice:l}initGridOptions(){this.options={onCellClicked:e=>{this.onCellClick(e)}},this.modalGridOptions={}}getGridTabOptions(e,t,l){const n={"-1":"red",0:"yellow",1:"green"},i=this.getLabelFormatFromSign(t.current&&t.current[1],!0);return{columns:[new Pe.a({field:"rank",name:l[a+"grid.column.rank"],labelFormat:Pe.d.Integer,filter:Pe.c.NumberRange,align:Pe.b.Left,cellRenderer:e=>{const t=e.data.rank,l=e.data.pRank;return`${e.valueFormatted}<span class="icon-rank ${t<l?"positive":t>l?"negative":"warning"}"></span>`}}),new Pe.a({field:"pRank",name:l[a+"grid.column.prank"],labelFormat:Pe.d.Integer,filter:Pe.c.NumberRange,align:Pe.b.Left}),new Pe.a({field:"storeName",name:l[a+"grid.column.store-name"],labelFormat:Pe.d.Default,filter:Pe.c.String,align:Pe.b.Left}),new Pe.a({field:"amount",name:l[a+"grid.column.current-amount"],labelFormat:i,filter:Pe.c.NumberRange,align:Pe.b.Right}),new Pe.a({field:"pAmount",name:l[a+"grid.column.projected-amount"],labelFormat:i,filter:Pe.c.NumberRange,align:Pe.b.Right,hide:!t.isProjected}),new Pe.a({field:"budget",name:l[a+"grid.column.budget"],labelFormat:i,filter:Pe.c.NumberRange,align:Pe.b.Right,cellRenderer:e=>`${e.valueFormatted}<span class="${n[e.data.deltaRank]}"></span>`}),new Pe.a({field:"delta",name:l[a+"grid.column.delta"],labelFormat:Pe.d.Percentage,filter:Pe.c.NumberRange,align:Pe.b.Right,cellRenderer:e=>`${e.valueFormatted}<span class="${n[e.data.deltaRank]}"></span>`})],rows:e}}getDetailsTabOptions(e,t,l,n){const a=[],i=[];this.amtFields={};const o=e.labels.map(e=>Object.keys(e)[1]&&1==+Object.values(e)[1]?Object.keys(e)[0]:null);for(const s of e.data){if(s.sn){s.storeId=+s.sn;const e=n.get(+s.sn);e&&(s.sn=e[l.storeNameType])}for(const e of Object.keys(s)){if((-1!==e.indexOf("sMTD")||-1!==["sTotMTD"].indexOf(e))&&s[e]instanceof Array)if("title"===s.line_type)s[e]=null;else{if(!s.labelFormat){if("N/A"===s[e][0]&&-1!==["sTotMTD"].indexOf(e)){s[e]=s[e][0];continue}s.labelFormat=this.getLabelFormatFromSign(s[e][1])}s[e]=s[e][0]}o.indexOf(e)>=0&&this.addValueToSum(e,s[e])}-1!==[ve.a.Schedules,ve.a.Operarions].indexOf(t.section_id)?(s.commentType=t.section_id===ve.a.Schedules?Te.a.Schedules:Te.a.Operations,s.hasDrill=!(t.section_id===ve.a.Operarions&&+t.kpiSubType>3)):s.hasDrill="1"===s.drill}return e.segments.base.forEach((o,s)=>{const r=e.labels[s];if(r.isTotalField&&+r.isTotalField){const e=Object.values(r)[0];i.push({key:o,label:e})}if(t.section_id===ve.a.Docs&&-1===["name","sTotMTD"].indexOf(o)){const e=n.get(+r[o]);e&&(r[o]=e[l.storeNameType])}const d=(t=>{const l=e.data[0]&&e.data[0][t];let n=Pe.d.Default;return-1!==t.indexOf("sMTD")||-1!==t.indexOf("Amount")||-1!==["sTotMTD"].indexOf(t)?n=Pe.d.Money:(-1!==["days","onhandqty","age","cost","amt"].indexOf(t.toLowerCase())||(l||0===l)&&(!isNaN(l)||l instanceof Array&&!isNaN(l[0])))&&-1===["ro","custid","advisornumber","writer","employeenumber","invoicenumber","stryear","deal","control1","vehyear"].indexOf(t.toLowerCase())&&(n=Pe.d.Integer),n})(o);a.push(new Pe.a({field:o,name:r[o],labelFormat:d,valueFormatter:e=>this.currencyFormatter(e,o),filter:this.mapColFilter(o,d),cellRenderer:this.mapColCellRenderer(o),align:0===e.segments.base.indexOf(o)?Pe.b.Left:Pe.b.Right,pinned:-1!==["name","sTotMTD"].indexOf(o)?"left":null,drillIndex:-1===["name","sTotMTD","comment_last","comment_count","comment_key"].indexOf(o)?1:null}))}),{columns:a,rows:e.data,totalsFields:i}}currencyFormatter(e,t=""){if(e.value=e.data&&e.data[t],e.data&&e.data.labelFormat)switch(e.data.labelFormat){case 2:return isNaN(e.value)?e.value:"$"+Math.round(e.value);case 5:return isNaN(e.value)?e.value:Math.round(e.value);case 10:return isNaN(e.value)?e.value:Math.round(e.value)+"%"}return isNaN(e.value)||null===e.value?e.value:Math.round(e.value)}addValueToSum(e,t){this.amtFields.hasOwnProperty(e)||(this.amtFields[e]=0),this.amtFields[e]+=+t}getTrendTabOptions(e,t,l,n){if(!e.length)return{};const i=[];let o;for(const a of e){const e={title:l.get(+a.storeName)[t.storeNameType],total:a.total&&a.total[0]};for(const t of a.trends){o||(o=this.getLabelFormatFromSign(t.value[1]));const l=t.value&&t.value[0];e[t.xaxis+t.year]=o===Pe.d.Percentage?l/100:l}i.push(e)}const s=[new Pe.a({field:"title",name:n[a+"grid.column.store-name"],labelFormat:Pe.d.Default,filter:Pe.c.String,align:Pe.b.Left}),new Pe.a({field:"total",name:n[a+"grid.column.total"],labelFormat:o,filter:Pe.c.NumberRange,align:Pe.b.Right})];return e[0].trends.reverse().forEach(e=>{s.push(new Pe.a({field:e.xaxis+e.year,name:e.xaxis+"-"+e.year.substr(2),labelFormat:o,filter:Pe.c.NumberRange,align:Pe.b.Right}))}),{columns:s,rows:i}}showDrillModal(e){const t=e.colDef.field,l=e.data;-1===["name","sTotMTD"].indexOf(t)&&l.hasDrill&&(this.drillInfo=[],this.drillData=null,this.drillColumns=null,this.drillSummaryFields=null,this.sub=this.translate.get(["modal.drill.fs-detail.title","modal.drill.control-detail.title","modal.drill.top-info.store.label","modal.drill.top-info.kpi.label","modal.drill.top-info.control.label"].map(e=>a+e)).pipe(Object(pe.a)(this.selectedMeasure$,this.filterData.selectedDate$)).subscribe(([e,{section_id:n,kpiSubType:i,name:o},s])=>{const r={section_id:n,kpiSubType:i,dateIndex:s};switch(n){case ve.a.Docs:this.drillModal.modalTitle=e[a+"modal.drill.fs-detail.title"]+" [ "+l.name+" ]",this.drillSummaryFields=["amtMTD","amtYTD","cMTD","cYTD"],r.storeId=+t.replace("sMTD",""),r.rl=String(l.rl).replace(",","");break;case ve.a.Schedules:case ve.a.Operarions:this.drillModal.modalTitle=e[a+"modal.drill.control-detail.title"],this.drillInfo=[{label:e[a+"modal.drill.top-info.store.label"],value:l.sn},{label:e[a+"modal.drill.top-info.kpi.label"],value:o},{label:e[a+"modal.drill.top-info.control.label"],value:l.deal||l.control1}],r.storeId=l.storeId,r.control1=n===ve.a.Schedules?l.control1:l.deal;break;default:return}this.drillLoading=!0,this.drillModal.showModal(),this.dataApi.getDrillDetails(r).subscribe(e=>{this.drillColumns=this.mapModalColumns(e),this.drillData=this.mapModalData(e,r.storeId,n),this.drillLoading=!1})}))}showTransactionModal(e){const t=e.data;t.hasDrill&&(this.transactionData=null,this.transactionColumns=null,this.transactionSummaryFields=null,this.sub=this.translate.get(["modal.transaction-detail.title"].map(e=>a+e)).pipe(Object(pe.a)(this.selectedMeasure$,this.filterData.selectedDate$)).subscribe(([e,{section_id:l},n])=>{const i={section_id:l,dateIndex:n,gl:t.gl,storeId:t.storeId};this.transactionModal.modalTitle=e[a+"modal.transaction-detail.title"]+" [ "+t.gl+" ]",this.transactionSummaryFields=["pa"],this.transactionLoading=!0,this.transactionModal.showModal(),this.dataApi.getTransactionDetails(i).subscribe(e=>{this.transactionColumns=this.mapModalColumns(e),this.transactionData=this.mapModalData(e,i.storeId,l),this.drillLoading=!1})}))}showJournalModal(e){const t=e.data;t.hasDrill&&(this.journalData=null,this.journalColumns=null,this.sub=this.translate.get(a+"modal.cross-to-journal-view.title").subscribe(e=>{this.journalModal.modalTitle=e,this.journalLoading=!0,this.journalModal.showModal(),this.dataApi.getJournalDetails({ji:t.ji,ri:t.ri,storeId:t.storeId}).subscribe(e=>{this.journalColumns=this.mapModalColumns(e),this.journalData=this.mapModalData(e)},()=>this.journalData=[],()=>this.journalLoading=!1)}))}mapModalColumns(e){const t=[];return e.segments.base.forEach((l,n)=>{const a=e.labels[n],i=this.mapModalColLabelFormat(l);t.push(new Pe.a({field:l,name:a[l],labelFormat:i,filter:this.mapColFilter(l,i),align:0===e.segments.base.indexOf(l)?Pe.b.Left:Pe.b.Right}))}),t}mapModalData(e,t,l){return e.data.map(e=>(Object.keys(e).forEach(t=>{e[t]=e[t]instanceof Array?e[t][0]:e[t]}),e.hasDrill=l===ve.a.Docs,e.storeId=t,e))}mapModalColLabelFormat(e){let t=Pe.d.Default;return-1!==["amtMTD","amtYTD","PostAmount","pa"].indexOf(e)?t=Pe.d.Money:-1!==["d","gd"].indexOf(e)&&(t=Pe.d.Date),t}getLabelFormatFromSign(e,t=!1){return"$"===e?t?Pe.d.MoneyAbbr:Pe.d.Money:"%"===e?Pe.d.Percentage:Pe.d.Integer}}var Fe=l("XpwZ"),je=l("yK5/"),Re=l("V3/g"),Ie=n["\u0275crt"]({encapsulation:0,styles:[[".grid-wrapper[_ngcontent-%COMP%]{flex:1 1 100%;height:100%;max-width:100%;background-color:#fff;box-shadow:2px 2px 5px 1px #c1bebe}.top-controls-block[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:space-between}.top-controls-block-left[_ngcontent-%COMP%]{width:calc(100% - 160px);flex:1 1 calc(100% - 160px);padding:20px 20px 10px;display:flex;align-items:center}.top-controls-block-right[_ngcontent-%COMP%]{width:160px;flex:1 0 160px;padding:20px 20px 10px;display:flex;align-items:center;justify-content:flex-end}.top-controls-block-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#404040;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.filters-block[_ngcontent-%COMP%]{height:70px;padding:10px 20px 20px}.grid-block[_ngcontent-%COMP%]{display:flex}.grid-block-content[_ngcontent-%COMP%]{width:calc(100% - 40px);flex:1 0 calc(100% - 40px);position:relative}.grid-block-content[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0)}.grid-block-sidebar[_ngcontent-%COMP%]{width:40px;flex:0 0 40px;border-left:1px solid #ddd}.grid-block-more-info-trigger[_ngcontent-%COMP%]{display:block;height:60px;cursor:pointer;position:relative}.grid-block-more-info-trigger[_ngcontent-%COMP%]:before{content:'\\E5D4';font-family:\"Material Icons\";font-size:24px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.grid-block-more-info-trigger.opened[_ngcontent-%COMP%]:before{content:'\\E5D3'}.top-control-btn[_ngcontent-%COMP%]{color:#5b5b5b;cursor:pointer;margin-left:20px;margin-top:-2px;display:inline-block}.top-control-label[_ngcontent-%COMP%]{color:#747474;font-size:14px;margin-left:10px}.mat-checked[_ngcontent-%COMP%]   .top-control-label[_ngcontent-%COMP%]{color:#2196f3}.tabs-block[_ngcontent-%COMP%]{height:60px;padding:10px 20px 16px}.tab[_ngcontent-%COMP%]{display:inline-block;height:34px;line-height:34px;border-radius:17px;padding-left:15px;padding-right:15px;color:#404040;font-size:14px;font-weight:500;background-color:#e5e5e5;cursor:pointer}.tab.active[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]:hover{color:#3498db;background-color:#e2eff8}.tab[_ngcontent-%COMP%]:not(:last-child){margin-right:15px}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 0 10px;height:45px}.modal-header-right[_ngcontent-%COMP%]   .top-control-btn[_ngcontent-%COMP%]:last-child{margin-right:-4px}.modal-header.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-top:-19px;margin-left:-19px;margin-right:-19px;padding:10px 20px}.modal-header.with-padding[_ngcontent-%COMP%]{padding:10px 20px}.modal-body[_ngcontent-%COMP%]{height:calc(100% - 45px);position:relative}.modal-body.with-footer[_ngcontent-%COMP%]{height:calc(100% - 45px - 50px)}.modal-body.full-height[_ngcontent-%COMP%]{height:100%}.modal-body.with-min-size[_ngcontent-%COMP%]{min-width:850px;min-height:300px;margin-left:-19px;margin-right:-19px}.modal-body.with-outer-padding-overwrite[_ngcontent-%COMP%]{margin-left:-19px;margin-right:-19px;margin-bottom:-19px}.modal-body[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.modal-footer[_ngcontent-%COMP%]{height:50px;display:flex;align-items:center;justify-content:flex-end;background:#eee;margin:0 -19px -19px;padding:0 19px}.modal-footer-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#404040;padding-right:15px}.modal-footer-text.last[_ngcontent-%COMP%]{padding-left:15px;padding-right:0}.modal-footer-text.last[_ngcontent-%COMP%]:before{content:'|';position:relative;left:-13px}.modal-heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.fi-list[_ngcontent-%COMP%]{display:flex;margin:25px 0;padding:15px 0;border-bottom:1px solid #ddd}.fi-list.single[_ngcontent-%COMP%]{padding:5px 0;margin:0;border-bottom:0}.fi-list-item[_ngcontent-%COMP%]{width:33%;flex:0 0 33%;padding:0 5px}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(1){padding-left:0}.single[_ngcontent-%COMP%]   .fi-list-item[_ngcontent-%COMP%]:nth-of-type(3){padding-right:0}.penetration-list.horizontal[_ngcontent-%COMP%]{display:flex;align-items:center}.penetration-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin:25px 0;padding:15px 0 30px;border-bottom:1px solid #ddd}.horizontal[_ngcontent-%COMP%]   .penetration-item[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:10px 15px 10px 0;margin:0;border-bottom:none}.penetration-title[_ngcontent-%COMP%]{width:30%;flex:0 0 30%;font-size:14px;color:#404040;padding-right:5px;overflow:hidden;text-overflow:ellipsis}.penetration-graph[_ngcontent-%COMP%]{width:50%;flex:0 0 50%;padding:0 5px}.penetration-rank[_ngcontent-%COMP%]{width:20%;flex:0 0 20%;padding:0 5px;text-align:center}.chargeback[_ngcontent-%COMP%]{text-align:center;margin:50px 0 30px}.chargeback[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{margin:0 0 5px;font-size:20px;font-weight:600}.chargeback-value[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#404040}.control-btn-settings[_ngcontent-%COMP%]{display:inline-block;width:24px;height:24px;position:relative;cursor:pointer}.control-btn-settings[_ngcontent-%COMP%]:before{content:'\\e8b8';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#5b5b5b;font-size:24px;font-family:\"Material Icons\"}.drill-info[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;list-style:none;padding:0;margin:0}.drill-info-item[_ngcontent-%COMP%]{color:#404040;font-size:14px;margin-right:25px}.drill-info-label[_ngcontent-%COMP%]{font-weight:400}.drill-info-value[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]{display:flex;height:100%}.grid-wrapper[_ngcontent-%COMP%]{width:340px;flex:1 0 340px}.grid-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 60px - 60px);position:relative}.grid-block[_ngcontent-%COMP%]   app-default-grid[_ngcontent-%COMP%]{will-change:auto;transition:all .5s ease;transform:translate3d(0,0,0);flex:1 1 auto;overflow:hidden}"]],data:{}});function Ae(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,2,"span",[["class","tab"]],[[2,"active",null]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.onTabClick(e.context.$implicit)&&n),n}),null,null)),(e()(),n["\u0275ted"](1,null,[" "," "])),n["\u0275pid"](131072,x.i,[x.j,n.ChangeDetectorRef])],null,(function(e,t){var l=t.component;e(t,0,0,t.context.$implicit===l.selectedTab),e(t,1,0,n["\u0275unv"](t,1,0,n["\u0275nov"](t,2).transform(l.i18n+"tab."+t.context.$implicit+".label")))}))}function Ee(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,1,"app-comments",[],[[8,"className",0]],[[null,"commentsClose"],[null,"commentsChange"]],(function(e,t,l){var n=!0,a=e.component;return"commentsClose"===t&&(n=!1!==a.onCloseComments()&&n),"commentsChange"===t&&(n=!1!==a.onCommentsChange(l)&&n),n}),v.b,v.a)),n["\u0275did"](1,4964352,null,0,C.a,[O.a,w.a,M.a,n.ChangeDetectorRef,y.b],{type:[0,"type"],subType:[1,"subType"],titles:[2,"titles"]},{commentsClose:"commentsClose",commentsChange:"commentsChange"})],(function(e,t){var l=t.component;e(t,1,0,l.commentType,l.commentSubType,l.commentTitles)}),(function(e,t){e(t,0,0,n["\u0275nov"](t,1).hostClass)}))}function Le(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,4,"li",[["class","drill-info-item"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,1,"span",[["class","drill-info-label"]],null,null,null,null,null)),(e()(),n["\u0275ted"](2,null,["",":"])),(e()(),n["\u0275eld"](3,0,null,null,1,"span",[["class","drill-info-value"]],null,null,null,null,null)),(e()(),n["\u0275ted"](4,null,["",""]))],null,(function(e,t){e(t,2,0,t.context.$implicit.label),e(t,4,0,t.context.$implicit.value)}))}function Ne(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,3,"div",[["class","modal-header with-outer-padding-overwrite"]],null,null,null,null,null)),(e()(),n["\u0275eld"](1,0,null,null,2,"ul",[["class","drill-info"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,Le)),n["\u0275did"](3,278528,null,0,k.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,3,0,t.component.drillInfo)}),null)}function Ve(e){return n["\u0275vid"](0,[n["\u0275qud"](402653184,1,{table:0}),n["\u0275qud"](402653184,2,{drillModal:0}),n["\u0275qud"](402653184,3,{transactionModal:0}),n["\u0275qud"](402653184,4,{journalModal:0}),(e()(),n["\u0275eld"](4,0,null,null,1,"app-sidebar",[],[[2,"opened",null]],null,null,K,V)),n["\u0275did"](5,114688,null,0,L,[N.a],null,null),(e()(),n["\u0275eld"](6,0,null,null,25,"div",[["class","grid-wrapper"]],null,null,null,null,null)),(e()(),n["\u0275eld"](7,0,null,null,12,"div",[["class","top-controls-block"]],null,null,null,null,null)),(e()(),n["\u0275eld"](8,0,null,null,3,"div",[["class","top-controls-block-left"]],null,null,null,null,null)),(e()(),n["\u0275eld"](9,0,null,null,2,"h3",[["class","top-controls-block-heading"]],null,null,null,null,null)),(e()(),n["\u0275ted"](10,null,["",""])),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](12,0,null,null,7,"div",[["class","top-controls-block-right"]],null,null,null,null,null)),(e()(),n["\u0275eld"](13,0,null,null,2,"app-export-buttons",[],[[2,"small",null]],[[null,"dataExport"]],(function(e,t,l){var n=!0;return"dataExport"===t&&(n=!1!==e.component.exportDataAs(l)&&n),n}),U.b,U.a)),n["\u0275did"](14,114688,null,0,X.a,[T.a],{disabled:[0,"disabled"]},{dataExport:"dataExport"}),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](16,0,null,null,3,"button",[["class","top-control-btn"]],[[8,"disabled",0]],[[null,"click"]],(function(e,t,l){var n=!0;return"click"===t&&(n=!1!==e.component.openCommentsView()&&n),n}),null,null)),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](18,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["comment"])),(e()(),n["\u0275eld"](20,0,null,null,2,"div",[["class","tabs-block"]],null,null,null,null,null)),(e()(),n["\u0275and"](16777216,null,null,1,null,Ae)),n["\u0275did"](22,278528,null,0,k.m,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),n["\u0275eld"](23,0,null,null,8,"div",[["class","grid-block"]],null,null,null,null,null)),(e()(),n["\u0275eld"](24,0,null,null,3,"app-default-grid",[],null,[[null,"onTrackChanges"],[null,"filterChanged"]],(function(e,t,l){var n=!0,a=e.component;return"onTrackChanges"===t&&(n=!1!==a.onTrackTableChanges()&&n),"filterChanged"===t&&(n=!1!==a.onagGridChangeFilter(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j]),n["\u0275did"](26,4964352,[[1,4],["table",4]],0,H.a,[$.a,J.a,W.a,Q.a,ee.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],customGridOptions:[2,"customGridOptions"],loading:[3,"loading"],pagination:[4,"pagination"]},{onTrackChanges:"onTrackChanges",filterChanged:"filterChanged"}),n["\u0275pid"](131072,k.b,[n.ChangeDetectorRef]),(e()(),n["\u0275eld"](28,0,null,null,1,"app-details-totals",[],null,null,null,oe,ne)),n["\u0275did"](29,770048,null,0,le,[],{arrTotalsLabels:[0,"arrTotalsLabels"],values:[1,"values"]},null),(e()(),n["\u0275eld"](30,0,null,null,1,"app-bottom-bar",[],[[2,"opened",null]],null,null,Me,we)),n["\u0275did"](31,245760,null,0,de,[Oe],null,null),(e()(),n["\u0275and"](16777216,null,null,1,null,Ee)),n["\u0275did"](33,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275eld"](34,0,null,null,11,"app-modal",[["class","modal-generic"]],null,null,null,ye.b,ye.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](36,1228800,[[2,4],["drillModal",4]],0,De.a,[ke.a,k.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275and"](16777216,null,0,1,null,Ne)),n["\u0275did"](38,16384,null,0,k.n,[n.ViewContainerRef,n.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),n["\u0275eld"](39,0,null,0,6,"div",[["class","modal-body with-min-size with-outer-padding-overwrite"]],null,null,null,null,null)),n["\u0275prd"](512,null,k.B,k.C,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2]),n["\u0275did"](41,278528,null,0,k.l,[k.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n["\u0275pod"](42,{"full-height":0}),(e()(),n["\u0275eld"](43,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,[[null,"cellClick"]],(function(e,t,l){var n=!0;return"cellClick"===t&&(n=!1!==e.component.onDrillCellClick(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j]),n["\u0275did"](45,4964352,null,0,H.a,[$.a,J.a,W.a,Q.a,ee.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},{cellClick:"cellClick"}),(e()(),n["\u0275eld"](46,0,null,null,6,"app-modal",[["class","modal-generic"]],null,null,null,ye.b,ye.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](48,1228800,[[3,4],["transactionModal",4]],0,De.a,[ke.a,k.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275eld"](49,0,null,0,3,"div",[["class","modal-body with-min-size"]],null,null,null,null,null)),(e()(),n["\u0275eld"](50,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,[[null,"cellClick"]],(function(e,t,l){var n=!0;return"cellClick"===t&&(n=!1!==e.component.onTransactionCellClick(l)&&n),n}),q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j]),n["\u0275did"](52,4964352,null,0,H.a,[$.a,J.a,W.a,Q.a,ee.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],summaryFields:[2,"summaryFields"],customGridOptions:[3,"customGridOptions"],loading:[4,"loading"]},{cellClick:"cellClick"}),(e()(),n["\u0275eld"](53,0,null,null,6,"app-modal",[["class","modal-generic"]],null,null,null,ye.b,ye.a)),n["\u0275prd"](512,null,ke.a,ke.a,[y.b]),n["\u0275did"](55,1228800,[[4,4],["journalModal",4]],0,De.a,[ke.a,k.d,n.ElementRef,n.Renderer2,y.b],null,null),(e()(),n["\u0275eld"](56,0,null,0,3,"div",[["class","modal-body with-min-size"]],null,null,null,null,null)),(e()(),n["\u0275eld"](57,0,null,null,2,"app-default-grid",[["style","height: 100%; width: 100%;"]],null,null,null,q.b,q.a)),n["\u0275prd"](512,null,J.a,J.a,[Y.a,_.a,Z.a,x.j]),n["\u0275did"](59,4964352,null,0,H.a,[$.a,J.a,W.a,Q.a,ee.a,y.b,T.a],{data:[0,"data"],columns:[1,"columns"],customGridOptions:[2,"customGridOptions"],loading:[3,"loading"]},null)],(function(e,t){var l=t.component;e(t,5,0),e(t,14,0,n["\u0275unv"](t,14,0,n["\u0275nov"](t,15).transform(l.loading$))),e(t,22,0,l.tabs),e(t,26,0,l.data,l.columns,l.options,n["\u0275unv"](t,26,3,n["\u0275nov"](t,27).transform(l.loading$)),!0),e(t,29,0,l.totalsFields,l.amtFields),e(t,31,0),e(t,33,0,l.isCommentsView),e(t,38,0,null==l.drillInfo?null:l.drillInfo.length);var a=e(t,42,0,!(null!=l.drillInfo&&l.drillInfo.length));e(t,41,0,"modal-body with-min-size with-outer-padding-overwrite",a),e(t,45,0,l.drillData,l.drillColumns,l.drillSummaryFields,l.modalGridOptions,l.drillLoading),e(t,52,0,l.transactionData,l.transactionColumns,l.transactionSummaryFields,l.modalGridOptions,l.transactionLoading),e(t,59,0,l.journalData,l.journalColumns,l.modalGridOptions,l.journalLoading)}),(function(e,t){var l,a=t.component;e(t,4,0,n["\u0275nov"](t,5).isOpened),e(t,10,0,null==(l=n["\u0275unv"](t,10,0,n["\u0275nov"](t,11).transform(a.selectedMeasure$)))?null:l.name),e(t,13,0,n["\u0275nov"](t,14).small),e(t,16,0,n["\u0275unv"](t,16,0,n["\u0275nov"](t,17).transform(a.loading$))),e(t,30,0,n["\u0275nov"](t,31).isOpened)}))}function Ge(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,1,"ng-component",[],null,null,null,Ve,Ie)),n["\u0275did"](1,245760,null,0,$e,[k.d,x.j,Fe.a,je.a,Z.a,N.a,Re.a,Oe],null,null)],(function(e,t){e(t,1,0)}),null)}var ze=n["\u0275ccf"]("ng-component",$e,Ge,{},{},[]),Be=l("s7LF"),Ke=l("QQfA"),Ue=l("IP0z"),Xe=l("s6ns"),qe=l("POq0"),Je=l("821u"),Ye=l("Xd0L"),Ze=l("/HVE"),He=l("IheW"),We=l("5cj1"),Qe=l("cUpR"),et=l("gavF"),tt=l("4asF"),lt=l("Mz6y"),nt=l("Mc5n"),at=l("hOhj"),it=l("iInd"),ot=l("Fwaw"),st=l("zMNK"),rt=l("5GAg"),dt=l("l0Bn"),ut=l("kPC6"),ct=l("SXLW"),pt=l("tdaM"),ht=l("0sx3"),mt=l("81ID"),gt=l("oiVm"),bt=l("xSwO"),ft=l("t5D1"),xt=l("iTUp"),vt=l("FFHx"),Ct=l("PyFA"),Ot=l("aBBA"),wt=l("Cr+6"),Mt=l("Ny1k"),yt=l("LL2G");class kt{}var Dt=l("/Lwf"),_t=l("yotz"),Tt=l("T3zS");l.d(t,"ByStoreModuleNgFactory",(function(){return Pt}));var Pt=n["\u0275cmf"](i,[],(function(e){return n["\u0275mod"]([n["\u0275mpd"](512,n.ComponentFactoryResolver,n["\u0275CodegenComponentFactoryResolver"],[[8,[o.a,s.a,r.b,r.a,d.a,u.a,c.a,p.a,h.a,m.a,g.a,b.b,f.a,ze]],[3,n.ComponentFactoryResolver],n.NgModuleRef]),n["\u0275mpd"](4608,k.p,k.o,[n.LOCALE_ID,[2,k.G]]),n["\u0275mpd"](4608,Be.F,Be.F,[]),n["\u0275mpd"](4608,Ke.c,Ke.c,[Ke.i,Ke.e,n.ComponentFactoryResolver,Ke.h,Ke.f,n.Injector,n.NgZone,k.d,Ue.b,[2,k.j]]),n["\u0275mpd"](5120,Ke.j,Ke.k,[Ke.c]),n["\u0275mpd"](5120,Xe.c,Xe.d,[Ke.c]),n["\u0275mpd"](135680,Xe.e,Xe.e,[Ke.c,n.Injector,[2,k.j],[2,Xe.b],Xe.c,[3,Xe.e],Ke.e]),n["\u0275mpd"](4608,qe.c,qe.c,[]),n["\u0275mpd"](4608,Je.i,Je.i,[]),n["\u0275mpd"](5120,Je.a,Je.b,[Ke.c]),n["\u0275mpd"](4608,Ye.a,Ye.v,[[2,Ye.f],Ze.a]),n["\u0275mpd"](4608,He.k,He.q,[k.d,n.PLATFORM_ID,He.o]),n["\u0275mpd"](4608,He.r,He.r,[He.k,He.p]),n["\u0275mpd"](5120,He.a,(function(e){return[e]}),[He.r]),n["\u0275mpd"](4608,He.n,He.n,[]),n["\u0275mpd"](6144,He.l,null,[He.n]),n["\u0275mpd"](4608,He.j,He.j,[He.l]),n["\u0275mpd"](6144,He.b,null,[He.j]),n["\u0275mpd"](4608,He.f,He.m,[He.b,n.Injector]),n["\u0275mpd"](4608,He.c,He.c,[He.f]),n["\u0275mpd"](4608,W.a,W.a,[y.b]),n["\u0275mpd"](4608,Be.f,Be.f,[]),n["\u0275mpd"](4608,We.c,We.c,[He.c,Qe.b]),n["\u0275mpd"](5120,et.c,et.j,[Ke.c]),n["\u0275mpd"](4608,tt.a,tt.a,[Xe.e]),n["\u0275mpd"](5120,lt.b,lt.c,[Ke.c]),n["\u0275mpd"](4608,Qe.e,Ye.c,[[2,Ye.g],[2,Ye.l]]),n["\u0275mpd"](4608,We.d,We.d,[]),n["\u0275mpd"](4608,nt.f,nt.f,[k.d,n.NgZone,at.i,nt.h]),n["\u0275mpd"](4608,Oe,Oe,[x.j,Re.a,N.a,Fe.a,je.a,$.a]),n["\u0275mpd"](1073742336,k.c,k.c,[]),n["\u0275mpd"](1073742336,it.s,it.s,[[2,it.x],[2,it.o]]),n["\u0275mpd"](1073742336,x.g,x.g,[]),n["\u0275mpd"](1073742336,Be.E,Be.E,[]),n["\u0275mpd"](1073742336,Be.m,Be.m,[]),n["\u0275mpd"](1073742336,Ue.a,Ue.a,[]),n["\u0275mpd"](1073742336,Ye.l,Ye.l,[[2,Ye.d],[2,Qe.f]]),n["\u0275mpd"](1073742336,Ze.b,Ze.b,[]),n["\u0275mpd"](1073742336,Ye.u,Ye.u,[]),n["\u0275mpd"](1073742336,ot.c,ot.c,[]),n["\u0275mpd"](1073742336,st.g,st.g,[]),n["\u0275mpd"](1073742336,at.f,at.f,[]),n["\u0275mpd"](1073742336,Ke.g,Ke.g,[]),n["\u0275mpd"](1073742336,Xe.k,Xe.k,[]),n["\u0275mpd"](1073742336,qe.d,qe.d,[]),n["\u0275mpd"](1073742336,rt.a,rt.a,[]),n["\u0275mpd"](1073742336,Je.j,Je.j,[]),n["\u0275mpd"](1073742336,Ye.w,Ye.w,[]),n["\u0275mpd"](1073742336,Ye.n,Ye.n,[]),n["\u0275mpd"](1073742336,He.e,He.e,[]),n["\u0275mpd"](1073742336,He.d,He.d,[]),n["\u0275mpd"](1073742336,dt.a,dt.a,[]),n["\u0275mpd"](1073742336,ut.a,ut.a,[]),n["\u0275mpd"](1073742336,ct.AgGridModule,ct.AgGridModule,[]),n["\u0275mpd"](1073742336,pt.a,pt.a,[]),n["\u0275mpd"](1073742336,ht.a,ht.a,[]),n["\u0275mpd"](1073742336,Be.A,Be.A,[]),n["\u0275mpd"](1073742336,We.b,We.b,[]),n["\u0275mpd"](1073742336,et.i,et.i,[]),n["\u0275mpd"](1073742336,et.f,et.f,[]),n["\u0275mpd"](1073742336,mt.a,mt.a,[]),n["\u0275mpd"](1073742336,gt.a,gt.a,[]),n["\u0275mpd"](1073742336,lt.e,lt.e,[]),n["\u0275mpd"](1073742336,bt.a,bt.a,[]),n["\u0275mpd"](1073742336,ft.a,ft.a,[]),n["\u0275mpd"](1073742336,xt.a,xt.a,[]),n["\u0275mpd"](1073742336,vt.a,vt.a,[]),n["\u0275mpd"](1073742336,Ct.a,Ct.a,[[3,Ct.a],Ot.a]),n["\u0275mpd"](1073742336,wt.a,wt.a,[]),n["\u0275mpd"](1073742336,Mt.a,Mt.a,[Ot.a]),n["\u0275mpd"](1073742336,yt.a,yt.a,[[3,yt.a],Ot.a]),n["\u0275mpd"](1073742336,kt,kt,[]),n["\u0275mpd"](1073742336,nt.g,nt.g,[]),n["\u0275mpd"](1073742336,Dt.a,Dt.a,[]),n["\u0275mpd"](1073742336,_t.b,_t.b,[]),n["\u0275mpd"](1073742336,Tt.a,Tt.a,[]),n["\u0275mpd"](1073742336,i,i,[Ot.a]),n["\u0275mpd"](256,Ye.e,Ye.i,[]),n["\u0275mpd"](256,He.o,"XSRF-TOKEN",[]),n["\u0275mpd"](256,He.p,"X-XSRF-TOKEN",[]),n["\u0275mpd"](1024,it.m,(function(){return[[{path:"",component:$e}]]}),[])])}))},lbNG:function(e,t,l){"use strict";l.d(t,"a",(function(){return d}));var n=l("8Y7J"),a=l("2Vo4"),i=l("itXk"),o=l("lJxs"),s=(l("/kTj"),l("Q34l")),r=l("A/Dr");class d{constructor(e,t,l,i,o,r,d,u){this.el=e,this.viewContainerRef=t,this.resolver=l,this.dialog=i,this.session=o,this.translate=r,this.editorApi=d,this.editorDisabled=!1,this.editorPlacement="bottom",this.onUpdate=new n.EventEmitter,this.highlighted=!1,this.editable=!1,this.editableAccessLevels=new Set([s.a.Admin,s.a.DashboardSupport]),this.highlightedAccessLevels=new Set([s.a.Corporate,s.a.Admin,s.a.DashboardSupport]),this.params$=new a.a(void 0),this.subs=[],this.debug=u.factory(new.target.name)}get title(){return this.editable?this.translate.instant("editor.editable-field.tooltip-text"):""}set sub(e){this.subs.push(e)}ngOnChanges(e){e.params&&this.params$.next(this.params)}ngOnInit(){this.sub=Object(i.b)(this.params$.pipe(Object(o.a)(e=>(this.debug.assert(!(e&&e.fields)||e.fields instanceof Array==1&&e.fields.length,"Params changed. 'fields' should be an array with at least one item. Params: %O",e),e&&e.fields.filter(e=>!!e.uid).length?e:void 0))),this.session.currentUser$).subscribe(([e,t])=>{const l=t.allowToEditBudget,n=this.highlightedAccessLevels.has(+t.AccessLevel),a=!!e;this.highlighted=n&&a,this.editable=l&&a,this.uidEditInfo=e})}ngOnDestroy(){this.subs.forEach(e=>e.unsubscribe())}openEditor(){if(!this.editable)return;if(this.debug.log("Open editor. Disabled: %s",this.editorDisabled),this.editorDisabled)return;const e=document.createEvent("HTMLEvents");e.initEvent("mouseleave",!0,!0),this.el.nativeElement.dispatchEvent(e);const t=this.resolver.resolveComponentFactory(r.a),l=this.viewContainerRef.createComponent(t),n=l.instance;n.hostElement=this.viewContainerRef.element.nativeElement,n.placement=this.editorPlacement,n.uidEditInfo=this.uidEditInfo,n.theme="dark";const a=n.cancel.subscribe(()=>l.destroy()),i=n.apply.subscribe(e=>{this.debug.assert(this.uidEditInfo,"There is no uid edit info");const t=Object.keys(e).map(e=>this.uidEditInfo.fields.find(t=>t.field===e)).map(t=>({uid:t.uid,field:t.fieldUpdate,value:e[t.field]}));l.destroy(),this.update(t)});l.onDestroy(()=>{a.unsubscribe(),i.unsubscribe()})}update(e){const t=e.map(e=>this.editorApi.updateFieldValue(this.params.type,e));Object(i.b)(t).subscribe(t=>{this.debug.log("Updated:",e),t.forEach(e=>{e.saved&&200!==e.saved.status&&this.dialog.warningT("Something went wrong.",{suffix:this.dialog.tryAgainLaterMessage})}),this.onUpdate.emit()},()=>this.dialog.warningT("Something went wrong.",{suffix:this.dialog.tryAgainLaterMessage}))}}}}]);