!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{SzTg:function(t,n,a){"use strict";a.r(n),a.d(n,"AdminRecipeModule",function(){return E});var o,c,s,d,l,p,u,b=a("3Pt+"),f=a("ofXK"),h=a("cWTo"),g=a("tyNb"),m=a("fXoL"),v=a("RPu0"),P=a("5eHb"),w=((o=function(){function e(t,n,r,a){i(this,e),this.document=t,this.service=n,this.toast=r,this.cdr=a,this.editRecipe=new m.n}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.service.newRecipeAdded$.subscribe(function(t){e.rowData=e.rowData.filter(function(e){return e.id!==t.id}),e.rowData.push(t),e.cdr.markForCheck()})}},{key:"onDelete",value:function(e){var t=this;confirm("Esta seguro de eliminar esta receta?")&&this.service.deleteRecipe(e).subscribe(function(i){t.toast.success("Receta eliminada!"),t.rowData=t.rowData.filter(function(t){return t.id!==e}),t.editRecipe.emit(null),t.cdr.markForCheck()})}},{key:"ngOnDestroy",value:function(){this.subs&&this.subs.unsubscribe()}},{key:"onSelectRow",value:function(e){var t,i=null===(t=this.gridApi)||void 0===t?void 0:t.getSelectedRows();this.editRecipe.emit(i[0])}},{key:"initGridOptions",value:function(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!0,resizable:!0,sortable:!0}}},{key:"prepareGridColumns",value:function(){var e=this;return[{field:"id",hide:!0},{field:"name",headerName:"Receta",width:"400"},{field:"description",headerName:"Descripcion",width:"350"},{field:"",headerName:"",cellRenderer:function(t){var i=e.document.createElement("span");return i.innerHTML='<i class="far fa-trash-alt fa-lg text-danger" ></i>',i.className="link",i.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation(),e.onDelete(null==t?void 0:t.data.id)}),i},width:"60px",filter:"",floatingFilter:!1}]}},{key:"onGridReady",value:function(e){var t=this;this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGridOptions(),this.subs=this.service.getRecipes().subscribe(function(e){t.columnDefs=t.prepareGridColumns(),t.rowData=e,t.cdr.markForCheck()})}}]),e}()).\u0275fac=function(e){return new(e||o)(m.Kb(f.e),m.Kb(v.a),m.Kb(P.c),m.Kb(m.h))},o.\u0275cmp=m.Eb({type:o,selectors:[["app-recipe-list"]],outputs:{editRecipe:"editRecipe"},decls:3,vars:6,consts:[[2,"height","100%","box-sizing","border-box"],["id","recipeGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection","pagination","paginationPageSize","selectionChanged","gridReady"],["recipeGrid",""]],template:function(e,t){1&e&&(m.Pb(0,"div",0),m.Pb(1,"ag-grid-angular",1,2),m.Wb("selectionChanged",function(e){return t.onSelectRow(e)})("gridReady",function(e){return t.onGridReady(e)}),m.Ob(),m.Ob()),2&e&&(m.zb(1),m.fc("defaultColDef",t.defaultColDef)("columnDefs",t.columnDefs)("rowData",t.rowData)("rowSelection","single")("pagination",!0)("paginationPageSize",100))},directives:[h.a],styles:["[_nghost-%COMP%]     .link{text-decoration:none;cursor:pointer}"],changeDetection:0}),o),O=a("7pcG"),y=a("Nmv1"),x=a("8SKR"),C=a("jhN1"),k=["*"],D=((c=function(){function e(){i(this,e),this.isOpened=!1,this.textOpen="Ver detalles",this.textClose="Ocultar detalles"}return r(e,[{key:"onToggle",value:function(){this.isOpened=!this.isOpened}}]),e}()).\u0275fac=function(e){return new(e||c)},c.\u0275cmp=m.Eb({type:c,selectors:[["app-bottom-bar"]],hostVars:2,hostBindings:function(e,t){2&e&&m.Cb("opened",t.isOpened)},inputs:{textOpen:"textOpen",textClose:"textClose"},ngContentSelectors:k,decls:7,vars:2,consts:[[1,"bottom-bar-header",3,"click"],[3,"ngClass"],[1,"headerText"],[1,"bottom-bar-body"],[1,"content-details"]],template:function(e,t){1&e&&(m.ec(),m.Pb(0,"div",0),m.Wb("click",function(){return t.onToggle()}),m.Lb(1,"i",1),m.Pb(2,"span",2),m.wc(3),m.Ob(),m.Ob(),m.Pb(4,"div",3),m.Pb(5,"div",4),m.dc(6),m.Ob(),m.Ob()),2&e&&(m.zb(1),m.fc("ngClass",t.isOpened?"fas fa-chevron-up":"fas fa-chevron-down"),m.zb(2),m.xc(t.isOpened?t.textClose:t.textOpen))},directives:[f.q],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;flex:0 0 40px;transition:flex .5s ease}.opened[_nghost-%COMP%]{flex:0 0 275px}.headerText[_ngcontent-%COMP%]{font-weight:bolder;padding-left:20px}.bottom-bar-header[_ngcontent-%COMP%]{height:40px;padding:5px 20px;display:flex;cursor:pointer;align-items:center;border-top:1px solid #747474;background-color:#a9a9a9}  .opened .bottom-bar-header{border-top:none;border-bottom:1px solid #747474}.bottom-bar-body[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .5s ease}  .opened .bottom-bar-body{height:calc(100% - 40px)}.bottom-bar-trigger[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:#00f;cursor:pointer;position:relative;padding-left:24px;text-transform:uppercase}.bottom-bar-trigger[_ngcontent-%COMP%]:before{content:"\ue316";font-family:Material Icons;font-size:24px;color:inherit;cursor:inherit;display:inline-block;position:absolute;left:0;top:50%;transform:translateY(-54%)}  .opened .bottom-bar-trigger:before{content:"\ue313"}.content-details[_ngcontent-%COMP%]{height:100%}.content-details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;padding:10px 20px 5px;height:50px}.content-details-body[_ngcontent-%COMP%]{height:calc(100% - 50px);padding:0 20px 10px}.content-details-heading[_ngcontent-%COMP%]{margin:10px 0 0;font-size:16px;font-weight:500;color:#404040}']}),c),M=a("eIxW"),R=a("6ILZ"),z=((s=function(){function t(e,n,r,a,o,c,s,d){i(this,t),this.document=e,this.service=n,this.userService=r,this.prepService=a,this.toast=o,this.modal=c,this.cdr=s,this.sanitizer=d,this.newRecipe=!0,this.recipeData={id:"0",name:"",description:"",imageUrl:"",preparations:[]},this.avatarBgSize="80%",this.imageAvatarFile="",this.imageAvatar="/assets/img/default.png",this.rowPrepData=[],this.recipeToEdit={}}return r(t,[{key:"ngOnInit",value:function(){this.initGridOptions()}},{key:"ngOnChanges",value:function(){var t=this;this.recipeToEdit?(this.newRecipe=!1,this.recipeData=Object.assign({},this.recipeToEdit),this.renderAvatar(this.recipeData.imageUrl),this.columnDefs=this.prepareGridPrepColumns(),this.rowPrepData=[],this.cdr.markForCheck(),this.prepService.getPreparationsByRecipe(this.recipeData.id).subscribe(function(i){i.map(function(e){var i,n;t.rowPrepData.push(Object.assign(Object.assign({},e),{userName:e.user?(null===(i=e.user)||void 0===i?void 0:i.name)+" "+(null===(n=e.user)||void 0===n?void 0:n.lastName):""}))}),t.rowPrepData=e(t.rowPrepData),t.cdr.markForCheck()})):(this.rowPrepData=[],this.resetForm())}},{key:"prepareGridPrepColumns",value:function(){var e=this;return[{field:"id",hide:!0},{field:"name",headerName:"Receta",width:"200"},{field:"description",headerName:"Descripcion",width:"100"},{field:"userName",headerName:"Usuario registro",width:"150"},{field:"active",headerName:"Activo",width:"100",cellRenderer:function(e){var t;return(null===(t=e.data)||void 0===t?void 0:t.active)?"Si":"No"}},{field:"",headerName:"",cellRenderer:function(t){var i=e.document.createElement("span");return i.innerHTML='<i class="fas fa-edit" alt="Editar"></i>',i.className="link",i.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation(),e.onEditPrep(null==t?void 0:t.data)}),i},width:"60px",filter:"",floatingFilter:!1}]}},{key:"initGridOptions",value:function(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!1,resizable:!0,sortable:!0}}},{key:"onEditPrep",value:function(e){this.selectedPrep=e,this.openModal("prepcard"),this.cdr.markForCheck()}},{key:"openModal",value:function(e){this.modal.open(e)}},{key:"closeModal",value:function(e){this.modal.close(e)}},{key:"onSavePrep",value:function(e){var t=this;this.service.updateAdminPreparation(e.id,e.active).subscribe(function(i){t.rowPrepData=t.rowPrepData.filter(function(t){return t.id!==e.id}),t.rowPrepData.push(e),t.closeModal("prepcard"),t.cdr.markForCheck()})}},{key:"onDeletePreparation",value:function(e){var t=this;this.service.deletePreparation(e).subscribe(function(i){t.toast.success("Preparaci\xf3n eliminada!"),t.rowPrepData=t.rowPrepData.filter(function(t){return t.id!==e}),t.closeModal("prepcard"),t.cdr.markForCheck()})}},{key:"onSubmit",value:function(){var e=this;this.newRecipe?this.service.createRecipe(this.recipeData).subscribe(function(t){e.toast.success("Receta creada exitosamente"),e.service.notifyNewRecipe(Object.assign(Object.assign({},e.recipeData),{id:t.id})),e.resetForm()}):this.service.updateRecipe(this.recipeData).subscribe(function(t){e.toast.success("Receta modificada exitosamente"),e.service.notifyNewRecipe(e.recipeData),e.resetForm()})}},{key:"showAvatarPreview",value:function(e){var t=this;if(-1===["image/jpeg","image/png"].indexOf(e.target.files[0].type))return this.toast.error("Imagen Invalida"),e.target.value="",!1;var i=new FileReader;i.onload=function(){t.renderAvatar(i.result),t.imageAvatarFile=i.result,t.recipeData.imageUrl=t.imageAvatarFile},i.readAsDataURL(e.target.files[0])}},{key:"renderAvatar",value:function(e){this.imageAvatar=this.sanitizer.bypassSecurityTrustStyle("url('".concat(e,"')")),this.avatarBgSize="cover",this.cdr.markForCheck()}},{key:"resetForm",value:function(e){this.newRecipe=!0,this.imageAvatar=null,this.recipeData={id:"0",name:"",description:"",imageUrl:""},null!=e&&e.form.reset(),this.cdr.markForCheck()}}]),t}()).\u0275fac=function(e){return new(e||s)(m.Kb(f.e),m.Kb(v.a),m.Kb(O.a),m.Kb(y.a),m.Kb(P.c),m.Kb(x.a),m.Kb(m.h),m.Kb(C.b))},s.\u0275cmp=m.Eb({type:s,selectors:[["app-admin-recipe-form"]],inputs:{recipeToEdit:"recipeToEdit"},features:[m.xb],decls:44,vars:21,consts:[["autocomplete","off",3,"submit"],["form","ngForm"],[1,"form-group"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text","bg-white"],[1,"fas","fa-utensils"],["name","name","placeholder","Nombre Receta","required","","maxlength","100",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[1,"fas","fa-font"],["name","summary","placeholder","Descripcion","maxlength","500","rows","5",1,"form-control",3,"ngModel","ngModelChange"],["summary","ngModel"],[1,"user-avatar"],[1,"form-group","photo-upload"],[1,"photo-upload-preview"],[1,"photo-upload-label"],[1,"btn","btn-primary","btn-sm"],["type","file","accept","image/gif, image/jpeg, image/png","name","avatar",3,"change"],[3,"textOpen","textClose"],[2,"height","400px","box-sizing","border-box"],["id","preparationsGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection"],["preparationsGrid",""],["type","hidden","name","id",3,"ngModel","ngModelChange"],["id","ngModel"],[1,"form-group",2,"display","flex"],["type","button",1,"btn","btn-success","btn-lg","btn-block","col-md-5",3,"click"],[1,"fas","fa-plus"],[1,"col-md-2"],["type","submit",1,"btn","btn-success","btn-lg","btn-block","col-md-5",3,"disabled"],[1,"fas","fa-database"],["id","prepcard"],["title","Volver",1,"fas","fa-times-circle","close-button-modal",3,"click"],[3,"preparation","updatePrep","deletePrep"]],template:function(e,t){if(1&e){var i=m.Qb();m.Pb(0,"form",0,1),m.Wb("submit",function(){return t.onSubmit()}),m.Pb(2,"div",2),m.Pb(3,"div",3),m.Pb(4,"div",4),m.Pb(5,"div",5),m.Lb(6,"i",6),m.Ob(),m.Ob(),m.Pb(7,"input",7,8),m.Wb("ngModelChange",function(e){return t.recipeData.name=e}),m.Ob(),m.Ob(),m.Ob(),m.Pb(9,"div",2),m.Pb(10,"div",3),m.Pb(11,"div",4),m.Pb(12,"div",5),m.Lb(13,"i",9),m.Ob(),m.Ob(),m.Pb(14,"textarea",10,11),m.Wb("ngModelChange",function(e){return t.recipeData.description=e}),m.Ob(),m.Ob(),m.Ob(),m.Pb(16,"div",2),m.Pb(17,"div",12),m.Pb(18,"div",13),m.Lb(19,"div",14),m.Pb(20,"label",15),m.Pb(21,"span",16),m.wc(22,"Cargar Imagen"),m.Ob(),m.Pb(23,"input",17),m.Wb("change",function(e){return t.showAvatarPreview(e)}),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Lb(24,"BR"),m.Lb(25,"BR"),m.Pb(26,"app-bottom-bar",18),m.Pb(27,"div",19),m.Lb(28,"ag-grid-angular",20,21),m.Ob(),m.Ob(),m.Lb(30,"br"),m.Pb(31,"input",22,23),m.Wb("ngModelChange",function(e){return t.recipeData.id=e}),m.Ob(),m.Pb(33,"div",24),m.Pb(34,"button",25),m.Wb("click",function(){m.mc(i);var e=m.kc(1);return t.resetForm(e)}),m.Lb(35,"i",26),m.wc(36," Nueva Receta"),m.Ob(),m.Lb(37,"div",27),m.Pb(38,"button",28),m.Lb(39,"i",29),m.wc(40," Guardar"),m.Ob(),m.Ob(),m.Ob(),m.Pb(41,"app-jwmodal",30),m.Pb(42,"i",31),m.Wb("click",function(){return t.closeModal("prepcard")}),m.Ob(),m.Pb(43,"app-prep-card",32),m.Wb("updatePrep",function(e){return t.onSavePrep(e)})("deletePrep",function(e){return t.onDeletePreparation(e)}),m.Ob(),m.Ob()}if(2&e){var n=m.kc(1),r=m.kc(8);m.zb(6),m.Cb("green-icon",r.valid)("red-icon",r.invalid&&r.touched),m.zb(1),m.fc("ngModel",t.recipeData.name),m.zb(6),m.Cb("green-icon",!0),m.zb(1),m.fc("ngModel",t.recipeData.description),m.zb(5),m.tc("background-size",t.avatarBgSize)("background-image",t.imageAvatar),m.zb(7),m.fc("textOpen","Ver Preparaciones")("textClose","Ocultar Preparaciones"),m.zb(2),m.fc("defaultColDef",t.defaultColDef)("columnDefs",t.columnDefs)("rowData",t.rowPrepData)("rowSelection","single"),m.zb(3),m.fc("ngModel",t.recipeData.id),m.zb(7),m.fc("disabled",n.invalid),m.zb(5),m.fc("preparation",t.selectedPrep)}},directives:[b.C,b.o,b.p,b.c,b.y,b.i,b.n,b.q,D,h.a,M.a,R.a],styles:[".error[_ngcontent-%COMP%]{color:red;font-size:small}.photo-upload[_ngcontent-%COMP%]{max-width:150px}@media screen and (max-width:640px){.photo-upload[_ngcontent-%COMP%]{margin-right:10px}}@media screen and (max-width:460px){.photo-upload[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}}.photo-upload[_ngcontent-%COMP%]   .photo-upload-preview[_ngcontent-%COMP%]{width:150px;height:150px;background-color:#e3e3e3;border:1px solid #9ba2ac;margin-bottom:10px;background-image:url(/assets/img/default.png);background-repeat:no-repeat;background-position:50%}.photo-upload[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.photo-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;width:100%}.photo-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]     .link{text-decoration:none;cursor:pointer}"],changeDetection:0}),s),S=[{path:"",component:(d=function(){function e(){i(this,e)}return r(e,[{key:"ngOnInit",value:function(){console.log("init admin")}},{key:"onRecipeSelected",value:function(e){this.recipe=e}}]),e}(),d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=m.Eb({type:d,selectors:[["app-admin-recipe"]],decls:9,vars:7,consts:[[1,"jumbtron"],[1,"display-4","text-center"],[1,"row","grid"],[1,"col-md-6"],[3,"editRecipe"],[1,"col-md-5"],[3,"recipeToEdit"]],template:function(e,t){1&e&&(m.Pb(0,"div",0),m.Pb(1,"h1",1),m.wc(2,"Administracion de recetas"),m.Ob(),m.Lb(3,"hr"),m.Pb(4,"div",2),m.Pb(5,"div",3),m.Pb(6,"app-recipe-list",4),m.Wb("editRecipe",function(e){return t.onRecipeSelected(e)}),m.Ob(),m.Ob(),m.Pb(7,"div",5),m.Lb(8,"app-admin-recipe-form",6),m.Ob(),m.Ob(),m.Ob()),2&e&&(m.tc("margin-top",80,"px"),m.zb(5),m.tc("margin-left",20,"px"),m.zb(2),m.tc("margin-left",20,"px"),m.zb(1),m.fc("recipeToEdit",t.recipe))},directives:[w,z],styles:[".grid[_ngcontent-%COMP%]{height:calc(70vh - 10px)}"]}),d)}],A=((l=function e(){i(this,e)}).\u0275mod=m.Ib({type:l}),l.\u0275inj=m.Hb({factory:function(e){return new(e||l)},imports:[[g.f.forChild(S)],g.f]}),l),F=a("ADsi"),_=((p=function e(){i(this,e)}).\u0275mod=m.Ib({type:p}),p.\u0275inj=m.Hb({factory:function(e){return new(e||p)},imports:[[f.c]]}),p),N=a("ShNc"),E=((u=function e(){i(this,e)}).\u0275mod=m.Ib({type:u}),u.\u0275inj=m.Hb({factory:function(e){return new(e||u)},providers:[],imports:[[f.c,A,b.h,F.a,N.a,_,h.c.withComponents([])]]}),u)}}])}();