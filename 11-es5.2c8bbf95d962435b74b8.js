!function(){function e(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{UYvW:function(r,a,n){"use strict";n.r(a),n.d(a,"PreparationListAdminModule",function(){return A});var o=n("3Pt+"),c=n("ofXK"),s=n("cWTo"),d=n("tyNb"),l=n("fXoL"),u=n("RPu0"),p=n("7pcG"),f=n("5eHb"),h=n("8SKR"),v=n("eIxW"),b=n("3KhC"),m=n("6ILZ"),g=n("lOxl");function w(e,r){if(1&e){var t=l.Qb();l.Pb(0,"app-user-card",14),l.Wb("updateUser",function(e){return l.mc(t),l.ac().onSaveUser(e)})("deleteUser",function(e){return l.mc(t),l.ac().onDeleteUser(e)}),l.Ob()}if(2&e){var i=l.ac();l.fc("user",i.selectedUser)}}function P(e,r){if(1&e){var t=l.Qb();l.Pb(0,"app-prep-card",15),l.Wb("updatePrep",function(e){return l.mc(t),l.ac().onSavePrep(e)})("deletePrep",function(e){return l.mc(t),l.ac().onDelete(e)}),l.Ob()}if(2&e){var i=l.ac();l.fc("preparation",i.selectedPrep)}}function y(e,r){if(1&e){var t=l.Qb();l.Pb(0,"app-detail-prep-card",16),l.Wb("closeButton",function(){return l.mc(t),l.ac().closeModal("viewcard")}),l.Ob()}if(2&e){var i=l.ac();l.fc("prep",i.selectedPrep)("userId",i.userId)}}var k,D,C,O=[{path:"",component:(k=function(){function r(e,i,a,n,o,c){t(this,r),this.document=e,this.service=i,this.serviceUser=a,this.toast=n,this.modal=o,this.cdr=c,this.rowData=[]}var a,n,o;return a=r,(n=[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subs&&this.subs.unsubscribe()}},{key:"initGridOptions",value:function(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!0,resizable:!0,sortable:!0}}},{key:"prepareGridColumns",value:function(){var e=this;return[{field:"",headerName:"",cellRenderer:function(r){var t=e.document.createElement("span");return t.innerHTML='<i class="fas fa-eye" alt="Ver Preparacion"></i>',t.className="link",t.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.onViewPrep(null==r?void 0:r.data)}),t},width:"60px",filter:"",floatingFilter:!1},{field:"",headerName:"",cellRenderer:function(r){var t=e.document.createElement("span");return t.innerHTML='<i class="fas fa-edit" alt="Editar Preparacion"></i>',t.className="link",t.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.onEditPrep(null==r?void 0:r.data)}),t},width:"60px",filter:"",floatingFilter:!1},{field:"id",hide:!0},{field:"recipeName",headerName:"Receta",width:"220"},{field:"name",headerName:"Nombre Preparacion",width:"220"},{field:"description",headerName:"Descripci\xf3n",width:"450"},{field:"",headerName:"Usuario Registro",cellRenderer:function(r){var t,i,a,n,o=e.document.createElement("span");return o.innerHTML=(null===(i=null===(t=r.data)||void 0===t?void 0:t.user)||void 0===i?void 0:i.name)+" "+(null===(n=null===(a=r.data)||void 0===a?void 0:a.user)||void 0===n?void 0:n.lastName),o.className="link",o.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.onClickUser(null==r?void 0:r.data.user)}),o},width:"200px"},{field:"carrierCommunity",headerName:"Comunidad portadora",width:"200"},{field:"preparationType",headerName:"Tipo preparaci\xf3n",width:"200"},{field:"authorName",headerName:"Autor preparaci\xf3n",width:"200"}]}},{key:"onSelectRow",value:function(e){var r,t,i,a=null===(r=this.gridApi)||void 0===r?void 0:r.getSelectedRows();this.userId=null===(i=null===(t=a[0])||void 0===t?void 0:t.user)||void 0===i?void 0:i.id,console.log(a)}},{key:"onDeletePrep",value:function(e){var r=this;confirm("ESta seguro de eliminar esta Preparaci\xf3n")&&this.service.deletePreparation(e).subscribe(function(t){r.toast.success("Preparaci\xf3n eliminada"),r.rowData=r.rowData.filter(function(r){return r.id!==e}),r.closeModal("prepcard"),r.cdr.markForCheck()})}},{key:"onEditPrep",value:function(e){this.selectedPrep=e,this.openModal("prepcard"),this.cdr.markForCheck()}},{key:"onViewPrep",value:function(e){this.selectedPrep=e,this.openModal("viewcard"),this.cdr.markForCheck()}},{key:"onClickUser",value:function(e){var r=this;this.serviceUser.getUser(e.id).subscribe(function(e){r.selectedUser=e,r.openModal("usercard"),r.cdr.markForCheck()})}},{key:"onDeleteUser",value:function(e){var r=this;this.serviceUser.deleteUser(e).subscribe(function(t){r.toast.success("Usuario eliminado"),r.rowData=r.rowData.filter(function(r){return r.user.id!==e}),r.closeModal("usercard"),r.cdr.markForCheck()})}},{key:"onDelete",value:function(e){var r=this;this.service.deletePreparation(e).subscribe(function(t){r.toast.success("Preparaci\xf3n eliminada!"),r.rowData=r.rowData.filter(function(r){return r.id!==e}),r.closeModal("prepcard"),r.cdr.markForCheck()})}},{key:"onSaveUser",value:function(e){var r=this;this.serviceUser.updateUserAdmin(e.id,e.role,e.active).subscribe(function(e){r.toast.success("Usuario actualizado"),r.closeModal("usercard"),r.cdr.markForCheck()})}},{key:"onSavePrep",value:function(e){var r=this;e.active&&this.service.updateAdminPreparation(e.id,e.active).subscribe(function(t){r.toast.success("Preparaci\xf3n Activada"),r.rowData=r.rowData.filter(function(r){return r.id!==e.id}),r.closeModal("prepcard"),r.cdr.markForCheck()})}},{key:"onGridReady",value:function(r){var t=this;this.gridApi=r.api,this.gridColumnApi=r.columnApi,this.initGridOptions(),this.columnDefs=this.prepareGridColumns(),this.subs=this.service.getInactivePreparations().subscribe(function(r){r.map(function(e){var r,i,a;t.rowData.push(Object.assign(Object.assign({},e),{authorName:e.author?(null===(r=e.author)||void 0===r?void 0:r.name)+" "+(null===(i=e.author)||void 0===i?void 0:i.lastName):"",recipeName:null===(a=e.recipe)||void 0===a?void 0:a.name}))}),t.rowData=e(t.rowData),t.cdr.markForCheck()})}},{key:"openModal",value:function(e){this.modal.open(e)}},{key:"closeModal",value:function(e){this.modal.close(e)}}])&&i(a.prototype,n),o&&i(a,o),r}(),k.\u0275fac=function(e){return new(e||k)(l.Kb(c.e),l.Kb(u.a),l.Kb(p.a),l.Kb(f.c),l.Kb(h.a),l.Kb(l.h))},k.\u0275cmp=l.Eb({type:k,selectors:[["ng-component"]],decls:17,vars:11,consts:[[1,"jumbtron"],[1,"display-4","text-center"],[1,"row"],[1,"col-md-12","grid"],[2,"height","100%","box-sizing","border-box"],["id","userGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection","pagination","paginationPageSize","selectionChanged","gridReady"],["userGrid",""],["id","usercard"],["title","Volver",1,"fas","fa-times-circle","close-button-modal",3,"click"],[3,"user","updateUser","deleteUser",4,"ngIf"],["id","prepcard"],[3,"preparation","updatePrep","deletePrep",4,"ngIf"],["id","viewcard"],[3,"prep","userId","closeButton",4,"ngIf"],[3,"user","updateUser","deleteUser"],[3,"preparation","updatePrep","deletePrep"],[3,"prep","userId","closeButton"]],template:function(e,r){1&e&&(l.Pb(0,"div",0),l.Pb(1,"h1",1),l.wc(2,"Administracion Preparaciones Inactivas"),l.Ob(),l.Lb(3,"hr"),l.Pb(4,"div",2),l.Pb(5,"div",3),l.Pb(6,"div",4),l.Pb(7,"ag-grid-angular",5,6),l.Wb("selectionChanged",function(e){return r.onSelectRow(e)})("gridReady",function(e){return r.onGridReady(e)}),l.Ob(),l.Ob(),l.Pb(9,"app-jwmodal",7),l.Pb(10,"i",8),l.Wb("click",function(){return r.closeModal("usercard")}),l.Ob(),l.vc(11,w,1,1,"app-user-card",9),l.Ob(),l.Pb(12,"app-jwmodal",10),l.Pb(13,"i",8),l.Wb("click",function(){return r.closeModal("prepcard")}),l.Ob(),l.vc(14,P,1,1,"app-prep-card",11),l.Ob(),l.Pb(15,"app-jwmodal",12),l.vc(16,y,1,2,"app-detail-prep-card",13),l.Ob(),l.Ob(),l.Ob(),l.Ob()),2&e&&(l.tc("margin-top",80,"px"),l.zb(7),l.fc("defaultColDef",r.defaultColDef)("columnDefs",r.columnDefs)("rowData",r.rowData)("rowSelection","single")("pagination",!0)("paginationPageSize",100),l.zb(4),l.fc("ngIf",r.selectedUser),l.zb(3),l.fc("ngIf",r.selectedPrep),l.zb(2),l.fc("ngIf",r.selectedPrep))},directives:[s.a,v.a,c.t,b.a,m.a,g.a],styles:["[_nghost-%COMP%]     .link{text-decoration:none;color:#00f;cursor:pointer}.grid[_ngcontent-%COMP%]{display:inline-block;height:calc(80vh - 10px);max-width:98%;margin-left:10px}"],changeDetection:0}),k)}],U=((D=function e(){t(this,e)}).\u0275mod=l.Ib({type:D}),D.\u0275inj=l.Hb({factory:function(e){return new(e||D)},imports:[[d.f.forChild(O)],d.f]}),D),I=n("zcTp"),N=n("trFs"),M=n("iZEB"),S=n("ShNc"),A=((C=function e(){t(this,e)}).\u0275mod=l.Ib({type:C}),C.\u0275inj=l.Hb({factory:function(e){return new(e||C)},providers:[],imports:[[c.c,U,I.a,N.a,S.a,M.a,o.h,s.c.withComponents([])]]}),C)}}])}();