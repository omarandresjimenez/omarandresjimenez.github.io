(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{SzTg:function(e,t,i){"use strict";i.r(t),i.d(t,"AdminRecipeModule",function(){return M});var r=i("3Pt+"),a=i("ofXK"),n=i("cWTo"),o=i("tyNb"),s=i("fXoL"),c=i("RPu0"),d=i("5eHb");let p=(()=>{class e{constructor(e,t,i,r){this.document=e,this.service=t,this.toast=i,this.cdr=r,this.editRecipe=new s.n}ngOnInit(){this.service.newRecipeAdded$.subscribe(e=>{this.rowData=this.rowData.filter(t=>t.id!==e.id),this.rowData.push(e),this.cdr.markForCheck()})}onDelete(e){confirm("Esta seguro de eliminar esta receta?")&&this.service.deleteRecipe(e).subscribe(t=>{this.toast.success("Receta eliminada!"),this.rowData=this.rowData.filter(t=>t.id!==e),this.editRecipe.emit(null),this.cdr.markForCheck()})}ngOnDestroy(){this.subs&&this.subs.unsubscribe()}onSelectRow(e){var t;const i=null===(t=this.gridApi)||void 0===t?void 0:t.getSelectedRows();this.editRecipe.emit(i[0])}initGridOptions(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!0,resizable:!0,sortable:!0}}prepareGridColumns(){return[{field:"id",hide:!0},{field:"name",headerName:"Receta",width:"400"},{field:"description",headerName:"Descripcion",width:"350"},{field:"",headerName:"",cellRenderer:e=>{const t=this.document.createElement("span");return t.innerHTML='<i class="far fa-trash-alt fa-lg text-danger" ></i>',t.className="link",t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.onDelete(null==e?void 0:e.data.id)}),t},width:"60px",filter:"",floatingFilter:!1}]}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGridOptions(),this.subs=this.service.getRecipes().subscribe(e=>{this.columnDefs=this.prepareGridColumns(),this.rowData=e,this.cdr.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(a.e),s.Kb(c.a),s.Kb(d.c),s.Kb(s.h))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-recipe-list"]],outputs:{editRecipe:"editRecipe"},decls:3,vars:6,consts:[[2,"height","100%","box-sizing","border-box"],["id","recipeGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection","pagination","paginationPageSize","selectionChanged","gridReady"],["recipeGrid",""]],template:function(e,t){1&e&&(s.Pb(0,"div",0),s.Pb(1,"ag-grid-angular",1,2),s.Wb("selectionChanged",function(e){return t.onSelectRow(e)})("gridReady",function(e){return t.onGridReady(e)}),s.Ob(),s.Ob()),2&e&&(s.zb(1),s.fc("defaultColDef",t.defaultColDef)("columnDefs",t.columnDefs)("rowData",t.rowData)("rowSelection","single")("pagination",!0)("paginationPageSize",100))},directives:[n.a],styles:["[_nghost-%COMP%]     .link{text-decoration:none;cursor:pointer}"],changeDetection:0}),e})();var l=i("7pcG"),b=i("Nmv1"),h=i("8SKR"),u=i("jhN1");const g=["*"];let m=(()=>{class e{constructor(){this.isOpened=!1,this.textOpen="Ver detalles",this.textClose="Ocultar detalles"}onToggle(){this.isOpened=!this.isOpened}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-bottom-bar"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Cb("opened",t.isOpened)},inputs:{textOpen:"textOpen",textClose:"textClose"},ngContentSelectors:g,decls:7,vars:2,consts:[[1,"bottom-bar-header",3,"click"],[3,"ngClass"],[1,"headerText"],[1,"bottom-bar-body"],[1,"content-details"]],template:function(e,t){1&e&&(s.ec(),s.Pb(0,"div",0),s.Wb("click",function(){return t.onToggle()}),s.Lb(1,"i",1),s.Pb(2,"span",2),s.wc(3),s.Ob(),s.Ob(),s.Pb(4,"div",3),s.Pb(5,"div",4),s.dc(6),s.Ob(),s.Ob()),2&e&&(s.zb(1),s.fc("ngClass",t.isOpened?"fas fa-chevron-up":"fas fa-chevron-down"),s.zb(2),s.xc(t.isOpened?t.textClose:t.textOpen))},directives:[a.q],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;flex:0 0 40px;transition:flex .5s ease}.opened[_nghost-%COMP%]{flex:0 0 275px}.headerText[_ngcontent-%COMP%]{font-weight:bolder;padding-left:20px}.bottom-bar-header[_ngcontent-%COMP%]{height:40px;padding:5px 20px;display:flex;cursor:pointer;align-items:center;border-top:1px solid #747474;background-color:#a9a9a9}  .opened .bottom-bar-header{border-top:none;border-bottom:1px solid #747474}.bottom-bar-body[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .5s ease}  .opened .bottom-bar-body{height:calc(100% - 40px)}.bottom-bar-trigger[_ngcontent-%COMP%]{font-size:14px;font-weight:400;color:#00f;cursor:pointer;position:relative;padding-left:24px;text-transform:uppercase}.bottom-bar-trigger[_ngcontent-%COMP%]:before{content:"\ue316";font-family:Material Icons;font-size:24px;color:inherit;cursor:inherit;display:inline-block;position:absolute;left:0;top:50%;transform:translateY(-54%)}  .opened .bottom-bar-trigger:before{content:"\ue313"}.content-details[_ngcontent-%COMP%]{height:100%}.content-details-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;padding:10px 20px 5px;height:50px}.content-details-body[_ngcontent-%COMP%]{height:calc(100% - 50px);padding:0 20px 10px}.content-details-heading[_ngcontent-%COMP%]{margin:10px 0 0;font-size:16px;font-weight:500;color:#404040}']}),e})();var f=i("eIxW"),v=i("6ILZ");let P=(()=>{class e{constructor(e,t,i,r,a,n,o,s){this.document=e,this.service=t,this.userService=i,this.prepService=r,this.toast=a,this.modal=n,this.cdr=o,this.sanitizer=s,this.newRecipe=!0,this.recipeData={id:"0",name:"",description:"",imageUrl:"",preparations:[]},this.avatarBgSize="80%",this.imageAvatarFile="",this.imageAvatar="/assets/img/default.png",this.rowPrepData=[],this.recipeToEdit={}}ngOnInit(){this.initGridOptions()}ngOnChanges(){this.recipeToEdit?(this.newRecipe=!1,this.recipeData=Object.assign({},this.recipeToEdit),this.renderAvatar(this.recipeData.imageUrl),this.columnDefs=this.prepareGridPrepColumns(),this.rowPrepData=[],this.cdr.markForCheck(),this.prepService.getPreparationsByRecipe(this.recipeData.id).subscribe(e=>{e.map(e=>{var t,i;this.rowPrepData.push(Object.assign(Object.assign({},e),{userName:e.user?(null===(t=e.user)||void 0===t?void 0:t.name)+" "+(null===(i=e.user)||void 0===i?void 0:i.lastName):""}))}),this.rowPrepData=[...this.rowPrepData],this.cdr.markForCheck()})):(this.rowPrepData=[],this.resetForm())}prepareGridPrepColumns(){return[{field:"id",hide:!0},{field:"name",headerName:"Receta",width:"200"},{field:"description",headerName:"Descripcion",width:"100"},{field:"userName",headerName:"Usuario registro",width:"150"},{field:"active",headerName:"Activo",width:"100",cellRenderer:e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.active)?"Si":"No"}},{field:"",headerName:"",cellRenderer:e=>{const t=this.document.createElement("span");return t.innerHTML='<i class="fas fa-edit" alt="Editar"></i>',t.className="link",t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.onEditPrep(null==e?void 0:e.data)}),t},width:"60px",filter:"",floatingFilter:!1}]}initGridOptions(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!1,resizable:!0,sortable:!0}}onEditPrep(e){this.selectedPrep=e,this.openModal("prepcard"),this.cdr.markForCheck()}openModal(e){this.modal.open(e)}closeModal(e){this.modal.close(e)}onSavePrep(e){this.service.updateAdminPreparation(e.id,e.active).subscribe(t=>{this.rowPrepData=this.rowPrepData.filter(t=>t.id!==e.id),this.rowPrepData.push(e),this.closeModal("prepcard"),this.cdr.markForCheck()})}onDeletePreparation(e){this.service.deletePreparation(e).subscribe(t=>{this.toast.success("Preparaci\xf3n eliminada!"),this.rowPrepData=this.rowPrepData.filter(t=>t.id!==e),this.closeModal("prepcard"),this.cdr.markForCheck()})}onSubmit(){this.newRecipe?this.service.createRecipe(this.recipeData).subscribe(e=>{this.toast.success("Receta creada exitosamente"),this.service.notifyNewRecipe(Object.assign(Object.assign({},this.recipeData),{id:e.id})),this.resetForm()}):this.service.updateRecipe(this.recipeData).subscribe(e=>{this.toast.success("Receta modificada exitosamente"),this.service.notifyNewRecipe(this.recipeData),this.resetForm()})}showAvatarPreview(e){if(-1===["image/jpeg","image/png"].indexOf(e.target.files[0].type))return this.toast.error("Imagen Invalida"),e.target.value="",!1;const t=new FileReader;t.onload=()=>{this.renderAvatar(t.result),this.imageAvatarFile=t.result,this.recipeData.imageUrl=this.imageAvatarFile},t.readAsDataURL(e.target.files[0])}renderAvatar(e){this.imageAvatar=this.sanitizer.bypassSecurityTrustStyle(`url('${e}')`),this.avatarBgSize="cover",this.cdr.markForCheck()}resetForm(e){this.newRecipe=!0,this.imageAvatar=null,this.recipeData={id:"0",name:"",description:"",imageUrl:""},null!=e&&e.form.reset(),this.cdr.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(s.Kb(a.e),s.Kb(c.a),s.Kb(l.a),s.Kb(b.a),s.Kb(d.c),s.Kb(h.a),s.Kb(s.h),s.Kb(u.b))},e.\u0275cmp=s.Eb({type:e,selectors:[["app-admin-recipe-form"]],inputs:{recipeToEdit:"recipeToEdit"},features:[s.xb],decls:44,vars:21,consts:[["autocomplete","off",3,"submit"],["form","ngForm"],[1,"form-group"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text","bg-white"],[1,"fas","fa-utensils"],["name","name","placeholder","Nombre Receta","required","","maxlength","100",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],[1,"fas","fa-font"],["name","summary","placeholder","Descripcion","maxlength","500","rows","5",1,"form-control",3,"ngModel","ngModelChange"],["summary","ngModel"],[1,"user-avatar"],[1,"form-group","photo-upload"],[1,"photo-upload-preview"],[1,"photo-upload-label"],[1,"btn","btn-primary","btn-sm"],["type","file","accept","image/gif, image/jpeg, image/png","name","avatar",3,"change"],[3,"textOpen","textClose"],[2,"height","400px","box-sizing","border-box"],["id","preparationsGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection"],["preparationsGrid",""],["type","hidden","name","id",3,"ngModel","ngModelChange"],["id","ngModel"],[1,"form-group",2,"display","flex"],["type","button",1,"btn","btn-success","btn-lg","btn-block","col-md-5",3,"click"],[1,"fas","fa-plus"],[1,"col-md-2"],["type","submit",1,"btn","btn-success","btn-lg","btn-block","col-md-5",3,"disabled"],[1,"fas","fa-database"],["id","prepcard"],["title","Volver",1,"fas","fa-times-circle","close-button-modal",3,"click"],[3,"preparation","updatePrep","deletePrep"]],template:function(e,t){if(1&e){const e=s.Qb();s.Pb(0,"form",0,1),s.Wb("submit",function(){return t.onSubmit()}),s.Pb(2,"div",2),s.Pb(3,"div",3),s.Pb(4,"div",4),s.Pb(5,"div",5),s.Lb(6,"i",6),s.Ob(),s.Ob(),s.Pb(7,"input",7,8),s.Wb("ngModelChange",function(e){return t.recipeData.name=e}),s.Ob(),s.Ob(),s.Ob(),s.Pb(9,"div",2),s.Pb(10,"div",3),s.Pb(11,"div",4),s.Pb(12,"div",5),s.Lb(13,"i",9),s.Ob(),s.Ob(),s.Pb(14,"textarea",10,11),s.Wb("ngModelChange",function(e){return t.recipeData.description=e}),s.Ob(),s.Ob(),s.Ob(),s.Pb(16,"div",2),s.Pb(17,"div",12),s.Pb(18,"div",13),s.Lb(19,"div",14),s.Pb(20,"label",15),s.Pb(21,"span",16),s.wc(22,"Cargar Imagen"),s.Ob(),s.Pb(23,"input",17),s.Wb("change",function(e){return t.showAvatarPreview(e)}),s.Ob(),s.Ob(),s.Ob(),s.Ob(),s.Ob(),s.Lb(24,"BR"),s.Lb(25,"BR"),s.Pb(26,"app-bottom-bar",18),s.Pb(27,"div",19),s.Lb(28,"ag-grid-angular",20,21),s.Ob(),s.Ob(),s.Lb(30,"br"),s.Pb(31,"input",22,23),s.Wb("ngModelChange",function(e){return t.recipeData.id=e}),s.Ob(),s.Pb(33,"div",24),s.Pb(34,"button",25),s.Wb("click",function(){s.mc(e);const i=s.kc(1);return t.resetForm(i)}),s.Lb(35,"i",26),s.wc(36," Nueva Receta"),s.Ob(),s.Lb(37,"div",27),s.Pb(38,"button",28),s.Lb(39,"i",29),s.wc(40," Guardar"),s.Ob(),s.Ob(),s.Ob(),s.Pb(41,"app-jwmodal",30),s.Pb(42,"i",31),s.Wb("click",function(){return t.closeModal("prepcard")}),s.Ob(),s.Pb(43,"app-prep-card",32),s.Wb("updatePrep",function(e){return t.onSavePrep(e)})("deletePrep",function(e){return t.onDeletePreparation(e)}),s.Ob(),s.Ob()}if(2&e){const e=s.kc(1),i=s.kc(8);s.zb(6),s.Cb("green-icon",i.valid)("red-icon",i.invalid&&i.touched),s.zb(1),s.fc("ngModel",t.recipeData.name),s.zb(6),s.Cb("green-icon",!0),s.zb(1),s.fc("ngModel",t.recipeData.description),s.zb(5),s.tc("background-size",t.avatarBgSize)("background-image",t.imageAvatar),s.zb(7),s.fc("textOpen","Ver Preparaciones")("textClose","Ocultar Preparaciones"),s.zb(2),s.fc("defaultColDef",t.defaultColDef)("columnDefs",t.columnDefs)("rowData",t.rowPrepData)("rowSelection","single"),s.zb(3),s.fc("ngModel",t.recipeData.id),s.zb(7),s.fc("disabled",e.invalid),s.zb(5),s.fc("preparation",t.selectedPrep)}},directives:[r.C,r.o,r.p,r.c,r.y,r.i,r.n,r.q,m,n.a,f.a,v.a],styles:[".error[_ngcontent-%COMP%]{color:red;font-size:small}.photo-upload[_ngcontent-%COMP%]{max-width:150px}@media screen and (max-width:640px){.photo-upload[_ngcontent-%COMP%]{margin-right:10px}}@media screen and (max-width:460px){.photo-upload[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}}.photo-upload[_ngcontent-%COMP%]   .photo-upload-preview[_ngcontent-%COMP%]{width:150px;height:150px;background-color:#e3e3e3;border:1px solid #9ba2ac;margin-bottom:10px;background-image:url(/assets/img/default.png);background-repeat:no-repeat;background-position:50%}.photo-upload[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.photo-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;width:100%}.photo-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]     .link{text-decoration:none;cursor:pointer}"],changeDetection:0}),e})();const O=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){console.log("init admin")}onRecipeSelected(e){this.recipe=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Eb({type:e,selectors:[["app-admin-recipe"]],decls:9,vars:7,consts:[[1,"jumbtron"],[1,"display-4","text-center"],[1,"row","grid"],[1,"col-md-6"],[3,"editRecipe"],[1,"col-md-5"],[3,"recipeToEdit"]],template:function(e,t){1&e&&(s.Pb(0,"div",0),s.Pb(1,"h1",1),s.wc(2,"Administracion de recetas"),s.Ob(),s.Lb(3,"hr"),s.Pb(4,"div",2),s.Pb(5,"div",3),s.Pb(6,"app-recipe-list",4),s.Wb("editRecipe",function(e){return t.onRecipeSelected(e)}),s.Ob(),s.Ob(),s.Pb(7,"div",5),s.Lb(8,"app-admin-recipe-form",6),s.Ob(),s.Ob(),s.Ob()),2&e&&(s.tc("margin-top",80,"px"),s.zb(5),s.tc("margin-left",20,"px"),s.zb(2),s.tc("margin-left",20,"px"),s.zb(1),s.fc("recipeToEdit",t.recipe))},directives:[p,P],styles:[".grid[_ngcontent-%COMP%]{height:calc(70vh - 10px)}"]}),e})()}];let w=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[o.f.forChild(O)],o.f]}),e})();var x=i("ADsi");let C=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},imports:[[a.c]]}),e})();var D=i("ShNc");let M=(()=>{class e{}return e.\u0275mod=s.Ib({type:e}),e.\u0275inj=s.Hb({factory:function(t){return new(t||e)},providers:[],imports:[[a.c,w,r.h,x.a,D.a,C,n.c.withComponents([])]]}),e})()}}]);