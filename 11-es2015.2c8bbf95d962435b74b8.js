(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{UYvW:function(e,r,t){"use strict";t.r(r),t.d(r,"PreparationListAdminModule",function(){return O});var i=t("3Pt+"),a=t("ofXK"),s=t("cWTo"),o=t("tyNb"),n=t("fXoL"),c=t("RPu0"),d=t("7pcG"),l=t("5eHb"),p=t("8SKR"),u=t("eIxW"),h=t("3KhC"),f=t("6ILZ"),m=t("lOxl");function b(e,r){if(1&e){const e=n.Qb();n.Pb(0,"app-user-card",14),n.Wb("updateUser",function(r){return n.mc(e),n.ac().onSaveUser(r)})("deleteUser",function(r){return n.mc(e),n.ac().onDeleteUser(r)}),n.Ob()}if(2&e){const e=n.ac();n.fc("user",e.selectedUser)}}function v(e,r){if(1&e){const e=n.Qb();n.Pb(0,"app-prep-card",15),n.Wb("updatePrep",function(r){return n.mc(e),n.ac().onSavePrep(r)})("deletePrep",function(r){return n.mc(e),n.ac().onDelete(r)}),n.Ob()}if(2&e){const e=n.ac();n.fc("preparation",e.selectedPrep)}}function P(e,r){if(1&e){const e=n.Qb();n.Pb(0,"app-detail-prep-card",16),n.Wb("closeButton",function(){return n.mc(e),n.ac().closeModal("viewcard")}),n.Ob()}if(2&e){const e=n.ac();n.fc("prep",e.selectedPrep)("userId",e.userId)}}const g=[{path:"",component:(()=>{class e{constructor(e,r,t,i,a,s){this.document=e,this.service=r,this.serviceUser=t,this.toast=i,this.modal=a,this.cdr=s,this.rowData=[]}ngOnInit(){}ngOnDestroy(){this.subs&&this.subs.unsubscribe()}initGridOptions(){this.defaultColDef={width:170,editable:!1,filter:"agTextColumnFilter",floatingFilter:!0,resizable:!0,sortable:!0}}prepareGridColumns(){return[{field:"",headerName:"",cellRenderer:e=>{const r=this.document.createElement("span");return r.innerHTML='<i class="fas fa-eye" alt="Ver Preparacion"></i>',r.className="link",r.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),this.onViewPrep(null==e?void 0:e.data)}),r},width:"60px",filter:"",floatingFilter:!1},{field:"",headerName:"",cellRenderer:e=>{const r=this.document.createElement("span");return r.innerHTML='<i class="fas fa-edit" alt="Editar Preparacion"></i>',r.className="link",r.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),this.onEditPrep(null==e?void 0:e.data)}),r},width:"60px",filter:"",floatingFilter:!1},{field:"id",hide:!0},{field:"recipeName",headerName:"Receta",width:"220"},{field:"name",headerName:"Nombre Preparacion",width:"220"},{field:"description",headerName:"Descripci\xf3n",width:"450"},{field:"",headerName:"Usuario Registro",cellRenderer:e=>{var r,t,i,a;const s=this.document.createElement("span");return s.innerHTML=(null===(t=null===(r=e.data)||void 0===r?void 0:r.user)||void 0===t?void 0:t.name)+" "+(null===(a=null===(i=e.data)||void 0===i?void 0:i.user)||void 0===a?void 0:a.lastName),s.className="link",s.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation(),this.onClickUser(null==e?void 0:e.data.user)}),s},width:"200px"},{field:"carrierCommunity",headerName:"Comunidad portadora",width:"200"},{field:"preparationType",headerName:"Tipo preparaci\xf3n",width:"200"},{field:"authorName",headerName:"Autor preparaci\xf3n",width:"200"}]}onSelectRow(e){var r,t,i;const a=null===(r=this.gridApi)||void 0===r?void 0:r.getSelectedRows();this.userId=null===(i=null===(t=a[0])||void 0===t?void 0:t.user)||void 0===i?void 0:i.id,console.log(a)}onDeletePrep(e){confirm("ESta seguro de eliminar esta Preparaci\xf3n")&&this.service.deletePreparation(e).subscribe(r=>{this.toast.success("Preparaci\xf3n eliminada"),this.rowData=this.rowData.filter(r=>r.id!==e),this.closeModal("prepcard"),this.cdr.markForCheck()})}onEditPrep(e){this.selectedPrep=e,this.openModal("prepcard"),this.cdr.markForCheck()}onViewPrep(e){this.selectedPrep=e,this.openModal("viewcard"),this.cdr.markForCheck()}onClickUser(e){this.serviceUser.getUser(e.id).subscribe(e=>{this.selectedUser=e,this.openModal("usercard"),this.cdr.markForCheck()})}onDeleteUser(e){this.serviceUser.deleteUser(e).subscribe(r=>{this.toast.success("Usuario eliminado"),this.rowData=this.rowData.filter(r=>r.user.id!==e),this.closeModal("usercard"),this.cdr.markForCheck()})}onDelete(e){this.service.deletePreparation(e).subscribe(r=>{this.toast.success("Preparaci\xf3n eliminada!"),this.rowData=this.rowData.filter(r=>r.id!==e),this.closeModal("prepcard"),this.cdr.markForCheck()})}onSaveUser(e){this.serviceUser.updateUserAdmin(e.id,e.role,e.active).subscribe(e=>{this.toast.success("Usuario actualizado"),this.closeModal("usercard"),this.cdr.markForCheck()})}onSavePrep(e){e.active&&this.service.updateAdminPreparation(e.id,e.active).subscribe(r=>{this.toast.success("Preparaci\xf3n Activada"),this.rowData=this.rowData.filter(r=>r.id!==e.id),this.closeModal("prepcard"),this.cdr.markForCheck()})}onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGridOptions(),this.columnDefs=this.prepareGridColumns(),this.subs=this.service.getInactivePreparations().subscribe(e=>{e.map(e=>{var r,t,i;this.rowData.push(Object.assign(Object.assign({},e),{authorName:e.author?(null===(r=e.author)||void 0===r?void 0:r.name)+" "+(null===(t=e.author)||void 0===t?void 0:t.lastName):"",recipeName:null===(i=e.recipe)||void 0===i?void 0:i.name}))}),this.rowData=[...this.rowData],this.cdr.markForCheck()})}openModal(e){this.modal.open(e)}closeModal(e){this.modal.close(e)}}return e.\u0275fac=function(r){return new(r||e)(n.Kb(a.e),n.Kb(c.a),n.Kb(d.a),n.Kb(l.c),n.Kb(p.a),n.Kb(n.h))},e.\u0275cmp=n.Eb({type:e,selectors:[["ng-component"]],decls:17,vars:11,consts:[[1,"jumbtron"],[1,"display-4","text-center"],[1,"row"],[1,"col-md-12","grid"],[2,"height","100%","box-sizing","border-box"],["id","userGrid",1,"ag-theme-alpine",2,"width","100%","height","100%",3,"defaultColDef","columnDefs","rowData","rowSelection","pagination","paginationPageSize","selectionChanged","gridReady"],["userGrid",""],["id","usercard"],["title","Volver",1,"fas","fa-times-circle","close-button-modal",3,"click"],[3,"user","updateUser","deleteUser",4,"ngIf"],["id","prepcard"],[3,"preparation","updatePrep","deletePrep",4,"ngIf"],["id","viewcard"],[3,"prep","userId","closeButton",4,"ngIf"],[3,"user","updateUser","deleteUser"],[3,"preparation","updatePrep","deletePrep"],[3,"prep","userId","closeButton"]],template:function(e,r){1&e&&(n.Pb(0,"div",0),n.Pb(1,"h1",1),n.wc(2,"Administracion Preparaciones Inactivas"),n.Ob(),n.Lb(3,"hr"),n.Pb(4,"div",2),n.Pb(5,"div",3),n.Pb(6,"div",4),n.Pb(7,"ag-grid-angular",5,6),n.Wb("selectionChanged",function(e){return r.onSelectRow(e)})("gridReady",function(e){return r.onGridReady(e)}),n.Ob(),n.Ob(),n.Pb(9,"app-jwmodal",7),n.Pb(10,"i",8),n.Wb("click",function(){return r.closeModal("usercard")}),n.Ob(),n.vc(11,b,1,1,"app-user-card",9),n.Ob(),n.Pb(12,"app-jwmodal",10),n.Pb(13,"i",8),n.Wb("click",function(){return r.closeModal("prepcard")}),n.Ob(),n.vc(14,v,1,1,"app-prep-card",11),n.Ob(),n.Pb(15,"app-jwmodal",12),n.vc(16,P,1,2,"app-detail-prep-card",13),n.Ob(),n.Ob(),n.Ob(),n.Ob()),2&e&&(n.tc("margin-top",80,"px"),n.zb(7),n.fc("defaultColDef",r.defaultColDef)("columnDefs",r.columnDefs)("rowData",r.rowData)("rowSelection","single")("pagination",!0)("paginationPageSize",100),n.zb(4),n.fc("ngIf",r.selectedUser),n.zb(3),n.fc("ngIf",r.selectedPrep),n.zb(2),n.fc("ngIf",r.selectedPrep))},directives:[s.a,u.a,a.t,h.a,f.a,m.a],styles:["[_nghost-%COMP%]     .link{text-decoration:none;color:#00f;cursor:pointer}.grid[_ngcontent-%COMP%]{display:inline-block;height:calc(80vh - 10px);max-width:98%;margin-left:10px}"],changeDetection:0}),e})()}];let w=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(r){return new(r||e)},imports:[[o.f.forChild(g)],o.f]}),e})();var D=t("zcTp"),k=t("trFs"),C=t("iZEB"),U=t("ShNc");let O=(()=>{class e{}return e.\u0275mod=n.Ib({type:e}),e.\u0275inj=n.Hb({factory:function(r){return new(r||e)},providers:[],imports:[[a.c,w,D.a,k.a,U.a,C.a,i.h,s.c.withComponents([])]]}),e})()}}]);