"use strict";(self.webpackChunkteck=self.webpackChunkteck||[]).push([[893],{43893:function(Bi,V,s){s.r(V),s.d(V,{HoistRopesModule:function(){return wi}});var f=s(43144),v=s(15671),u=s(69808),vt=s(42155),K=s(9224),L=s(67322),j=s(85899),F=s(74107),h=s(88279),E=s(29772),k=s(34594),A=s(86087),H=s(465),Z=s(30325),w=s(60136),I=s(57777),T=s(7625),G=s(92198),g=s(46940),X=s(21347),U=s(19855),R=s(89255),x=s(35442),t=s(65542),y=s(94720),C=s(77093),Ct=s(52012),B=s(42585),tt=s(87545),Q=s(40537),M=s(591),bt=[{value:x.v.MONTH,label:"Month"},{value:x.v.QUARTER,label:"Quarter"},{value:x.v.YEAR,label:"Year"},{value:x.v.CUSTOM,label:"Custom"}],b="bcm",m=s(57676),yt=s(15439),O=s.n(yt),Tt=s(21086),S=s(22451),Dt=s(27221),xt=s(40520),et=m.mb.hoistRope,it=m.mb.drillBits,Pt=m.mb.drillBitReliability,Ot=m.mb.drillBitFilters,N=function(){var i=function(){function a(n){(0,v.Z)(this,a),this.http=n}return(0,f.Z)(a,[{key:"getHoistRopes",value:function(e,l,o){return this.http.get((0,m.FP)(e,et),o?{params:{chosenShovel:o,chosenPeriod:l}}:{params:{chosenPeriod:l}})}},{key:"getDrillBitReliability",value:function(e,l){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return this.http.get((0,m.FP)(e,Pt),{params:{dateFrom:g.Ov.transformToMineTimeZone(e,l.dateFrom),dateTo:g.Ov.transformToMineTimeZone(e,l.dateTo),serialNumberId:o,equipmentId:r}})}},{key:"getDillBitFilterValues",value:function(e,l){return this.http.get((0,m.FP)(e,Ot),{params:{dateFrom:g.Ov.transformToMineTimeZone(e,l.dateFrom),dateTo:g.Ov.transformToMineTimeZone(e,l.dateTo)}}).pipe((0,Dt.K)(function(){return(0,Tt.of)({serialNumbers:null,equipments:null})}))}},{key:"getDrillBits",value:function(e,l){var o=this.getShiftDates(l,e),r=o.from,c=o.to;return this.http.get((0,m.FP)(e,it),{params:{dateFrom:r,dateTo:c}})}},{key:"getShiftDates",value:function(e,l){return{from:O().utc(e.dateFrom).tz((0,m.FX)(l)).format(S.a.DRILL_BIT_SHIFT),to:O().utc(e.dateTo).tz((0,m.FX)(l)).format(S.a.DRILL_BIT_SHIFT)}}},{key:"getDrillBitChart",value:function(e,l,o,r){var c=this.getShiftDates(l,e),d=c.from,p=c.to;return this.http.get("".concat((0,m.FP)(e,it)).concat(o,"/"),{params:{equipmentId:r,dateFrom:d,dateTo:p}})}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.LFG(xt.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i}(),nt=s(82768),St=s(19889),kt=s(13761),at=s(97202),J=s(17489),Mt=S.a.DEFAULT,At=["bitState","drillId","equipmentId","bitType","totalDrillingCost","penetrationRate","holesDrilled","drilled","dateInstalled"],Zt=[{property:"bitState",name:"",class:function(a){switch(!0){case a.bitState:return"point--red";case!(0,J.isNull)(a.bitState):return"point--green";default:return"point--grey"}},cell:function(a){return"".concat(a.bitState)}},{property:"drillId",name:"Drillbit Serial Number",class:function(){return"cell-content"},cell:function(a){return"".concat(a.drillId)}},{property:"equipmentId",name:"Equip. ID",class:function(){return"cell-content"},cell:function(a){return a.equipmentId&&"".concat(a.equipmentId)}},{property:"bitType",name:"Bit Type",class:function(){return"cell-content"},cell:function(a){return"".concat(a.bitType)}},{property:"totalDrillingCost",name:"TDC",class:function(){return"cell-content"},cell:function(a){return"".concat(a.totalDrillingCost)},units:{lco:", $"}},{property:"penetrationRate",name:"Pen. Rate",class:function(){return"cell-content"},cell:function(a){return"".concat(a.penetrationRate)},units:{lco:", m/hr"}},{property:"holesDrilled",name:"Holes Drilled",class:function(){return"cell-content"},cell:function(a){return"".concat(a.holesDrilled)}},{property:"drilled",name:"Drilled",class:function(){return"cell-content"},cell:function(a){return"".concat(a.metersDrilled)},units:{lco:", m"}},{property:"dateInstalled",name:"Date installed",class:function(){return"cell-content"},cell:function(a,n){return"".concat(g.Ov.transformToMineUTCTimeZone(n,a.dateInstalled,Mt))}}],wt=s(37143),P=s(23322),Y=s(71654);function It(i,a){if(1&i&&(t.TgZ(0,"mat-header-cell"),t._uU(1),t.qZA()),2&i){var n=t.oxw().$implicit,e=t.oxw();t.xp6(1),t.AsE("",n.name,"",e.getUnits(n),"")}}function Rt(i,a){if(1&i&&(t.TgZ(0,"span",10,11),t._uU(2),t.ALo(3,"detectNullValue"),t.qZA()),2&i){var n=t.MAs(1),e=t.oxw().$implicit,l=t.oxw().$implicit,o=t.oxw();t.Q6J("ngClass",l.class())("matTooltip",n.innerText)("matTooltipPosition","above"),t.xp6(2),t.hij(" ",t.lcZ(3,4,l.cell(e,o.mineSite))," ")}}function Bt(i,a){if(1&i&&t._UZ(0,"span",12),2&i){var n=t.oxw().$implicit,e=t.oxw().$implicit,l=t.oxw();t.Q6J("ngClass",e.class(n))("matTooltip",l.getTooltip(n))("matTooltipPosition","above")}}function Nt(i,a){if(1&i&&(t.TgZ(0,"mat-cell"),t.YNc(1,Rt,4,6,"span",8),t.YNc(2,Bt,1,3,"span",9),t.qZA()),2&i){var n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","bitState"!==n.property),t.xp6(1),t.Q6J("ngIf","bitState"===n.property)}}function Lt(i,a){1&i&&(t.ynx(0,5),t.YNc(1,It,2,2,"mat-header-cell",6),t.YNc(2,Nt,3,2,"mat-cell",7),t.BQk()),2&i&&t.Q6J("matColumnDef",a.$implicit.property)}function Ft(i,a){1&i&&t._UZ(0,"mat-header-row")}var Et=function(a){return{"row-selected":a}};function Ht(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"mat-row",13),t.NdJ("click",function(){var c=t.CHM(n).$implicit;return t.oxw().drillSelected.emit(c)}),t.qZA()}if(2&i){var e=a.$implicit,l=t.oxw();t.Q6J("ngClass",t.VKq(1,Et,l.isSelected(e)))}}var Ut=function(){var i=function(){function a(n){(0,v.Z)(this,a),this.mineStateService=n,this.drillSelected=new t.vpe}return(0,f.Z)(a,[{key:"ngOnInit",value:function(){this.tableColumns=Zt,this.displayedColumns=At,this.dataSource=new h.by(this.tableData),this.mineSite=this.mineStateService.getSelectedMineArea()}},{key:"ngOnChanges",value:function(e){e.tableData&&(this.dataSource=new h.by(e.tableData.currentValue))}},{key:"getUnits",value:function(e){return e.units&&e.units[this.mineSite]||""}},{key:"getTooltip",value:function(e){var l=e.bitState;switch(!0){case l:return"Time to replace";case!(0,J.isNull)(l):return"Normal";default:return"No data"}}},{key:"isSelected",value:function(e){return e.drillId===this.selectedRow.drillId&&e.equipmentId===this.selectedRow.equipmentId}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.Y36(y.Hj))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-drill-bit-list"]],inputs:{tableData:"tableData",selectedRow:"selectedRow"},outputs:{drillSelected:"drillSelected"},features:[t.TTD],decls:5,vars:5,consts:[[1,"table"],[1,"teck-basic-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"ngClass","click",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],[4,"matHeaderCellDef"],[4,"matCellDef"],["daboIsOutOfBound","",3,"ngClass","matTooltip","matTooltipPosition",4,"ngIf"],[3,"ngClass","matTooltip","matTooltipPosition",4,"ngIf"],["daboIsOutOfBound","",3,"ngClass","matTooltip","matTooltipPosition"],["tooltipContent","innerText"],[3,"ngClass","matTooltip","matTooltipPosition"],[3,"ngClass","click"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"mat-table",1),t.YNc(2,Lt,3,1,"ng-container",2),t.YNc(3,Ft,1,0,"mat-header-row",3),t.YNc(4,Ht,1,3,"mat-row",4),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.tableColumns),t.xp6(1),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns))},directives:[h.BZ,u.sg,h.w1,h.fO,h.ge,h.Dz,h.ev,u.O5,wt.J,u.mk,P.oO,E.gM,h.as,h.XQ,h.nj,h.Gk],pipes:[Y.R],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{max-width:260px}.table-row[_ngcontent-%COMP%]:nth-child(even){background-color:#f6f7fb99}.table-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}.table-row[_ngcontent-%COMP%]:hover{background-color:#f2f8ff}.teck-basic-table[_ngcontent-%COMP%]{min-width:540px}.teck-basic-table[_ngcontent-%COMP%]   .cdk-column-bitState[_ngcontent-%COMP%]{max-width:20px}.teck-basic-table[_ngcontent-%COMP%]   .cdk-column-drillId[_ngcontent-%COMP%]{min-width:165px}.teck-basic-table[_ngcontent-%COMP%]   .cdk-column-dateInstalled[_ngcontent-%COMP%]{max-width:100px;min-width:100px}.teck-basic-table[_ngcontent-%COMP%]   .cdk-row[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .cdk-header-row[_ngcontent-%COMP%]{border:none}.teck-basic-table[_ngcontent-%COMP%]   .cdk-header-row[_ngcontent-%COMP%]{min-height:24px;background-color:#f6f7fb;box-shadow:none}.teck-basic-table[_ngcontent-%COMP%]   .cdk-row[_ngcontent-%COMP%]{min-height:28px;height:auto}.teck-basic-table[_ngcontent-%COMP%]   .cdk-row.row-selected[_ngcontent-%COMP%]{background-color:#1f8ff724}.teck-basic-table[_ngcontent-%COMP%]   .cdk-header-cell[_ngcontent-%COMP%]{color:#030f2980;background-color:transparent;font-weight:400}.teck-basic-table[_ngcontent-%COMP%]   .cdk-cell[_ngcontent-%COMP%]{text-align:center;cursor:pointer}.teck-basic-table[_ngcontent-%COMP%]   .cdk-cell[_ngcontent-%COMP%]   .cell-content[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.teck-basic-table[_ngcontent-%COMP%]   .cdk-cell[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .cdk-header-cell[_ngcontent-%COMP%]{display:flex;justify-content:center}.teck-basic-table[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--grey[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--green[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--red[_ngcontent-%COMP%]{position:relative;width:8px;height:8px;border-radius:50%}.teck-basic-table[_ngcontent-%COMP%]   .point--red[_ngcontent-%COMP%]{background-color:#f54d4a}.teck-basic-table[_ngcontent-%COMP%]   .point--green[_ngcontent-%COMP%]{background-color:#72cd5c}.teck-basic-table[_ngcontent-%COMP%]   .point--grey[_ngcontent-%COMP%]{background-color:gray}"]}),i}(),$=s(97685),D=s(23178);function Qt(i,a){1&i&&(t.TgZ(0,"div",3),t._UZ(1,"div",4),t.TgZ(2,"p"),t._uU(3,"There are no data to show"),t.qZA()())}var Jt=function(a){return{"no-data-container":a}},Yt=S.a.DEFAULT,$t=function(){var i=function(){function a(n){(0,v.Z)(this,a),this.detectNullValuePipe=n,this.noData=!1}return(0,f.Z)(a,[{key:"ngOnChanges",value:function(e){!e.chartData||(this.charts?(this.chart=this.getChart(this),this.noData=!1):this.noData=!0)}},{key:"charts",get:function(){var e,l;return null===(l=null===(e=this.chartData)||void 0===e?void 0:e.charts)||void 0===l?void 0:l.chartTDC}},{key:"detectNull",value:function(e){return this.detectNullValuePipe.transform(e)}},{key:"getTooltip",value:function(e,l){return"Total Drilling cost"===e.name?"\n      TDC: <b>$ ".concat(l.y,"</b><br/>\n      Drill: ").concat(this.selectedRow.drillId," [").concat(this.detectNull(this.selectedRow.bitType),"]<br/>\n      Equip. ID: ").concat(this.detectNull(l.equipmentId),"<br/>\n      Shift: ").concat(this.transformDate(l.shift),"<br/>\n      Holes drilled: ").concat(this.detectNull(l.holesDrilled),"<br/>\n      Drilled depth: ").concat(this.detectNull(l.metersDrilled)," m<br/>\n      Avg. ROP: ").concat(this.detectNull(l.avgRop)," m/hr<br/>\n      Avg. BI: ").concat(this.detectNull(l.avgBi),"<br/>\n      Avg. WOB: ").concat(this.detectNull(l.avgWob)," kn\n      "):"Penetration Rate"===e.name?"Pen. Rate: <b>".concat(this.detectNull(l.y)," m/hr</b>"):"Blastability"===e.name?"Blastability: <b>".concat(this.detectNull(l.y)," BI</b>"):void 0}},{key:"transformDate",value:function(e){if(e){var l=e.split(" "),o=(0,$.Z)(l,2),c=o[1];return"".concat(g.Ov.dateFormatter(o[0],Yt)," ").concat(c)}return this.detectNull(e)}},{key:"getBlastabilityData",value:function(){return this.charts.lines.totalDrillingCost.map(function(e){return{x:e.x,y:e.avgBi||null}})}},{key:"getChart",value:function(e){return new D.kL({time:{useUTC:!0},chart:{height:480,plotBorderColor:"#71818e",plotBorderWidth:1,zoomType:"xy"},title:{style:{color:"#586B7A",fontWeight:"500",fontSize:"12px"},text:'\n          <span style="color: #7fb1dc;">Chart:</span>\n          '.concat(this.selectedRow.drillId," [").concat(this.detectNull(this.selectedRow.bitType),"] Total Drilling Cost (TDC)")},xAxis:[{title:{text:"Meters drilled"},lineColor:"#71818e",minPadding:0,maxPadding:0,startOnTick:!0,endOnTick:!0,allowDecimals:!1,labels:{formatter:function(){return this.value.toString()}}}],yAxis:[{title:{text:"TDC, $/m"}},{visible:!1,minRange:.5},{title:{text:"Blastability"},opposite:!0}],plotOptions:{series:{states:{inactive:{enabled:!1}},cursor:"pointer"},scatter:{stickyTracking:!0,marker:{symbol:"circle"},events:{legendItemClick:function(o){return o.preventDefault()}}},area:{stickyTracking:!1,marker:{enabled:!1},events:{legendItemClick:function(o){return o.preventDefault()}},states:{hover:{linkOpacity:0,lineWidthPlus:0,lineWidth:0}}}},tooltip:{useHTML:!0,style:{fontFamily:'"Rubik", "dabaha", sans-serif'},formatter:function(){return e.getTooltip(this.series,this.point)}},series:[{type:"area",name:"Blastability",fillOpacity:1,data:this.getBlastabilityData(),yAxis:2,xAxis:0,color:"#D8EDFF",lineWidth:0},{type:"scatter",name:"Penetration Rate",data:this.charts.lines.penetrationRate,yAxis:1,xAxis:0,color:"#E134E4"},{type:"scatter",name:"Total Drilling cost",data:this.charts.lines.totalDrillingCost,yAxis:0,xAxis:0,color:"#0165BD"}],credits:{enabled:!1},legend:{align:"center",symbolRadius:0,itemMarginTop:0,itemStyle:{fontWeight:"normal"}}})}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.Y36(Y.R))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-drill-bit-chart"]],inputs:{chartData:"chartData",selectedRow:"selectedRow"},features:[t._Bn([Y.R]),t.TTD],decls:3,vars:6,consts:[[1,"chart-container",3,"ngClass"],["class","no-data",4,"ngIf"],[3,"chart","hidden"],[1,"no-data"],[1,"icon"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0),t.YNc(1,Qt,4,0,"div",1),t._UZ(2,"div",2),t.qZA()),2&n&&(t.Q6J("ngClass",t.VKq(4,Jt,e.noData)),t.xp6(1),t.Q6J("ngIf",e.noData),t.xp6(1),t.Q6J("chart",e.chart)("hidden",e.noData))},directives:[u.mk,P.oO,u.O5,D.Dm],styles:[".chart-container[_ngcontent-%COMP%]{display:block}"]}),i}(),W=s(57491);function Wt(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"dabo-time-ranges-switcher",10),t.NdJ("periodSelected",function(o){return t.CHM(n),t.oxw().onTimePeriodSelection(o)}),t.ALo(1,"async"),t.qZA()}if(2&i){var e=t.oxw();t.Q6J("disabled",!1)("resetPeriodValue",t.lcZ(1,6,e.timePeriodRange$))("mineSite",e.mine)("selectedPeriodChanged",e.timePeriodType)("minDate",e.minDate)("isCurrentMonthDefault",!0)}}function qt(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"dabo-time-ranges-datepicker",11),t.NdJ("selectedCustomDates",function(o){return t.CHM(n),t.oxw().getSelectedCustomDates(o)}),t.ALo(1,"async"),t.qZA()}if(2&i){var e=t.oxw();t.Q6J("minDate",e.minDate)("customDatesToReset",t.lcZ(1,2,e.timePeriodRange$))}}function zt(i,a){if(1&i&&t._UZ(0,"dabo-drill-bit-chart",20),2&i){var n=a.ngIf,e=t.oxw(3);t.Q6J("chartData",n)("selectedRow",e.selectedRow)}}var Vt=function(){return[5,10,25,50]};function Kt(i,a){if(1&i){var n=t.EpF();t.ynx(0),t.TgZ(1,"div",14)(2,"div",15)(3,"dabo-drill-bit-list",16),t.NdJ("drillSelected",function(r){return t.CHM(n),t.oxw(2).drillSelected(r)}),t.qZA()(),t.TgZ(4,"mat-paginator",17),t.NdJ("page",function(){return t.CHM(n),t.oxw(2).updateDisplayTableData()}),t.qZA()(),t.TgZ(5,"div",18),t.YNc(6,zt,1,2,"dabo-drill-bit-chart",19),t.ALo(7,"async"),t.qZA(),t.BQk()}if(2&i){var e=t.oxw(2),l=t.MAs(9);t.xp6(3),t.Q6J("tableData",e.displayTableData)("selectedRow",e.selectedRow),t.xp6(1),t.Q6J("length",e.tableData.length)("pageSizeOptions",t.DdM(9,Vt))("pageSize",e.defaultPageSize),t.xp6(2),t.Q6J("ngIf",!e.isLoading&&t.lcZ(7,7,e.chartData$))("ngIfElse",l)}}function jt(i,a){if(1&i&&(t.TgZ(0,"div",12),t.YNc(1,Kt,8,10,"ng-container",13),t.qZA()),2&i){var n=t.oxw(),e=t.MAs(9);t.xp6(1),t.Q6J("ngIf",n.tableData)("ngIfElse",e)}}function Gt(i,a){1&i&&(t.TgZ(0,"div",21),t._UZ(1,"div",22),t.qZA())}function Xt(i,a){1&i&&(t.TgZ(0,"div",23),t._UZ(1,"dabo-no-data-container"),t.qZA())}var te=x.v.MONTH,ee=function(){var i=function(a){(0,w.Z)(e,a);var n=(0,I.Z)(e);function e(l,o,r,c){var d;return(0,v.Z)(this,e),(d=n.call(this)).dashboardService=l,d.mineStateService=o,d.timePeriodService=r,d.cdr=c,d.defaultPageSize=10,d.isLoading=!1,d.isNoData=!1,d.event$=new M.X(null),d.timePeriodEnum=x.v,d.timePeriodType=te,d.timePeriodOptions=bt,d.timePeriodRange$=new M.X(null),d.chartData$=d.event$.pipe((0,tt.w)(function(p){return d.dashboardService.getDrillBitChart(d.mineStateService.getSelectedMineArea(),d.timePeriodRange$.getValue(),null==p?void 0:p.drillId,null==p?void 0:p.equipmentId).pipe((0,Q.x)(function(){d.isLoading=!1,d.cdr.detectChanges()}))})),d}return(0,f.Z)(e,[{key:"mineSite",set:function(o){this.mine=o,this.isNoData=!1}},{key:"ngOnInit",value:function(){var o=this;this.minDate=O().tz("2019-01-01",(0,m.FX)(this.mine)),this.timePeriodRange$.pipe((0,G.h)(function(r){return null!==r}),(0,T.R)(this.destroy$)).subscribe(function(r){o.tableData=null,o.getDrillBits(o.mine,r)}),this.timePeriodRange$.next(this.timePeriodService.getTimePeriod((0,m.XD)(this.mine),this.timePeriodType,this.mine))}},{key:"getDrillBits",value:function(o,r){var c=this;this.dashboardService.getDrillBits(o,r).pipe((0,T.R)(this.destroy$)).subscribe(function(d){Object.keys(d).length?(c.tableData=d,c.displayTableData=c.tableData.slice(0,c.defaultPageSize),c.selectedRow=d[0],c.event$.next(d[0]),c.isNoData=!1):c.isNoData=!0},function(){c.isNoData=!0},function(){c.cdr.detectChanges()})}},{key:"drillSelected",value:function(o){this.selectedRow=o,this.event$.next(o),this.isLoading=!0}},{key:"onTimePeriodTypeChange",value:function(o){this.timePeriodType=o,this.timePeriodRange$.next(this.timePeriodService.getTimePeriod((0,m.XD)(this.mine),this.timePeriodType,this.mine)),this.cdr.markForCheck()}},{key:"onTimePeriodSelection",value:function(o){this.timePeriodRange$.next(Object.assign({},o.dates)),this.cdr.markForCheck()}},{key:"getSelectedCustomDates",value:function(o){this.timePeriodRange$.next(o),this.cdr.markForCheck()}},{key:"updateDisplayTableData",value:function(){if(this.paginator){var r=this.paginator.pageSize,c=r*this.paginator.pageIndex;this.displayTableData=this.tableData.slice(c,c+r)}}}]),e}(g.eO);return i.\u0275fac=function(n){return new(n||i)(t.Y36(N),t.Y36(y.Hj),t.Y36(y.mb),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-drill-bit"]],viewQuery:function(n,e){var l;1&n&&t.Gf(A.NW,5),2&n&&t.iGM(l=t.CRH())&&(e.paginator=l.first)},inputs:{mineSite:"mineSite"},features:[t._Bn([{provide:B.Hn,useValue:{scope:"date",alias:"dateTranslation"}},{provide:A.ye,useClass:y.ss}]),t.qOj],decls:12,vars:10,consts:[[1,"drill-bit"],[3,"widgetTitle","widgetIcon"],["widgetHeaderAdditionalContent","",1,"drill-bit__filter"],[1,"drill-bit__filter-separator"],[1,"drill-bit__filter-dropdown",3,"disabled","labelType","selectedPeriodType","periodDropdownOptions","timePeriodChange"],["class","drill-bit__filter-switcher",3,"disabled","resetPeriodValue","mineSite","selectedPeriodChanged","minDate","isCurrentMonthDefault","periodSelected",4,"ngIf"],["class","drill-bit__filter-datepicker",3,"minDate","customDatesToReset","selectedCustomDates",4,"ngIf"],["widgetBody","","fxLayout","row","fxLayoutGap","20px",4,"ngIf","ngIfElse"],["loading",""],["noDataContainer",""],[1,"drill-bit__filter-switcher",3,"disabled","resetPeriodValue","mineSite","selectedPeriodChanged","minDate","isCurrentMonthDefault","periodSelected"],[1,"drill-bit__filter-datepicker",3,"minDate","customDatesToReset","selectedCustomDates"],["widgetBody","","fxLayout","row","fxLayoutGap","20px"],[4,"ngIf","ngIfElse"],["fxFlex","45"],[1,"drill-bit__list"],[3,"tableData","selectedRow","drillSelected"],[3,"length","pageSizeOptions","pageSize","page"],["fxFlex","55",1,"drill-bit__chart"],[3,"chartData","selectedRow",4,"ngIf","ngIfElse"],[3,"chartData","selectedRow"],[1,"base-spinner-wrapper"],[1,"spinner"],[1,"page-block__content"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0)(1,"dabo-widget-collapsible",1)(2,"div",2),t._UZ(3,"span",3),t.TgZ(4,"dabo-time-period-dropdown",4),t.NdJ("timePeriodChange",function(r){return e.onTimePeriodTypeChange(r)}),t.qZA(),t.YNc(5,Wt,2,8,"dabo-time-ranges-switcher",5),t.YNc(6,qt,2,4,"dabo-time-ranges-datepicker",6),t.qZA(),t.YNc(7,jt,2,2,"div",7),t.qZA()(),t.YNc(8,Gt,2,0,"ng-template",null,8,t.W1O),t.YNc(10,Xt,2,0,"ng-template",null,9,t.W1O)),2&n){var l=t.MAs(11);t.xp6(1),t.Q6J("widgetTitle","Drill Bits")("widgetIcon","icon-drillbit"),t.xp6(3),t.Q6J("disabled",!1)("labelType","drill-bit__header-label")("selectedPeriodType",e.timePeriodType)("periodDropdownOptions",e.timePeriodOptions),t.xp6(1),t.Q6J("ngIf",e.timePeriodType!==e.timePeriodEnum.CUSTOM),t.xp6(1),t.Q6J("ngIf",e.timePeriodType===e.timePeriodEnum.CUSTOM),t.xp6(1),t.Q6J("ngIf",!e.isNoData)("ngIfElse",l)}},directives:[nt._,St.Q,u.O5,kt.D,at.J,C.xw,C.SQ,C.yH,Ut,A.NW,$t,W.z],pipes:[u.Ov],styles:[".drill-bit[_ngcontent-%COMP%]{margin-bottom:20px}.drill-bit__filter[_ngcontent-%COMP%]{display:flex;height:100%}.drill-bit__filter-separator[_ngcontent-%COMP%]{display:flex;height:100%;width:1px;margin-left:20px;background-color:#ebeefc}.drill-bit__list[_ngcontent-%COMP%]{height:335px;overflow:auto;border:1px solid #d2e0f3;margin:55px 0 0 22px}.drill-bit__chart[_ngcontent-%COMP%]{margin-top:18px;margin-right:18px;min-height:480px}.drill-bit[_ngcontent-%COMP%]   .base-spinner-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0}"]}),i}(),q=s(22868),ie=s(21406),ne=s(31307),ae=s(30567),_=s(48619),ot=s(46792),oe=_.C.SPINDLE,le=_.C.PERFUME,lt=_.C.PATTENS_BLUE,re=_.C.LAVENDER,se=_.C.DODGER_BLUE,ce=function(){function i(a,n,e){(0,v.Z)(this,i),this.chartData=a,this.timePeriod=e,this.chart=this.createChart(n)}return(0,f.Z)(i,[{key:"chartInstance",get:function(){return this.chart}},{key:"updateChartData",value:function(n){var e,l,o,r,c=this.getNameByKpiType(n),d=null===(e=this.chartData[n])||void 0===e?void 0:e.columns.map(function(p){return Object.assign({},p)});null===(l=this.chart.ref)||void 0===l||l.series[0].update({type:"column",name:c,data:d},!1),null===(o=this.chart.ref)||void 0===o||o.yAxis[0].update({title:{text:c}},!1),null===(r=this.chart.ref)||void 0===r||r.redraw()}},{key:"getNameByKpiType",value:function(n){var e=ot.d.find(function(l){return l.value===n});return e?e.label:"KPI report name is not found"}},{key:"createChart",value:function(n){var e,o=((null===(e=this.chartData[n])||void 0===e?void 0:e.columns)||[]).map(function(r){return Object.assign({},r)});return new D.kL({time:{useUTC:!0},chart:{height:480},title:{text:""},tooltip:{enabled:!1},xAxis:[{tickLength:0,type:"datetime",tickPositions:this.getTickPositions(n),labels:{format:this.getTimePeriodFormat(),autoRotationLimit:1e3,autoRotation:[-90],style:{whiteSpace:"nowrap",textOverflow:"none"}}}],yAxis:[{title:{text:this.getNameByKpiType(n)},labels:{style:{color:oe}}},{opposite:!0,title:{text:""},labels:{style:{color:le}}}],plotOptions:{series:{states:{inactive:{opacity:1}},cursor:"pointer",marker:{enabled:!1}},column:{colors:[lt],pointPadding:0,groupPadding:0,borderWidth:.2,shadow:!1,events:{legendItemClick:function(c){return c.preventDefault()}},states:{hover:{color:se}}},line:{stickyTracking:!1,events:{legendItemClick:function(c){return c.preventDefault()}},states:{hover:{linkOpacity:0,lineWidthPlus:0,lineWidth:0}}}},series:[{type:"column",name:this.getNameByKpiType(n),color:lt,data:o,yAxis:0},{type:"line",name:"Blastability",data:this.chartData.blastabilityLine,color:re,yAxis:1}],credits:{enabled:!1},legend:{align:"center",symbolRadius:0,itemMarginTop:15,itemStyle:{fontWeight:"normal"}}})}},{key:"getTickPositions",value:function(n){var e,l=null===(e=this.chartData[n])||void 0===e?void 0:e.columns;return this.getTimePeriodLength("month")>=3&&l.length?[l[0].x,l[l.length-1].x]:l.map(function(d){return d.x})}},{key:"getTimePeriodFormat",value:function(){return this.getTimePeriodLength("day")<3?"{value:%m/%d/%Y %I:%M %P}":"{value:%m/%d/%Y}"}},{key:"getTimePeriodLength",value:function(n){var e=O()(this.timePeriod.dateFrom);return O()(this.timePeriod.dateTo).diff(e,n)}}]),i}(),de=s(43314),he=s(23426),pe=s(24850),rt=function(){var i=function(){function a(){(0,v.Z)(this,a),this.timePeriodRange$=new M.X(null)}return(0,f.Z)(a,[{key:"changePeriods",value:function(e){this.timePeriodRange$.next(e)}},{key:"getStream",value:function(){return this.timePeriodRange$.asObservable()}},{key:"getPeriods",value:function(){return this.timePeriodRange$.getValue()}},{key:"initFilters",value:function(e,l){this.serialNumbers$=new M.X(e),this.equipmentIds$=new M.X(l)}},{key:"updateStream",value:function(e,l){"equipmentId"===e?this.equipmentIds$.next(l):"serialNumber"===e&&this.serialNumbers$.next(l)}},{key:"getFilterStream",value:function(){return(0,he.aj)([this.equipmentIds$.asObservable(),this.serialNumbers$.asObservable()]).pipe((0,pe.U)(function(e){var l=(0,$.Z)(e,2);return{equipmentId:l[0],serialNumber:l[1]}}))}}]),a}();return i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i}(),st=s(90508),ue=s(1133);function ge(i,a){if(1&i&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&i){var n=a.$implicit;t.Q6J("value",n.value),t.xp6(1),t.hij(" ",n.label," ")}}var me=function(){return{text:"Bit Serial Number"}};function fe(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"div",14)(1,"dabo-dropdown-filter",15),t.NdJ("filterValueChange",function(o){return t.CHM(n),t.oxw().handleFilterChanged("serialNumber",o)}),t.qZA()()}if(2&i){var e=t.oxw();t.xp6(1),t.Q6J("selectToggleBtn",!(null==e.filterOptions.serialNumber||!e.filterOptions.serialNumber.length))("filter",e.filterOptions.serialNumber)("titleOptions",t.DdM(3,me))}}var ve=function(){return{text:"Drill Equipment id"}};function Ce(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"div",14)(1,"dabo-dropdown-filter",15),t.NdJ("filterValueChange",function(o){return t.CHM(n),t.oxw().handleFilterChanged("equipmentId",o)}),t.qZA()()}if(2&i){var e=t.oxw();t.xp6(1),t.Q6J("selectToggleBtn",!(null==e.filterOptions.equipmentId||!e.filterOptions.equipmentId.length))("filter",e.filterOptions.equipmentId)("titleOptions",t.DdM(3,ve))}}function be(i,a){1&i&&(t.TgZ(0,"div",21),t._UZ(1,"div",22),t.TgZ(2,"p"),t._uU(3,"There are no data to show"),t.qZA()())}function _e(i,a){if(1&i&&(t.ynx(0),t.TgZ(1,"div",18),t.YNc(2,be,4,0,"div",19),t._UZ(3,"div",20),t.qZA(),t.BQk()),2&i){var n=t.oxw(2);t.xp6(2),t.Q6J("ngIf",n.isNoData),t.xp6(1),t.Q6J("chart",n.chart.chartInstance)("hidden",n.isNoData)}}function ye(i,a){if(1&i&&(t.TgZ(0,"div",16),t.YNc(1,_e,4,3,"ng-container",17),t.qZA()),2&i){var n=t.oxw(),e=t.MAs(15);t.xp6(1),t.Q6J("ngIf",n.chartData)("ngIfElse",e)}}function Te(i,a){1&i&&(t.TgZ(0,"div",23),t._UZ(1,"div",24),t.qZA())}function De(i,a){1&i&&(t.TgZ(0,"div",25),t._UZ(1,"dabo-no-data-container",26),t.qZA()),2&i&&(t.xp6(1),t.Q6J("message","No data to display"))}var xe=function(){var i=function(a){(0,w.Z)(e,a);var n=(0,I.Z)(e);function e(l,o,r){var c;return(0,v.Z)(this,e),(c=n.call(this)).dashboardService=l,c.drillBiReliabilityFilterService=o,c.cdr=r,c.chartKPIType=de.j.WEIGHT_BIT,c.isNoData=!1,c.chartKPIArray=ot.d,c.filterOptions={serialNumber:[],equipmentId:[]},c}return(0,f.Z)(e,[{key:"mineSite",set:function(o){this.mine=o,this.isNoData=!1}},{key:"ngOnInit",value:function(){var o=(0,m.XD)(this.mine).subtract(2,"d").startOf("d").valueOf(),r=(0,m.XD)(this.mine).endOf("d").valueOf();this.minDate=O().tz("2019-01-01",(0,m.FX)(this.mine)),this.drillBiReliabilityFilterService.changePeriods({dateFrom:o,dateTo:r}),this.getAllData()}},{key:"updateSelectedCustomDates",value:function(o){this.drillBiReliabilityFilterService.changePeriods(o)}},{key:"onChartKPIChange",value:function(o){var c,r=o.value;(null===(c=this.chartData[r])||void 0===c?void 0:c.columns.length)?(this.isNoData=!1,this.chart.updateChartData(r)):this.isNoData=!0}},{key:"handleFilterChanged",value:function(o,r){var c=r.filter(function(d){return!d.selected}).map(function(d){return d.id});this.drillBiReliabilityFilterService.updateStream(o,c)}},{key:"trackByFn",value:function(o){return o}},{key:"getAllData",value:function(){var o=this;this.chartData=null,this.drillBiReliabilityFilterService.getStream().pipe((0,q.b)(function(){return o.startLoading()}),(0,ie.b)(function(r){return(0,ae.D)([o.dashboardService.getDrillBitReliability(o.mine,r),o.dashboardService.getDillBitFilterValues(o.mine,r)])}),(0,q.b)(function(){o.initFilters(),o.startFetching()}),(0,T.R)(this.destroy$)).subscribe(function(r){return o.onSuccess(r)},function(){return o.onError()})}},{key:"onSuccess",value:function(o){var r,c=(0,$.Z)(o,2),p=c[1],Ii=p.serialNumbers,Ri=p.equipments;this.chartData=c[0],this.initLocalFilters(Ii,"serialNumber"),this.initLocalFilters(Ri,"equipmentId"),this.isNoData=!(null===(r=o[0][this.chartKPIType])||void 0===r?void 0:r.columns.length),this.chart=new ce(this.chartData,this.chartKPIType,this.drillBiReliabilityFilterService.getPeriods()),this.cdr.markForCheck()}},{key:"onError",value:function(){this.isNoData=!0,this.cdr.markForCheck()}},{key:"startFetching",value:function(){var o=this;this.drillBiReliabilityFilterService.getFilterStream().pipe((0,ne.T)(1),(0,q.b)(function(){return o.startLoading()}),(0,tt.w)(function(r){var c=o.drillBiReliabilityFilterService.getPeriods();return o.dashboardService.getDrillBitReliability(o.mine,c,r.serialNumber,r.equipmentId)}),(0,T.R)(this.destroy$)).subscribe(function(r){return o.onSuccess([r,{equipments:null,serialNumbers:null}])},this.onError.bind(this))}},{key:"initFilters",value:function(){this.drillBiReliabilityFilterService.initFilters([],[])}},{key:"initLocalFilters",value:function(o,r){o&&(this.filterOptions[r]=o.map(function(c){return{id:c,name:c,selected:!0}}))}},{key:"startLoading",value:function(){this.chartData=null,this.isNoData=!1,this.cdr.markForCheck()}}]),e}(g.eO);return i.\u0275fac=function(n){return new(n||i)(t.Y36(N),t.Y36(rt),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-drill-bi-reliability"]],inputs:{mineSite:"mineSite"},features:[t._Bn([{provide:B.Hn,useValue:{scope:"date",alias:"dateTranslation"}},rt]),t.qOj],decls:18,vars:13,consts:[[1,"drill-bi-reliability"],[3,"widgetTitle","widgetIcon"],["widgetHeaderAdditionalContent","",1,"drill-bi-reliability__filter"],[3,"minDate","customDatesToReset","click","selectedCustomDates"],[1,"drill-bi-reliability__filter-chart-kpi"],[1,"drill-bi-reliability__filter-chart-kpi-label"],[1,"mat-select--custom",3,"click"],["disableOptionCentering","","panelClass","chart-kpi-type",3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["class","drill-bi-reliability__filter-drill-filter",4,"ngIf"],["widgetBody","",4,"ngIf","ngIfElse"],["loading",""],["noDataContainer",""],[3,"value"],[1,"drill-bi-reliability__filter-drill-filter"],[3,"selectToggleBtn","filter","titleOptions","filterValueChange"],["widgetBody",""],[4,"ngIf","ngIfElse"],[1,"drill-bi-reliability__chart"],["class","no-data",4,"ngIf"],[3,"chart","hidden"],[1,"no-data"],[1,"icon"],[1,"base-spinner-wrapper"],[1,"spinner"],[1,"page-block__content"],[3,"message"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0)(1,"dabo-widget-collapsible",1)(2,"div",2)(3,"dabo-time-ranges-datepicker",3),t.NdJ("click",function(r){return r.stopPropagation()})("selectedCustomDates",function(r){return e.updateSelectedCustomDates(r)}),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",4)(6,"span",5),t._uU(7,"Chart KPI:"),t.qZA(),t.TgZ(8,"mat-form-field",6),t.NdJ("click",function(r){return r.stopPropagation()}),t.TgZ(9,"mat-select",7),t.NdJ("selectionChange",function(r){return e.onChartKPIChange(r)})("valueChange",function(r){return e.chartKPIType=r}),t.YNc(10,ge,2,2,"mat-option",8),t.qZA()()(),t.YNc(11,fe,2,4,"div",9),t.YNc(12,Ce,2,4,"div",9),t.qZA(),t.YNc(13,ye,2,2,"div",10),t.qZA()(),t.YNc(14,Te,2,0,"ng-template",null,11,t.W1O),t.YNc(16,De,2,1,"ng-template",null,12,t.W1O)),2&n){var l=t.MAs(17);t.xp6(1),t.Q6J("widgetTitle","Drill BI Reliability")("widgetIcon","icon-drillbit"),t.xp6(2),t.Q6J("minDate",e.minDate)("customDatesToReset",t.lcZ(4,11,e.drillBiReliabilityFilterService.getStream())),t.xp6(6),t.Q6J("value",e.chartKPIType),t.xp6(1),t.Q6J("ngForOf",e.chartKPIArray)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngIf",e.filterOptions.serialNumber),t.xp6(1),t.Q6J("ngIf",e.filterOptions.equipmentId),t.xp6(1),t.Q6J("ngIf",!e.isNoData)("ngIfElse",l)}},directives:[nt._,at.J,L.KE,F.gD,u.sg,st.ey,u.O5,ue.V,D.Dm,W.z],pipes:[u.Ov],styles:[".drill-bi-reliability[_ngcontent-%COMP%]{margin-bottom:20px}.drill-bi-reliability__filter[_ngcontent-%COMP%]{display:flex;height:100%;margin-left:20px;align-items:center;justify-content:center}.drill-bi-reliability__filter-chart-kpi[_ngcontent-%COMP%]{padding:0 30px;border-right:1px solid #ebeefc;min-width:215px}.drill-bi-reliability__filter-chart-kpi-label[_ngcontent-%COMP%]{font-size:14px;margin-right:10px;color:#586b7a;font-weight:400}.drill-bi-reliability__filter-chart-kpi[_ngcontent-%COMP%]     .mat-select-min-line{color:#0165bd}.drill-bi-reliability__filter-drill-filter[_ngcontent-%COMP%]{padding:10px 30px;border-right:1px solid #ebeefc}.drill-bi-reliability__filter-drill-filter[_ngcontent-%COMP%]     .dropdown-menu__title{color:#0165bd}.drill-bi-reliability__chart[_ngcontent-%COMP%]{margin-top:18px;margin-right:18px;min-height:480px}.drill-bi-reliability[_ngcontent-%COMP%]   .base-spinner-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0}  .cdk-overlay-container .cdk-overlay-pane .chart-kpi-type{margin-top:25px}"]}),i}(),ct=s(43489),dt=s(80013),ht=s(75778),Pe=s(16952);function Oe(i,a){1&i&&(t.TgZ(0,"th",14)(1,"mat-toolbar")(2,"mat-toolbar-row"),t._UZ(3,"span",15),t.TgZ(4,"span"),t._uU(5,"Shovels"),t.qZA(),t._UZ(6,"span",16),t.qZA()()()),2&i&&t.uIk("colspan",6)}function Se(i,a){1&i&&t._UZ(0,"th",17),2&i&&t.uIk("colspan",1)}function ke(i,a){if(1&i&&(t.TgZ(0,"td",18),t._UZ(1,"div",19),t.qZA()),2&i){var n=a.$implicit,e=t.oxw();t.xp6(1),t.Q6J("ngClass",e.getPointColor(n))("matTooltip",e.getPointTooltip(n))}}function Me(i,a){1&i&&(t.TgZ(0,"th",17),t._uU(1,"Shovel ID"),t.qZA()),2&i&&t.uIk("colspan",1)}function Ae(i,a){if(1&i&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&i){var n=a.$implicit;t.xp6(1),t.Oqu(n.shovelId)}}function Ze(i,a){1&i&&(t.TgZ(0,"th",17),t._uU(1,"NOH (Actual / Avg)"),t.qZA()),2&i&&t.uIk("colspan",1)}function we(i,a){if(1&i&&(t.TgZ(0,"td",18)(1,"div",20)(2,"span",21),t._uU(3),t.ALo(4,"customNumber"),t.qZA(),t.TgZ(5,"span",22),t._uU(6," / "),t.qZA(),t.TgZ(7,"span",23),t._uU(8),t.ALo(9,"customNumber"),t.qZA()()()),2&i){var n=a.$implicit,e=t.oxw();t.uIk("colspan",2),t.xp6(2),t.Q6J("ngClass",e.getLabelColor(n.nohActual,n.nohAvg))("matTooltip",null===n.nohActual?"No Data":""),t.xp6(1),t.hij(" ",t.lcZ(4,6,n.nohActual)," "),t.xp6(4),t.Q6J("matTooltip",null===n.nohAvg?"No Data":""),t.xp6(1),t.hij(" ",t.lcZ(9,8,n.nohAvg),"")}}function Ie(i,a){1&i&&(t.TgZ(0,"th",17),t._uU(1,"BCM (Actual / Avg)"),t.qZA()),2&i&&t.uIk("colspan",2)}function Re(i,a){if(1&i&&(t.TgZ(0,"td",18)(1,"div",20)(2,"span",21),t._uU(3),t.ALo(4,"customNumber"),t.qZA(),t.TgZ(5,"span",22),t._uU(6," / "),t.qZA(),t.TgZ(7,"span",23),t._uU(8),t.ALo(9,"customNumber"),t.qZA()()()),2&i){var n=a.$implicit,e=t.oxw();t.uIk("colspan",2),t.xp6(2),t.Q6J("ngClass",e.getLabelColor(n.bcmActual,n.bcmAvg))("matTooltip",null===n.bcmActual?"No Data":""),t.xp6(1),t.hij("",t.lcZ(4,6,n.bcmActual)," "),t.xp6(4),t.Q6J("matTooltip",null===n.bcmAvg?"No Data":""),t.xp6(1),t.hij(" ",t.lcZ(9,8,n.bcmAvg)," ")}}function Be(i,a){1&i&&t._UZ(0,"tr",24)}function Ne(i,a){1&i&&t._UZ(0,"tr",25)}function Le(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"tr",27),t.NdJ("click",function(){var c=t.CHM(n).$implicit;return t.oxw(2).selectShovel(c)}),t.qZA()}if(2&i){var e=a.$implicit,l=t.oxw(2);t.Udp("background",l.hightlightedRowColor(e))}}function Fe(i,a){if(1&i&&(t.ynx(0),t.YNc(1,Le,1,2,"tr",26),t.BQk()),2&i){var n=t.oxw();t.xp6(1),t.Q6J("matRowDefColumns",n.columns)}}function Ee(i,a){1&i&&(t.ynx(0),t.TgZ(1,"div",28),t._UZ(2,"div",29),t.TgZ(3,"p"),t._uU(4,"There are no data to show"),t.qZA()(),t.BQk())}var He=function(a){return{"no-data-table":a}},Ue=function(){return["header"]},Qe=function(){var i=function(){function a(n){(0,v.Z)(this,a),this.cdr=n,this.shovelSelected=new t.vpe,this.columns=["point","shovedId","noh","bcm"]}return(0,f.Z)(a,[{key:"shovelData",set:function(e){this.data=e.table,e.id&&(this.selectedRow=e.table.find(function(l){return l.shovelId===e.id})),this.cdr.markForCheck()}},{key:"hightlightedRowColor",value:function(e){if(this.selectedRow===e)return"rgba(31, 143, 247, 0.14)"}},{key:"getLabelColor",value:function(e,l){return"shovels-table-value"+(e&&l&&e>l?"--red":"--normal")}},{key:"getPointColor",value:function(e){return e.bcmActual&&e.bcmAvg&&(e.bcmPercentage=e.bcmActual/e.bcmAvg*100),e.nohActual&&e.nohAvg&&(e.nohPercentage=e.nohActual/e.nohAvg*100),e.bcmActual&&e.bcmAvg&&e.bcmActual>=e.bcmAvg||e.nohActual&&e.nohAvg&&e.nohActual>=e.nohAvg?"point--red":e.bcmPercentage>80||e.nohPercentage>80?"point--yellow":e.bcmPercentage<=80&&e.nohPercentage<=80?"point--green":"point--grey"}},{key:"getPointTooltip",value:function(e){return"point--grey"===this.getPointColor(e)?"No Data":null}},{key:"selectShovel",value:function(e){this.selectedRow=this.selectedRow&&this.selectedRow.shovelId===e.shovelId?null:e,this.shovelSelected.emit(this.selectedRow?this.selectedRow.shovelId:null)}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-shovels-list"]],inputs:{shovelData:"shovelData",generalLoading:"generalLoading"},outputs:{shovelSelected:"shovelSelected"},decls:20,vars:11,consts:[[1,"teck-basic-table",3,"ngClass"],["mat-table","","aria-label","shovels-list-table",3,"dataSource"],["matColumnDef","header"],["mat-header-cell","","class","pd0","scope","col",4,"matHeaderCellDef"],["matColumnDef","point"],["mat-header-cell","","scope","col","class","table-sort-header",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","shovedId"],["mat-header-cell","","class","table-sort-header","scope","col",4,"matHeaderCellDef"],["matColumnDef","noh"],["matColumnDef","bcm"],["mat-header-row","","class","table-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-header-row","","class","table-columns-header",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"ngIf"],["mat-header-cell","","scope","col",1,"pd0"],[1,"icon","icon-shovel"],[1,"fill-remaining-space"],["mat-header-cell","","scope","col",1,"table-sort-header"],["mat-cell",""],["matTooltipClass","blastTooltip","matTooltipPosition","above",3,"ngClass","matTooltip"],["fxLayout","row","fxLayout.lt-md","column",1,"box-size"],["fxFlex","48","fxLayoutAlign","end","fxFlexOffset","5px","matTooltipPosition","above","matTooltipClass","noDataTooltip",3,"ngClass","matTooltip"],["fxFlex","2","fxLayoutAlign","center","fxFlexOffset","5px"],["fxFlex","48","fxLayoutAlign","start","fxFlexOffset","5px","matTooltipPosition","above","matTooltipClass","noDataTooltip",1,"shovels-table-value--avg",3,"matTooltip"],["mat-header-row","",1,"table-header-row"],["mat-header-row","",1,"table-columns-header"],["mat-row","","class","table-row",3,"background","click",4,"matRowDef","matRowDefColumns"],["mat-row","",1,"table-row",3,"click"],[1,"no-data"],[1,"icon"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"table",1),t.ynx(2,2),t.YNc(3,Oe,7,1,"th",3),t.BQk(),t.ynx(4,4),t.YNc(5,Se,1,1,"th",5),t.YNc(6,ke,2,2,"td",6),t.BQk(),t.ynx(7,7),t.YNc(8,Me,2,1,"th",8),t.YNc(9,Ae,2,1,"td",6),t.BQk(),t.ynx(10,9),t.YNc(11,Ze,2,1,"th",8),t.YNc(12,we,10,10,"td",6),t.BQk(),t.ynx(13,10),t.YNc(14,Ie,2,1,"th",8),t.YNc(15,Re,10,10,"td",6),t.BQk(),t.YNc(16,Be,1,0,"tr",11),t.YNc(17,Ne,1,0,"tr",12),t.YNc(18,Fe,2,1,"ng-container",13),t.qZA(),t.YNc(19,Ee,5,0,"ng-container",13),t.qZA()),2&n&&(t.Q6J("ngClass",t.VKq(8,He,!e.data||!e.data.length)),t.xp6(1),t.Q6J("dataSource",e.data),t.xp6(15),t.Q6J("matHeaderRowDef",t.DdM(10,Ue))("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matHeaderRowDef",e.columns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("ngIf",e.data&&e.data.length),t.xp6(1),t.Q6J("ngIf",!(e.data&&e.data.length||e.generalLoading)))},directives:[u.mk,P.oO,h.BZ,h.w1,h.fO,h.ge,k.Ye,k.rD,h.Dz,h.ev,E.gM,C.xw,C.yH,C.Wh,C.UT,h.as,h.XQ,u.O5,h.nj,h.Gk],pipes:[H.n],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{max-width:260px}.table-row--highlighted[_ngcontent-%COMP%]{background-color:#1f8ff724}.table-row[_ngcontent-%COMP%]:nth-child(even){background-color:#f6f7fb99}.table-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}.table-row[_ngcontent-%COMP%]:hover{background-color:#f2f8ff}.teck-basic-table[_ngcontent-%COMP%]   .table-sort-header[_ngcontent-%COMP%]{text-align:center;background-color:#cbd3e72e;color:#030f2980;font-weight:400}.teck-basic-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border:none}.teck-basic-table[_ngcontent-%COMP%]   .table-columns-header[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{box-shadow:none;font-size:12px}.teck-basic-table[_ngcontent-%COMP%]   .table-columns-header[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:nth-child(2){width:30%}.teck-basic-table[_ngcontent-%COMP%]   .table-columns-header[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:nth-last-child(-n+2){width:100%;padding-left:8%}.teck-basic-table[_ngcontent-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%]{height:24px}.teck-basic-table[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]{text-align:center;height:28px;cursor:pointer}.teck-basic-table[_ngcontent-%COMP%]   .shovels-table-value--red[_ngcontent-%COMP%]{color:#d66264}.teck-basic-table[_ngcontent-%COMP%]   .shovels-table-value--normal[_ngcontent-%COMP%]{color:#2e384dc9}.teck-basic-table[_ngcontent-%COMP%]   .shovels-table-value--avg[_ngcontent-%COMP%]{color:#2e384d7d}.teck-basic-table[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--grey[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--green[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--yellow[_ngcontent-%COMP%], .teck-basic-table[_ngcontent-%COMP%]   .point--red[_ngcontent-%COMP%]{position:relative;width:8px;height:8px;border-radius:50%}.teck-basic-table[_ngcontent-%COMP%]   .point--red[_ngcontent-%COMP%]{background-color:#f54d4a}.teck-basic-table[_ngcontent-%COMP%]   .point--yellow[_ngcontent-%COMP%]{background-color:#f6b13a}.teck-basic-table[_ngcontent-%COMP%]   .point--green[_ngcontent-%COMP%]{background-color:#72cd5c}.teck-basic-table[_ngcontent-%COMP%]   .point--grey[_ngcontent-%COMP%]{background-color:gray}.no-data-table[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.no-data-table[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{flex:1}.no-data-table[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:0}.no-data-table[_ngcontent-%COMP%]   .table-columns-header[_ngcontent-%COMP%]{display:none}.mat-tooltip[_ngcontent-%COMP%]{background-color:#586b7a;white-space:pre-line;text-align:center;font-size:11px;font-weight:500}.mat-tooltip.noDataTooltip[_ngcontent-%COMP%]{position:relative;top:5px}.box-size[_ngcontent-%COMP%]{box-sizing:content-box}"],changeDetection:0}),i}();function Je(i,a){1&i&&(t.TgZ(0,"div",4),t._UZ(1,"div",5),t.TgZ(2,"p"),t._uU(3,"There are no data to show"),t.qZA()())}var Ye=function(a){return{"padding-left.px":a}},$e=function(a){return{"padding-right.px":a}};function We(i,a){if(1&i&&(t.TgZ(0,"div",6)(1,"div",7),t._uU(2),t.qZA(),t.TgZ(3,"div",8),t._uU(4),t.qZA()()),2&i){var n=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.VKq(4,Ye,n.leftYaxisWidth)),t.xp6(1),t.Oqu(n.chartDateLimits.min),t.xp6(1),t.Q6J("ngStyle",t.VKq(6,$e,n.rightYaxisWidth)),t.xp6(1),t.Oqu(n.chartDateLimits.max)}}var qe=function(a){return{"no-data-container":a}},ze=_.C.BLUE_SECONDARY_LIGHT,Ve=_.C.DODGER_BLUE,pt=_.C.LAVENDER,Ke=_.C.PERFUME,z=_.C.POMEGRANATE,ut=_.C.PATTENS_BLUE,gt=_.C.PINEGLADE,je=_.C.SPINDLE,mt=S.a.CHART_TICK,ft=S.a.CHART_TOOLTIP,Ge=function(){var i=function(){function a(n,e,l){(0,v.Z)(this,a),this.customDecimalPipe=n,this.mineStateService=e,this.cdr=l,this.noData=!1,this.chartDateLimits={min:null,max:null},this.chartType=b,this.period="12"}return(0,f.Z)(a,[{key:"ngOnChanges",value:function(e){var l=this;if(e.chartData||e.chartType)if(this.chartData&&this.chartData[this.chartType===b?"chartBCM":"chartNOH"]){this.chart=this.getChart(this);var r=this.chartData.chartBCM.lines;this.mine=this.mineStateService.getSelectedMineArea(),this.chartDateLimits={min:g.Ov.transformToMineUTCTimeZone(this.mine,r[0].startWeek,mt),max:g.Ov.transformToMineUTCTimeZone(this.mine,r[r.length-1].endWeek,mt)},setTimeout(function(){l.leftYaxisWidth=+l.chart.ref.get("y-axis-left").left,l.rightYaxisWidth=+l.chart.ref.get("y-axis-right").right,l.chart.ref.reflow(),l.cdr.detectChanges()},100),this.noData=!1}else this.noData=!0}},{key:"getChart",value:function(e){this.chartTooltipData=this.chartData.chartTooltip;var l=this.chartData.chartTooltip;return this.shovelTargetBCM=this.chartData.chartBCM.target,this.shovelTargetNOH=this.chartData.chartNOH.target,new D.kL({time:{useUTC:!0},chart:{height:480},title:{text:""},xAxis:this.getChartxAxis(),yAxis:this.getChartsyAxis(),plotOptions:this.getChartPlotOptions(),tooltip:this.getChartTollTip(e,l,this),series:this.getChartSeries(),credits:{enabled:!1},legend:{align:"center",symbolRadius:0,itemMarginTop:15,itemStyle:{fontWeight:"normal"}}})}},{key:"getChartxAxis",value:function(){return[{tickWidth:0,tickLength:0,startOfWeek:0,tickPositions:this.setTickPositions(),startOnTick:!0,type:"datetime",labels:{enabled:!1}},{startOfWeek:0,startOnTick:!0,tickPositions:this.setTickPositions(),type:"datetime",visible:!1}]}},{key:"getChartsyAxis",value:function(){return[{id:"y-axis-left",title:{text:""},labels:{style:{color:je}}},{opposite:!0,id:"y-axis-right",title:{text:""},labels:{style:{color:this.chartType===b?Ke:z}},plotLines:[{color:gt,width:2,value:this.chartType===b?this.shovelTargetBCM:this.shovelTargetNOH,dashStyle:"Solid",zIndex:4}]},{visible:!1,linkedTo:1}]}},{key:"getChartPlotOptions",value:function(){return{series:{states:{inactive:{opacity:1}},cursor:"pointer",marker:{enabled:!1}},column:{colors:[ut,ze],groupPadding:0,pointPadding:0,borderWidth:0,events:{legendItemClick:function(l){return l.preventDefault()}},states:{hover:{color:Ve}}},line:{stickyTracking:!1,dataSorting:{enabled:!1},events:{legendItemClick:function(l){return l.preventDefault()}},states:{hover:{linkOpacity:0,lineWidthPlus:0,lineWidth:0}}}}}},{key:"getChartTollTip",value:function(e,l,o){return{useHTML:!0,formatter:function(){if(("Net. Op. Hours"===this.series.name||"BCM"===this.series.name)&&l)return!1;if(""===this.series.name&&l)return"<span>Total Op. Hours: ".concat(e.customDecimalPipe.transform(this.point.tooltipData.totalNOH),"</span><br>\n                  <span>Total BCM: ").concat(this.point.tooltipData.totalBCM,"</span><br>\n                  <span>Change Date: ").concat(this.point.tooltipData.changeDate,"</span><br>\n                  <span>Downtime: ").concat(null===this.point.tooltipData.downtime?"-":this.point.tooltipData.downtime,"</span>");if(""===this.series.name&&!l)return!1;var c=g.Ov.transformToMineUTCTimeZone(o.mine,this.point.startWeek,ft),d=g.Ov.transformToMineUTCTimeZone(o.mine,this.point.endWeek,ft);return"<span>".concat(this.series.name,": <b>").concat(e.customDecimalPipe.transform(this.y),"<b></span><br/>\n                  <span>").concat(c," - ").concat(d,"</span>")}}}},{key:"getChartSeries",value:function(){return[{type:"column",linkedTo:"legendColor",id:"Diggability",name:"Diggability",showInLegend:!1,colorByPoint:!0,data:this.chartType===b?this.chartData.chartBCM.columns:this.chartData.chartNOH.columns,tooltip:{headerFormat:""},yAxis:0},{type:"column",name:"Diggability",color:ut,id:"legendColor",grouping:!1},{type:"line",name:this.chartType===b?"BCM":"Net. Op. Hours",data:this.chartType===b?this.chartData.chartBCM.lines:this.chartData.chartNOH.lines,color:this.chartType===b?pt:z,xAxis:1,yAxis:1,tooltip:{nullFormat:null,headerFormat:""}},{type:"line",name:this.chartType===b?"Avg. BCM":"Avg. NOH",color:gt,visible:!0,yAxis:2,showInLegend:!!this.chartTooltipData},{type:"line",name:"",data:this.setPeekPoints(),xAxis:1,yAxis:2,color:this.chartType===b?pt:z,tooltip:{headerFormat:""},lineWidth:0,marker:{enabled:!0,symbol:"circle",radius:5},showInLegend:!1}]}},{key:"setTickPositions",value:function(){var e=this.chartData.chartBCM.lines,l=this.mineStateService.getSelectedMineArea();return[g.Ov.transformToMineUTCTimeZone(l,e[0].endWeek),g.Ov.transformToMineUTCTimeZone(l,e[e.length-1].endWeek)]}},{key:"setPeekPoints",value:function(){var o={source:[],linesSource:this.chartType===b?this.chartData.chartBCM:this.chartData.chartNOH};if(this.chartTooltipData)return this.chartTooltipData.forEach(function(r){o.source.splice(r.index-1,1,{y:o.linesSource.lines[r.index-1].y,x:o.linesSource.lines[r.index-1].x,tooltipData:r})}),o.source}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.Y36(H.n),t.Y36(y.Hj),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-chart"]],inputs:{chartData:"chartData",chartType:"chartType",generalLoading:"generalLoading",period:"period"},features:[t.TTD],decls:4,vars:7,consts:[[1,"chart-container",3,"ngClass"],["class","no-data",4,"ngIf"],[3,"chart","hidden"],["fxLayout","row","fxLayoutAlign","space between","class","x-axis-labels",4,"ngIf"],[1,"no-data"],[1,"icon"],["fxLayout","row","fxLayoutAlign","space between",1,"x-axis-labels"],[1,"x-axis-labels__left-item",3,"ngStyle"],[1,"x-axis-labels__right-item",3,"ngStyle"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0),t.YNc(1,Je,4,0,"div",1),t._UZ(2,"div",2),t.YNc(3,We,5,8,"div",3),t.qZA()),2&n&&(t.Q6J("ngClass",t.VKq(5,qe,e.noData)),t.xp6(1),t.Q6J("ngIf",e.noData&&!e.generalLoading),t.xp6(1),t.Q6J("chart",e.chart)("hidden",e.noData),t.xp6(1),t.Q6J("ngIf",!e.noData&&!e.generalLoading))},directives:[u.mk,P.oO,u.O5,D.Dm,C.xw,C.Wh,u.PC,P.Zl],styles:["[_nghost-%COMP%]     .highcharts-container, [_nghost-%COMP%]     .highcharts-root{width:100%!important}[_nghost-%COMP%]     .highcharts-legend-item.highcharts-series-6{display:none}[_nghost-%COMP%]     .highcharts-series-5 .highcharts-graph{stroke:#b3d191}[_nghost-%COMP%]     .highcharts-series-5 .highcharts-point{fill:#b3d191}[_nghost-%COMP%]     .highcharts-series-5 tspan{fill:#333}[_nghost-%COMP%]     .highcharts-legend-item text:hover, [_nghost-%COMP%]     .highcharts-point:hover{cursor:default!important}.chart-container[_ngcontent-%COMP%]{height:475px;position:relative;display:block;background-color:#fff;font-size:12px;font-weight:400;text-align:center;color:#82909edb;margin-top:30px}.chart-container[_ngcontent-%COMP%]   .x-axis-labels[_ngcontent-%COMP%]{width:100%;position:absolute;bottom:8%;font-size:11px;left:0;color:#666}.chart-container[_ngcontent-%COMP%]   .x-axis-labels[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:50%}.chart-container[_ngcontent-%COMP%]   .x-axis-labels[_ngcontent-%COMP%]   .x-axis-labels__left-item[_ngcontent-%COMP%]{text-align:left}.chart-container[_ngcontent-%COMP%]   .x-axis-labels[_ngcontent-%COMP%]   .x-axis-labels__right-item[_ngcontent-%COMP%]{text-align:right}.chart-container[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{padding:10px 10px 0}.chart-container[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   .chartTitle[_ngcontent-%COMP%]{padding-right:20px}.no-data-container[_ngcontent-%COMP%]{display:flex}.no-data-container[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-top:0}"],changeDetection:0}),i}();function Xe(i,a){if(1&i&&(t.ynx(0),t._uU(1),t.BQk()),2&i){var n=t.oxw();t.xp6(1),t.Oqu(n.selectedShovel)}}function ti(i,a){if(1&i&&t._uU(0),2&i){var n=t.oxw();t.Oqu(n.selectedMine)}}var ei=function(a,n,e){return{active:a,bcm:n,noh:e}};function ii(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){var c=t.CHM(n).$implicit;return t.oxw().toggleChartType(c)}),t._uU(1),t.qZA()}if(2&i){var e=a.$implicit,l=t.oxw();t.Q6J("ngClass",t.kEZ(2,ei,e===l.selectedChartType,"bcm"===e,"noh"===e)),t.xp6(1),t.hij(" ",e," ")}}function ni(i,a){1&i&&(t.ynx(0),t._uU(1,"year"),t.BQk())}function ai(i,a){1&i&&(t.ynx(0),t._uU(1,"s"),t.BQk())}function oi(i,a){if(1&i&&(t._uU(0),t.YNc(1,ai,2,0,"ng-container",14)),2&i){var n=t.oxw().$implicit;t.hij("",n," month"),t.xp6(1),t.Q6J("ngIf","6"===n||"3"===n)}}function li(i,a){if(1&i&&(t.TgZ(0,"mat-option",17),t.YNc(1,ni,2,0,"ng-container",4),t.YNc(2,oi,2,2,"ng-template",null,18,t.W1O),t.qZA()),2&i){var n=a.$implicit,e=t.MAs(3);t.Q6J("value",n),t.xp6(1),t.Q6J("ngIf","12"===n)("ngIfElse",e)}}function ri(i,a){1&i&&t._UZ(0,"mat-progress-bar",19)}function si(i,a){1&i&&t.GkF(0)}var ci=function(a){return{color:a}},di=function(){var i=function(){function a(n,e){(0,v.Z)(this,a),this.cdr=n,this.customEventService=e,this.chartTypes=[b,"noh"],this.timePeriods=["12","6","3","1"],this.loading=!1,this.periodChanged=new t.vpe}return(0,f.Z)(a,[{key:"setSelectedMine",set:function(e){this.selectedMine=e,this.selectedPeriod=this.timePeriods[0],this.selectedChartType=this.chartTypes[0],this.cdr.markForCheck()}},{key:"ngOnInit",value:function(){this.selectedChartType=this.chartTypes[0],this.selectedPeriod=this.timePeriods[0]}},{key:"selectPeriod",value:function(e){this.periodChanged.next(e.value)}},{key:"toggleChartType",value:function(e){var l=e.toUpperCase();this.selectedChartType=e,this.customEventService.event(R.R.METRIC_APPLY,{metric_type:e}),this.customEventService.event(R.R.WIDGET_DISPLAYED,{widget_name:"Shovels Table/Shovels Chart",metric_applied:l})}}]),a}();return i.\u0275fac=function(n){return new(n||i)(t.Y36(t.sBO),t.Y36(y.qL))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-chart-wrapper"]],inputs:{chartData:"chartData",generalLoading:"generalLoading",loading:"loading",selectedShovel:"selectedShovel",setSelectedMine:"setSelectedMine"},outputs:{periodChanged:"periodChanged"},decls:21,vars:15,consts:[[1,"teck-basic-card"],[1,"icon","icon-kpi"],[1,"toolbar-title"],[1,"toolbar-subtitle"],[4,"ngIf","ngIfElse"],["shovelId",""],[1,"fill-remaining-space"],[1,"button-group","button-group--small-rounded"],["class","button-group__item",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngStyle"],[1,"period-form-select"],[3,"value","disabled","valueChange","selectionChange"],["class","mine-option",3,"value",4,"ngFor","ngForOf"],["color","primary","mode","indeterminate",4,"ngIf"],[4,"ngIf"],[3,"chartData","chartType","period","generalLoading"],[1,"button-group__item",3,"ngClass","click"],[1,"mine-option",3,"value"],["months",""],["color","primary","mode","indeterminate"]],template:function(n,e){if(1&n&&(t.TgZ(0,"mat-card",0)(1,"mat-toolbar")(2,"mat-toolbar-row"),t._UZ(3,"span",1),t.TgZ(4,"span",2),t._uU(5,"Chart:"),t.qZA(),t.TgZ(6,"span",3),t.YNc(7,Xe,2,1,"ng-container",4),t.YNc(8,ti,1,1,"ng-template",null,5,t.W1O),t.qZA(),t._UZ(10,"span",6),t.TgZ(11,"div",7),t.YNc(12,ii,2,6,"button",8),t.qZA(),t._UZ(13,"span",6),t.TgZ(14,"div",9)(15,"mat-form-field",10)(16,"mat-select",11),t.NdJ("valueChange",function(r){return e.selectedPeriod=r})("selectionChange",function(r){return e.selectPeriod(r)}),t.YNc(17,li,4,3,"mat-option",12),t.qZA()()()(),t.YNc(18,ri,1,0,"mat-progress-bar",13),t.qZA(),t.YNc(19,si,1,0,"ng-container",14),t._UZ(20,"dabo-chart",15),t.qZA()),2&n){var l=t.MAs(9);t.xp6(7),t.Q6J("ngIf","all"!==e.selectedShovel)("ngIfElse",l),t.xp6(5),t.Q6J("ngForOf",e.chartTypes),t.xp6(2),t.Q6J("ngStyle",t.VKq(13,ci,e.loading?"#d6d8dc":"rgba(0, 0, 0, 0.87)")),t.xp6(2),t.Q6J("value",e.selectedPeriod)("disabled",e.loading),t.xp6(1),t.Q6J("ngForOf",e.timePeriods),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("chartData",e.chartData)("chartType",e.selectedChartType)("period",e.selectedPeriod)("generalLoading",e.generalLoading)}},directives:[K.a8,k.Ye,k.rD,u.O5,u.sg,u.mk,P.oO,u.PC,P.Zl,L.KE,F.gD,st.ey,j.pW,Ge],styles:['.mat-card[_ngcontent-%COMP%]{padding:0;overflow:hidden}.mat-select[_ngcontent-%COMP%], .mat-option[_ngcontent-%COMP%]{text-transform:capitalize;font-weight:500}.mat-progress-bar[_ngcontent-%COMP%]{top:44px;height:3px;position:absolute}.button-group__item[_ngcontent-%COMP%]{text-transform:uppercase}[_nghost-%COMP%]     .period-form-select .mat-form-field-wrapper{padding-bottom:12px;font-size:12px}[_nghost-%COMP%]     .period-form-select .mat-select-arrow{display:flex;align-items:center;width:12px;border:none;text-align:end;font-size:14px}[_nghost-%COMP%]     .period-form-select .mat-select-arrow:before{content:"\\e901";height:12px;color:#abb5bc}[_nghost-%COMP%]     .period-form-select .mat-form-field-infix{width:80px;text-align:end}[_nghost-%COMP%]     .period-form-select .mat-form-field-underline{display:none}'],changeDetection:0}),i}(),hi=function(a,n){return{table:a,id:n}};function pi(i,a){if(1&i){var n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"dabo-shovels-list",3),t.NdJ("shovelSelected",function(o){return t.CHM(n),t.oxw().shovelSelected(o)}),t.qZA()(),t.TgZ(3,"div",4)(4,"dabo-chart-wrapper",5),t.NdJ("periodChanged",function(o){return t.CHM(n),t.oxw().periodChanged(o)}),t.qZA()()()}if(2&i){var e=t.oxw();t.xp6(2),t.Q6J("generalLoading",e.loading)("shovelData",t.WLB(7,hi,e.hoistRopes,e.selectedShovelId)),t.xp6(2),t.Q6J("chartData",e.charts)("generalLoading",e.loading)("loading",e.chartLoading)("selectedShovel",e.dashboardParams.shovel)("setSelectedMine",e.dashboardParams.mine)}}var ui=function(){var i=function(a){(0,w.Z)(e,a);var n=(0,I.Z)(e);function e(l,o,r,c){var d;return(0,v.Z)(this,e),(d=n.call(this)).cdr=l,d.dashboardService=o,d.spinnerService=r,d.localizationLocalService=c,d.charts={chartBCM:null,chartNOH:null,chartTooltip:null},d.chartLoading=!1,d.dashboardParams=null,d.hoistRopes=[],d.loading=!1,d.selectedShovelId=null,d}return(0,f.Z)(e,[{key:"mineSite",set:function(o){(!this.dashboardParams||this.dashboardParams.mine!==o)&&(this.selectedShovelId=null,this.updateDashboard("mine",o))}},{key:"periodChanged",value:function(o){this.checkOngoingRequest(),this.updateDashboard("period",o)}},{key:"shovelSelected",value:function(o){this.checkOngoingRequest(),this.selectedShovelId=o,this.updateDashboard("shovel",this.selectedShovelId?this.selectedShovelId:"all")}},{key:"checkOngoingRequest",value:function(){this.getAllData$&&this.getAllData$ instanceof ct.L&&(this.getAllData$.next(),this.getAllData$.complete()),this.getSingleShovelData$&&this.getSingleShovelData$ instanceof ct.L&&(this.getSingleShovelData$.next(),this.getSingleShovelData$.complete())}},{key:"checkSingleHoistRopeChartDataAvailability",value:function(o){if(!(0,J.isNil)(o))return!!(o.chartBCM.lines.length&&o.chartBCM.columns.length||o.chartNOH.lines.length&&o.chartNOH.columns.length)&&o}},{key:"getAllData",value:function(o){var r=this;this.loading=!0;var c=this.localizationLocalService.translateText("spinner.loading_data");this.spinnerService.startSpinner({active:!0,statusMessage:c}),this.getAllData$=this.dashboardService.getHoistRopes(this.dashboardParams.mine,this.dashboardParams.period).pipe((0,dt.b)(200),(0,ht.x)(),(0,Q.x)(function(){r.loading=!1,r.spinnerService.stopSpinner()}),(0,T.R)(this.destroy$)).subscribe(function(d){d?(r.hoistRopes=d.table,r.charts=d.charts,r.showError="mine"===o&&!d.table&&!d.charts):r.getAllData("shovel"),r.cdr.markForCheck()},function(d){d&&(r.showError=!0,r.cdr.markForCheck(),r.spinnerService.stopSpinner())})}},{key:"getSingleShovelData",value:function(){var o=this;this.chartLoading=!0,this.getSingleShovelData$=this.dashboardService.getHoistRopes(this.dashboardParams.mine,this.dashboardParams.period,this.selectedShovelId).pipe((0,dt.b)(200),(0,ht.x)(),(0,Q.x)(function(){o.chartLoading=!1}),(0,T.R)(this.destroy$)).subscribe(function(r){r&&o.checkSingleHoistRopeChartDataAvailability(r.charts)?(o.hoistRopes=r.table,o.charts=r.charts):o.getAllData("shovel"),o.showError=!1,o.cdr.markForCheck()},function(r){r&&(o.showError=!0,o.cdr.markForCheck())})}},{key:"updateDashboard",value:function(o,r){"mine"===o?this.dashboardParams={mine:r,period:"12",shovel:"all"}:this.dashboardParams[o]=r,this.selectedShovelId?this.getSingleShovelData():this.getAllData(o)}}]),e}(g.eO);return i.\u0275fac=function(n){return new(n||i)(t.Y36(t.sBO),t.Y36(N),t.Y36(y.V),t.Y36(Pe.bM))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-shovel"]],inputs:{mineSite:"mineSite"},features:[t.qOj],decls:1,vars:1,consts:[["fxLayout","row","fxLayoutGap","20px",4,"ngIf"],["fxLayout","row","fxLayoutGap","20px"],["fxFlex","35",1,"hoist-ropes-shovels__wrapper"],[3,"generalLoading","shovelData","shovelSelected"],["fxFlex","65",1,"hoist-ropes-charts__wrapper"],[3,"chartData","generalLoading","loading","selectedShovel","setSelectedMine","periodChanged"]],template:function(n,e){1&n&&t.YNc(0,pi,5,10,"div",0),2&n&&t.Q6J("ngIf",!e.showError)},directives:[u.O5,C.xw,C.SQ,C.yH,Qe,di],styles:[".mat-progress-bar[_ngcontent-%COMP%]{height:3px;position:absolute;top:0;left:0;right:0;width:100%}.hoist-ropes-shovels__wrapper[_ngcontent-%COMP%]{box-shadow:0 9px 19px #22569b12;height:34.5625rem;overflow-y:auto;background-color:#fff}.hoist-ropes-charts__wrapper[_ngcontent-%COMP%]{box-shadow:0 9px 19px #22569b12;height:34.5625rem;background-color:#fff}"]}),i}();function gi(i,a){if(1&i&&t._UZ(0,"dabo-drill-bit",7),2&i){var n=t.oxw(2);t.Q6J("mineSite",n.mineSite)}}function mi(i,a){if(1&i&&t._UZ(0,"dabo-drill-bi-reliability",7),2&i){var n=t.oxw(2);t.Q6J("mineSite",n.mineSite)}}function fi(i,a){if(1&i&&(t.TgZ(0,"div",5),t.YNc(1,gi,1,1,"dabo-drill-bit",6),t.YNc(2,mi,1,1,"dabo-drill-bi-reliability",6),t._UZ(3,"dabo-shovel",7),t.qZA()),2&i){var n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.isLCO),t.xp6(1),t.Q6J("ngIf",n.isGHO),t.xp6(1),t.Q6J("mineSite",n.mineSite)}}function vi(i,a){1&i&&(t.TgZ(0,"div",8),t._UZ(1,"dabo-no-data-container"),t.qZA())}var Ci=U.K.HOIST_ROPES,_i=[{path:"",component:function(){var i=function(a){(0,w.Z)(e,a);var n=(0,I.Z)(e);function e(l,o,r,c,d){var p;return(0,v.Z)(this,e),(p=n.call(this)).mineStateService=l,p.pagePermissionService=o,p.titleService=r,p.router=c,p.customEventService=d,p.isNoData=!1,p.equipmentTitleMines=[X.q.LCO,X.q.GHO],p}return(0,f.Z)(e,[{key:"ngOnInit",value:function(){var o=this;this.mineStateService.selectedMineArea$.pipe((0,T.R)(this.destroy$)).subscribe(function(r){o.equipmentTitleMines.includes(o.mineStateService.getSelectedMineArea())?o.titleService.setTitle(U.K.EQUIPMENT):o.titleService.setTitle(U.K.HOIST_ROPES),o.pagePermissionService.canAccess(Ci)?(o.mineSite=r.value,o.isNoData=!1):o.isNoData=!0}),this.sendDefaultParams(),this.sendDefaultStateCollectorEvent()}},{key:"isLCO",get:function(){return g.ZA.isLCO(this.mineStateService.getSelectedMineArea())}},{key:"isGHO",get:function(){return g.ZA.isGHO(this.mineStateService.getSelectedMineArea())}},{key:"headerTitle",get:function(){return this.equipmentTitleMines.includes(this.mineStateService.getSelectedMineArea())?"title.equipment":"title.hoist-ropes"}},{key:"sendDefaultStateCollectorEvent",value:function(){var o=this;this.router.events.pipe((0,G.h)(function(r){return r instanceof Z.m2}),(0,T.R)(this.destroy$)).subscribe(function(){o.sendDefaultParams()})}},{key:"sendDefaultParams",value:function(){var o=this.mineStateService.getSelectedMineArea();g.ZA.isLCO(o)?this.customEventService.event(R.R.DEFAULT_STATE_COLLECTOR,{date_type:x.v.MONTH,page_url:this.router.url}):this.customEventService.event(R.R.DEFAULT_STATE_COLLECTOR,{page_url:this.router.url})}}]),e}(g.eO);return i.\u0275fac=function(n){return new(n||i)(t.Y36(y.Hj),t.Y36(y.GO),t.Y36(y.yD),t.Y36(Z.F0),t.Y36(y.qL))},i.\u0275cmp=t.Xpm({type:i,selectors:[["dabo-hoist-ropes"]],features:[t.qOj],decls:7,vars:3,consts:[["fxLayout","column",1,"page-block"],["fxLayout","row",1,"page-block__header"],[1,"page-title","page-title--basic",3,"transloco"],["class","page-block__content",4,"ngIf","ngIfElse"],["noDataContainer",""],[1,"page-block__content"],[3,"mineSite",4,"ngIf"],[3,"mineSite"],[1,"page-block__content","no-data-content"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"dabo-mine-switcher")(3,"h2",2),t.qZA(),t.YNc(4,fi,4,3,"div",3),t.qZA(),t.YNc(5,vi,2,0,"ng-template",null,4,t.W1O)),2&n){var l=t.MAs(6);t.xp6(3),t.Q6J("transloco",e.headerTitle),t.xp6(1),t.Q6J("ngIf",!e.isNoData)("ngIfElse",l)}},directives:[C.xw,Ct.p,B.KI,u.O5,ee,xe,ui,W.z],styles:["[_nghost-%COMP%]{height:100vh}.page-block__content[_ngcontent-%COMP%]{margin-top:84px;height:auto;padding-bottom:20px}.page-block__content.no-data-content[_ngcontent-%COMP%]{height:100%;padding-bottom:0}.page-block__header[_ngcontent-%COMP%]{position:fixed;z-index:999;background-color:#fff;padding-left:20px}"]}),i}()},{path:"**",redirectTo:""}],yi=function(){var i=(0,f.Z)(function a(){(0,v.Z)(this,a)});return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(_i)],Z.Bz]}),i}(),Ti=s(70167),Di=s(89936),xi=s(4806),Pi=s(16410),Oi=s(32807),Si=s(66270),ki=s(73885),Mi=s(85262),Ai=s(1302),Zi=s(18776),wi=function(){var i=(0,f.Z)(function a(){(0,v.Z)(this,a)});return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[N,{provide:D.mA,useFactory:function(){return[Si,ki,Mi]}},H.n],imports:[[Di.d,u.ez,yi,vt.o9,K.QW,L.lN,j.Cv,F.LD,h.p0,E.AV,A.TU,Ti.n,D.SD,k.g0,xi.j,Pi.L,Oi.q,Ai.o,B.y4,Zi.gc]]}),i}()}}]);